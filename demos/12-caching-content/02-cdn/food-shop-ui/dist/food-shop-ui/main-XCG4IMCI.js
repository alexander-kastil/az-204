import"./chunk-X6YHEMIY.js";import{$ as Ue,$a as Cm,$b as wm,A as Ys,Aa as tN,Ab as vN,B as GI,Ba as Em,Bb as tT,C as ze,Ca as rN,Cb as mh,Cc as MN,D as dt,Da as nN,E as tn,Ea as oN,F as Mo,Fa as Tm,G as Re,H as qI,I as Nr,Ia as iN,J as rn,Ka as WE,L as zI,Lb as EN,Mb as tt,N as KE,Na as aN,Nb as TN,O as GE,Ob as yN,P as VI,Pb as rT,Qb as CN,Rb as SN,S as fm,Sb as AN,T as Yl,Ta as sN,Tb as IN,U as qE,Ua as ym,V as pm,Va as Ye,Vb as NN,W as vt,Wa as Lo,Wb as RN,X as hr,Xa as cN,Xb as wN,Y as jI,Ya as $E,Z as fo,Za as Bl,_ as Rr,_a as QE,a as YE,aa as Ke,ab as XE,b as lm,ba as nn,bb as lN,bc as bm,c as xI,ca as zE,cb as Kl,d as um,da as VE,db as uN,dc as bN,e as MI,ea as jE,eb as dN,ec as DN,f as dm,fa as Hs,fb as fh,fc as PN,g as LI,ga as pa,gc as ON,h as Gn,ha as Hl,hb as hN,i as dr,ia as ht,ib as Ks,j as UI,ja as mm,jb as Sm,k as Vt,ka as hh,kb as Gs,lb as JE,m as HE,ma as WI,mb as Am,n as BE,na as fr,nb as fN,o as In,oa as pr,ob as pN,p as fa,pa as $I,pb as mN,q as hm,qa as gm,qb as ZE,r as dh,ra as _m,rb as gN,s as FI,sa as QI,sb as _N,sc as Dm,t as Fl,ta as XI,tb as Im,tc as Pm,u as YI,ua as vm,ub as _i,uc as qs,v as HI,va as JI,vb as Nm,vc as kN,w as BI,wa as ma,wb as ph,x as KI,xa as ZI,xb as ga,xc as xN,y as gi,ya as Bs,yb as Rm,z as Fs,za as eN,zb as eT}from"./chunk-5DBWAXJ6.js";import{a as U,b as ie,c as xo,d as ho,e as uh,f as C}from"./chunk-ZY7WU73K.js";function ik(r){let e=r,t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return t===1&&n===0?1:5}var LN=["de",[["AM","PM"],void 0,void 0],void 0,[["S","M","D","M","D","F","S"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]],[["S","M","D","M","D","F","S"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]],[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan.","Feb.","M\xE4rz","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]],[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","M\xE4r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]],[["v. Chr.","n. Chr."],void 0,void 0],1,[6,0],["dd.MM.yy","dd.MM.y","d. MMMM y","EEEE, d. MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1}, {0}",void 0,"{1} 'um' {0}",void 0],[",",".",";","%","+","-","E","\xB7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0\xA0%","#,##0.00\xA0\xA4","#E0"],"EUR","\u20AC","Euro",{ATS:["\xF6S"],AUD:["AU$","$"],BGM:["BGK"],BGO:["BGJ"],BYN:[void 0,"\u0440."],CUC:[void 0,"Cub$"],DEM:["DM"],FKP:[void 0,"Fl\xA3"],GHS:[void 0,"\u20B5"],GNF:[void 0,"F.G."],KMF:[void 0,"FC"],PHP:[void 0,"\u20B1"],RON:[void 0,"L"],RUR:[void 0,"\u0440."],RWF:[void 0,"F.Rw"],SYP:[],THB:["\u0E3F"],TWD:["NT$"],XXX:[],ZMW:[void 0,"K"]},"ltr",ik];function UN(r){return new ze(3e3,!1)}function ak(){return new ze(3100,!1)}function sk(){return new ze(3101,!1)}function ck(r){return new ze(3001,!1)}function lk(r){return new ze(3003,!1)}function uk(r){return new ze(3004,!1)}function dk(r,e){return new ze(3005,!1)}function hk(){return new ze(3006,!1)}function fk(){return new ze(3007,!1)}function pk(r,e){return new ze(3008,!1)}function mk(r){return new ze(3002,!1)}function gk(r,e,t,n,o){return new ze(3010,!1)}function _k(){return new ze(3011,!1)}function vk(){return new ze(3012,!1)}function Ek(){return new ze(3200,!1)}function Tk(){return new ze(3202,!1)}function yk(){return new ze(3013,!1)}function Ck(r){return new ze(3014,!1)}function Sk(r){return new ze(3015,!1)}function Ak(r){return new ze(3016,!1)}function Ik(r,e){return new ze(3404,!1)}function Nk(r){return new ze(3502,!1)}function Rk(r){return new ze(3503,!1)}function wk(){return new ze(3300,!1)}function bk(r){return new ze(3504,!1)}function Dk(r){return new ze(3301,!1)}function Pk(r,e){return new ze(3302,!1)}function Ok(r){return new ze(3303,!1)}function kk(r,e){return new ze(3400,!1)}function xk(r){return new ze(3401,!1)}function Mk(r){return new ze(3402,!1)}function Lk(r,e){return new ze(3505,!1)}function _a(r){switch(r.length){case 0:return new Bl;case 1:return r[0];default:return new QE(r)}}function XN(r,e,t=new Map,n=new Map){let o=[],i=[],a=-1,s=null;if(e.forEach(c=>{let l=c.get("offset"),u=l==a,d=u&&s||new Map;c.forEach((h,f)=>{let p=f,m=h;if(f!=="offset")switch(p=r.normalizePropertyName(p,o),m){case Cm:m=t.get(f);break;case Lo:m=n.get(f);break;default:m=r.normalizeStyleValue(f,p,m,o);break}d.set(p,m)}),u||i.push(d),s=d,a=l}),o.length)throw Nk(o);return i}function IT(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&nT(t,"start",r)));break;case"done":r.onDone(()=>n(t&&nT(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&nT(t,"destroy",r)));break}}function nT(r,e,t){let n=t.totalTime,o=!!t.disabled,i=NT(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,n??r.totalTime,o),a=r._data;return a!=null&&(i._data=a),i}function NT(r,e,t,n,o="",i=0,a){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:o,totalTime:i,disabled:!!a}}function Rn(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function FN(r){let e=r.indexOf(":"),t=r.substring(1,e),n=r.slice(e+1);return[t,n]}var Uk=typeof document>"u"?null:document.documentElement;function RT(r){let e=r.parentNode||r.host||null;return e===Uk?null:e}function Fk(r){return r.substring(1,6)=="ebkit"}var zs=null,YN=!1;function Yk(r){zs||(zs=Hk()||{},YN=zs.style?"WebkitAppearance"in zs.style:!1);let e=!0;return zs.style&&!Fk(r)&&(e=r in zs.style,!e&&YN&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in zs.style)),e}function Hk(){return typeof document<"u"?document.body:null}function JN(r,e){for(;e;){if(e===r)return!0;e=RT(e)}return!1}function ZN(r,e,t){if(t)return Array.from(r.querySelectorAll(e));let n=r.querySelector(e);return n?[n]:[]}var wT=(()=>{class r{validateStyleProperty(t){return Yk(t)}containsElement(t,n){return JN(t,n)}getParentElement(t){return RT(t)}query(t,n,o){return ZN(t,n,o)}computeStyle(t,n,o){return o||""}animate(t,n,o,i,a,s=[],c){return new Bl(o,i)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac})}}return r})(),Ws=class{static{this.NOOP=new wT}},$s=class{};var Bk=1e3,eR="{{",Kk="}}",tR="ng-enter",lT="ng-leave",Om="ng-trigger",Um=".ng-trigger",HN="ng-animating",uT=".ng-animating";function vi(r){if(typeof r=="number")return r;let e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:dT(parseFloat(e[1]),e[2])}function dT(r,e){switch(e){case"s":return r*Bk;default:return r}}function Fm(r,e,t){return r.hasOwnProperty("duration")?r:Gk(r,e,t)}function Gk(r,e,t){let n=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,o,i=0,a="";if(typeof r=="string"){let s=r.match(n);if(s===null)return e.push(UN(r)),{duration:0,delay:0,easing:""};o=dT(parseFloat(s[1]),s[2]);let c=s[3];c!=null&&(i=dT(parseFloat(c),s[4]));let l=s[5];l&&(a=l)}else o=r;if(!t){let s=!1,c=e.length;o<0&&(e.push(ak()),s=!0),i<0&&(e.push(sk()),s=!0),s&&e.splice(c,0,UN(r))}return{duration:o,delay:i,easing:a}}function qk(r){return r.length?r[0]instanceof Map?r:r.map(e=>new Map(Object.entries(e))):[]}function Uo(r,e,t){e.forEach((n,o)=>{let i=bT(o);t&&!t.has(o)&&t.set(o,r.style[i]),r.style[i]=n})}function js(r,e){e.forEach((t,n)=>{let o=bT(n);r.style[o]=""})}function gh(r){return Array.isArray(r)?r.length==1?r[0]:cN(r):r}function zk(r,e,t){let n=e.params||{},o=rR(r);o.length&&o.forEach(i=>{n.hasOwnProperty(i)||t.push(ck(i))})}var hT=new RegExp(`${eR}\\s*(.+?)\\s*${Kk}`,"g");function rR(r){let e=[];if(typeof r=="string"){let t;for(;t=hT.exec(r);)e.push(t[1]);hT.lastIndex=0}return e}function vh(r,e,t){let n=`${r}`,o=n.replace(hT,(i,a)=>{let s=e[a];return s==null&&(t.push(lk(a)),s=""),s.toString()});return o==n?r:o}var Vk=/-+([a-z0-9])/g;function bT(r){return r.replace(Vk,(...e)=>e[1].toUpperCase())}function jk(r,e){return r===0||e===0}function Wk(r,e,t){if(t.size&&e.length){let n=e[0],o=[];if(t.forEach((i,a)=>{n.has(a)||o.push(a),n.set(a,i)}),o.length)for(let i=1;i<e.length;i++){let a=e[i];o.forEach(s=>a.set(s,DT(r,s)))}}return e}function Nn(r,e,t){switch(e.type){case Ye.Trigger:return r.visitTrigger(e,t);case Ye.State:return r.visitState(e,t);case Ye.Transition:return r.visitTransition(e,t);case Ye.Sequence:return r.visitSequence(e,t);case Ye.Group:return r.visitGroup(e,t);case Ye.Animate:return r.visitAnimate(e,t);case Ye.Keyframes:return r.visitKeyframes(e,t);case Ye.Style:return r.visitStyle(e,t);case Ye.Reference:return r.visitReference(e,t);case Ye.AnimateChild:return r.visitAnimateChild(e,t);case Ye.AnimateRef:return r.visitAnimateRef(e,t);case Ye.Query:return r.visitQuery(e,t);case Ye.Stagger:return r.visitStagger(e,t);default:throw uk(e.type)}}function DT(r,e){return window.getComputedStyle(r)[e]}var $k=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),Ym=class extends $s{normalizePropertyName(e,t){return bT(e)}normalizeStyleValue(e,t,n,o){let i="",a=n.toString().trim();if($k.has(t)&&n!==0&&n!=="0")if(typeof n=="number")i="px";else{let s=n.match(/^[+-]?[\d\.]+([a-z]*)$/);s&&s[1].length==0&&o.push(dk(e,n))}return a+i}};var Hm="*";function Qk(r,e){let t=[];return typeof r=="string"?r.split(/\s*,\s*/).forEach(n=>Xk(n,t,e)):t.push(r),t}function Xk(r,e,t){if(r[0]==":"){let c=Jk(r,t);if(typeof c=="function"){e.push(c);return}r=c}let n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(n==null||n.length<4)return t.push(Sk(r)),e;let o=n[1],i=n[2],a=n[3];e.push(BN(o,a));let s=o==Hm&&a==Hm;i[0]=="<"&&!s&&e.push(BN(a,o))}function Jk(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(Ak(r)),"* => *"}}var km=new Set(["true","1"]),xm=new Set(["false","0"]);function BN(r,e){let t=km.has(r)||xm.has(r),n=km.has(e)||xm.has(e);return(o,i)=>{let a=r==Hm||r==o,s=e==Hm||e==i;return!a&&t&&typeof o=="boolean"&&(a=o?km.has(r):xm.has(r)),!s&&n&&typeof i=="boolean"&&(s=i?km.has(e):xm.has(e)),a&&s}}var nR=":self",Zk=new RegExp(`s*${nR}s*,?`,"g");function oR(r,e,t,n){return new fT(r).build(e,t,n)}var KN="",fT=class{constructor(e){this._driver=e}build(e,t,n){let o=new pT(t);return this._resetContextStyleTimingState(o),Nn(this,gh(e),o)}_resetContextStyleTimingState(e){e.currentQuerySelector=KN,e.collectedStyles=new Map,e.collectedStyles.set(KN,new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,o=t.depCount=0,i=[],a=[];return e.name.charAt(0)=="@"&&t.errors.push(hk()),e.definitions.forEach(s=>{if(this._resetContextStyleTimingState(t),s.type==Ye.State){let c=s,l=c.name;l.toString().split(/\s*,\s*/).forEach(u=>{c.name=u,i.push(this.visitState(c,t))}),c.name=l}else if(s.type==Ye.Transition){let c=this.visitTransition(s,t);n+=c.queryCount,o+=c.depCount,a.push(c)}else t.errors.push(fk())}),{type:Ye.Trigger,name:e.name,states:i,transitions:a,queryCount:n,depCount:o,options:null}}visitState(e,t){let n=this.visitStyle(e.styles,t),o=e.options&&e.options.params||null;if(n.containsDynamicStyles){let i=new Set,a=o||{};n.styles.forEach(s=>{s instanceof Map&&s.forEach(c=>{rR(c).forEach(l=>{a.hasOwnProperty(l)||i.add(l)})})}),i.size&&t.errors.push(pk(e.name,[...i.values()]))}return{type:Ye.State,name:e.name,style:n,options:o?{params:o}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;let n=Nn(this,gh(e.animation),t),o=Qk(e.expr,t.errors);return{type:Ye.Transition,matchers:o,animation:n,queryCount:t.queryCount,depCount:t.depCount,options:Vs(e.options)}}visitSequence(e,t){return{type:Ye.Sequence,steps:e.steps.map(n=>Nn(this,n,t)),options:Vs(e.options)}}visitGroup(e,t){let n=t.currentTime,o=0,i=e.steps.map(a=>{t.currentTime=n;let s=Nn(this,a,t);return o=Math.max(o,t.currentTime),s});return t.currentTime=o,{type:Ye.Group,steps:i,options:Vs(e.options)}}visitAnimate(e,t){let n=nx(e.timings,t.errors);t.currentAnimateTimings=n;let o,i=e.styles?e.styles:$E({});if(i.type==Ye.Keyframes)o=this.visitKeyframes(i,t);else{let a=e.styles,s=!1;if(!a){s=!0;let l={};n.easing&&(l.easing=n.easing),a=$E(l)}t.currentTime+=n.duration+n.delay;let c=this.visitStyle(a,t);c.isEmptyStep=s,o=c}return t.currentAnimateTimings=null,{type:Ye.Animate,timings:n,style:o,options:null}}visitStyle(e,t){let n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){let n=[],o=Array.isArray(e.styles)?e.styles:[e.styles];for(let s of o)typeof s=="string"?s===Lo?n.push(s):t.errors.push(mk(s)):n.push(new Map(Object.entries(s)));let i=!1,a=null;return n.forEach(s=>{if(s instanceof Map&&(s.has("easing")&&(a=s.get("easing"),s.delete("easing")),!i)){for(let c of s.values())if(c.toString().indexOf(eR)>=0){i=!0;break}}}),{type:Ye.Style,styles:n,easing:a,offset:e.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(e,t){let n=t.currentAnimateTimings,o=t.currentTime,i=t.currentTime;n&&i>0&&(i-=n.duration+n.delay),e.styles.forEach(a=>{typeof a!="string"&&a.forEach((s,c)=>{let l=t.collectedStyles.get(t.currentQuerySelector),u=l.get(c),d=!0;u&&(i!=o&&i>=u.startTime&&o<=u.endTime&&(t.errors.push(gk(c,u.startTime,u.endTime,i,o)),d=!1),i=u.startTime),d&&l.set(c,{startTime:i,endTime:o}),t.options&&zk(s,t.options,t.errors)})})}visitKeyframes(e,t){let n={type:Ye.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(_k()),n;let o=1,i=0,a=[],s=!1,c=!1,l=0,u=e.steps.map(T=>{let E=this._makeStyleAst(T,t),y=E.offset!=null?E.offset:rx(E.styles),A=0;return y!=null&&(i++,A=E.offset=y),c=c||A<0||A>1,s=s||A<l,l=A,a.push(A),E});c&&t.errors.push(vk()),s&&t.errors.push(Ek());let d=e.steps.length,h=0;i>0&&i<d?t.errors.push(Tk()):i==0&&(h=o/(d-1));let f=d-1,p=t.currentTime,m=t.currentAnimateTimings,_=m.duration;return u.forEach((T,E)=>{let y=h>0?E==f?1:h*E:a[E],A=y*_;t.currentTime=p+m.delay+A,m.duration=A,this._validateStyleAst(T,t),T.offset=y,n.styles.push(T)}),n}visitReference(e,t){return{type:Ye.Reference,animation:Nn(this,gh(e.animation),t),options:Vs(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:Ye.AnimateChild,options:Vs(e.options)}}visitAnimateRef(e,t){return{type:Ye.AnimateRef,animation:this.visitReference(e.animation,t),options:Vs(e.options)}}visitQuery(e,t){let n=t.currentQuerySelector,o=e.options||{};t.queryCount++,t.currentQuery=e;let[i,a]=ex(e.selector);t.currentQuerySelector=n.length?n+" "+i:i,Rn(t.collectedStyles,t.currentQuerySelector,new Map);let s=Nn(this,gh(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:Ye.Query,selector:i,limit:o.limit||0,optional:!!o.optional,includeSelf:a,animation:s,originalSelector:e.selector,options:Vs(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(yk());let n=e.timings==="full"?{duration:0,delay:0,easing:"full"}:Fm(e.timings,t.errors,!0);return{type:Ye.Stagger,animation:Nn(this,gh(e.animation),t),timings:n,options:null}}};function ex(r){let e=!!r.split(/\s*,\s*/).find(t=>t==nR);return e&&(r=r.replace(Zk,"")),r=r.replace(/@\*/g,Um).replace(/@\w+/g,t=>Um+"-"+t.slice(1)).replace(/:animating/g,uT),[r,e]}function tx(r){return r?U({},r):null}var pT=class{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function rx(r){if(typeof r=="string")return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){let n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){let t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}function nx(r,e){if(r.hasOwnProperty("duration"))return r;if(typeof r=="number"){let i=Fm(r,e).duration;return oT(i,0,"")}let t=r;if(t.split(/\s+/).some(i=>i.charAt(0)=="{"&&i.charAt(1)=="{")){let i=oT(0,0,"");return i.dynamic=!0,i.strValue=t,i}let o=Fm(t,e);return oT(o.duration,o.delay,o.easing)}function Vs(r){return r?(r=U({},r),r.params&&(r.params=tx(r.params))):r={},r}function oT(r,e,t){return{duration:r,delay:e,easing:t}}function PT(r,e,t,n,o,i,a=null,s=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:o,delay:i,totalTime:o+i,easing:a,subTimeline:s}}var Eh=class{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}},ox=1,ix=":enter",ax=new RegExp(ix,"g"),sx=":leave",cx=new RegExp(sx,"g");function iR(r,e,t,n,o,i=new Map,a=new Map,s,c,l=[]){return new mT().buildKeyframes(r,e,t,n,o,i,a,s,c,l)}var mT=class{buildKeyframes(e,t,n,o,i,a,s,c,l,u=[]){l=l||new Eh;let d=new gT(e,t,l,o,i,u,[]);d.options=c;let h=c.delay?vi(c.delay):0;d.currentTimeline.delayNextStep(h),d.currentTimeline.setStyles([a],null,d.errors,c),Nn(this,n,d);let f=d.timelines.filter(p=>p.containsAnimation());if(f.length&&s.size){let p;for(let m=f.length-1;m>=0;m--){let _=f[m];if(_.element===t){p=_;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([s],null,d.errors,c)}return f.length?f.map(p=>p.buildKeyframes()):[PT(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){let n=t.subInstructions.get(t.element);if(n){let o=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,o,o.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}visitAnimateRef(e,t){let n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(let o of e){let i=o?.delay;if(i){let a=typeof i=="number"?i:vi(vh(i,o?.params??{},t.errors));n.delayNextStep(a)}}}_visitSubInstructions(e,t,n){let i=t.currentTimeline.currentTime,a=n.duration!=null?vi(n.duration):null,s=n.delay!=null?vi(n.delay):null;return a!==0&&e.forEach(c=>{let l=t.appendInstructionToTimeline(c,a,s);i=Math.max(i,l.duration+l.delay)}),i}visitReference(e,t){t.updateOptions(e.options,!0),Nn(this,e.animation,t),t.previousNode=e}visitSequence(e,t){let n=t.subContextCount,o=t,i=e.options;if(i&&(i.params||i.delay)&&(o=t.createSubContext(i),o.transformIntoNewTimeline(),i.delay!=null)){o.previousNode.type==Ye.Style&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=Bm);let a=vi(i.delay);o.delayNextStep(a)}e.steps.length&&(e.steps.forEach(a=>Nn(this,a,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>n&&o.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){let n=[],o=t.currentTimeline.currentTime,i=e.options&&e.options.delay?vi(e.options.delay):0;e.steps.forEach(a=>{let s=t.createSubContext(e.options);i&&s.delayNextStep(i),Nn(this,a,s),o=Math.max(o,s.currentTimeline.currentTime),n.push(s.currentTimeline)}),n.forEach(a=>t.currentTimeline.mergeTimelineCollectedStyles(a)),t.transformIntoNewTimeline(o),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){let n=e.strValue,o=t.params?vh(n,t.params,t.errors):n;return Fm(o,t.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){let n=t.currentAnimateTimings=this._visitTiming(e.timings,t),o=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),o.snapshotCurrentStyles());let i=e.style;i.type==Ye.Keyframes?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),o.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){let n=t.currentTimeline,o=t.currentAnimateTimings;!o&&n.hasCurrentStyleProperties()&&n.forwardFrame();let i=o&&o.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){let n=t.currentAnimateTimings,o=t.currentTimeline.duration,i=n.duration,s=t.createSubContext().currentTimeline;s.easing=n.easing,e.styles.forEach(c=>{let l=c.offset||0;s.forwardTime(l*i),s.setStyles(c.styles,c.easing,t.errors,t.options),s.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(s),t.transformIntoNewTimeline(o+i),t.previousNode=e}visitQuery(e,t){let n=t.currentTimeline.currentTime,o=e.options||{},i=o.delay?vi(o.delay):0;i&&(t.previousNode.type===Ye.Style||n==0&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Bm);let a=n,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!o.optional,t.errors);t.currentQueryTotal=s.length;let c=null;s.forEach((l,u)=>{t.currentQueryIndex=u;let d=t.createSubContext(e.options,l);i&&d.delayNextStep(i),l===t.element&&(c=d.currentTimeline),Nn(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe();let h=d.currentTimeline.currentTime;a=Math.max(a,h)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(a),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){let n=t.parentContext,o=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),s=a*(t.currentQueryTotal-1),c=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":c=s-c;break;case"full":c=n.currentStaggerTime;break}let u=t.currentTimeline;c&&u.delayNextStep(c);let d=u.currentTime;Nn(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=o.currentTime-d+(o.startTime-n.currentTimeline.startTime)}},Bm={},gT=class r{constructor(e,t,n,o,i,a,s,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=o,this._leaveClassName=i,this.errors=a,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Bm,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new Km(this._driver,t,0),s.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;let n=e,o=this.options;n.duration!=null&&(o.duration=vi(n.duration)),n.delay!=null&&(o.delay=vi(n.delay));let i=n.params;if(i){let a=o.params;a||(a=this.options.params={}),Object.keys(i).forEach(s=>{(!t||!a.hasOwnProperty(s))&&(a[s]=vh(i[s],a,this.errors))})}}_copyOptions(){let e={};if(this.options){let t=this.options.params;if(t){let n=e.params={};Object.keys(t).forEach(o=>{n[o]=t[o]})}}return e}createSubContext(e=null,t,n){let o=t||this.element,i=new r(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(e),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(e){return this.previousNode=Bm,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){let o={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},i=new _T(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,o,e.stretchStartingKeyframe);return this.timelines.push(i),o}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,o,i,a){let s=[];if(o&&s.push(this.element),e.length>0){e=e.replace(ax,"."+this._enterClassName),e=e.replace(cx,"."+this._leaveClassName);let c=n!=1,l=this._driver.query(this.element,e,c);n!==0&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),s.push(...l)}return!i&&s.length==0&&a.push(Ck(t)),s}},Km=class r{constructor(e,t,n,o){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=o,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let t=this._keyframes.size===1&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new r(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=ox,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||Lo),this._currentKeyframe.set(t,Lo);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,o){t&&this._previousKeyframe.set("easing",t);let i=o&&o.params||{},a=lx(e,this._globalTimelineStyles);for(let[s,c]of a){let l=vh(c,i,n);this._pendingStyles.set(s,l),this._localTimelineStyles.has(s)||this._backFill.set(s,this._globalTimelineStyles.get(s)??Lo),this._updateStyle(s,l)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{let o=this._styleSummary.get(n);(!o||t.time>o.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,t=new Set,n=this._keyframes.size===1&&this.duration===0,o=[];this._keyframes.forEach((s,c)=>{let l=new Map([...this._backFill,...s]);l.forEach((u,d)=>{u===Cm?e.add(d):u===Lo&&t.add(d)}),n||l.set("offset",c/this.duration),o.push(l)});let i=[...e.values()],a=[...t.values()];if(n){let s=o[0],c=new Map(s);s.set("offset",0),c.set("offset",1),o=[s,c]}return PT(this.element,o,i,a,this.duration,this.startTime,this.easing,!1)}},_T=class extends Km{constructor(e,t,n,o,i,a,s=!1){super(e,t,a.delay),this.keyframes=n,this.preStyleProps=o,this.postStyleProps=i,this._stretchStartingKeyframe=s,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:o}=this.timings;if(this._stretchStartingKeyframe&&t){let i=[],a=n+t,s=t/a,c=new Map(e[0]);c.set("offset",0),i.push(c);let l=new Map(e[0]);l.set("offset",GN(s)),i.push(l);let u=e.length-1;for(let d=1;d<=u;d++){let h=new Map(e[d]),f=h.get("offset"),p=t+f*n;h.set("offset",GN(p/a)),i.push(h)}n=a,t=0,o="",e=i}return PT(this.element,e,this.preStyleProps,this.postStyleProps,n,t,o,!0)}};function GN(r,e=3){let t=Math.pow(10,e-1);return Math.round(r*t)/t}function lx(r,e){let t=new Map,n;return r.forEach(o=>{if(o==="*"){n??=e.keys();for(let i of n)t.set(i,Lo)}else for(let[i,a]of o)t.set(i,a)}),t}function qN(r,e,t,n,o,i,a,s,c,l,u,d,h){return{type:0,element:r,triggerName:e,isRemovalTransition:o,fromState:t,fromStyles:i,toState:n,toStyles:a,timelines:s,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:d,errors:h}}var iT={},Gm=class{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,o){return ux(this.ast.matchers,e,t,n,o)}buildStyles(e,t,n){let o=this._stateStyles.get("*");return e!==void 0&&(o=this._stateStyles.get(e?.toString())||o),o?o.buildStyles(t,n):new Map}build(e,t,n,o,i,a,s,c,l,u){let d=[],h=this.ast.options&&this.ast.options.params||iT,f=s&&s.params||iT,p=this.buildStyles(n,f,d),m=c&&c.params||iT,_=this.buildStyles(o,m,d),T=new Set,E=new Map,y=new Map,A=o==="void",w={params:aR(m,h),delay:this.ast.options?.delay},O=u?[]:iR(e,t,this.ast.animation,i,a,p,_,w,l,d),S=0;return O.forEach(K=>{S=Math.max(K.duration+K.delay,S)}),d.length?qN(t,this._triggerName,n,o,A,p,_,[],[],E,y,S,d):(O.forEach(K=>{let ne=K.element,_e=Rn(E,ne,new Set);K.preStyleProps.forEach(Ze=>_e.add(Ze));let Ct=Rn(y,ne,new Set);K.postStyleProps.forEach(Ze=>Ct.add(Ze)),ne!==t&&T.add(ne)}),qN(t,this._triggerName,n,o,A,p,_,O,[...T.values()],E,y,S))}};function ux(r,e,t,n,o){return r.some(i=>i(e,t,n,o))}function aR(r,e){let t=U({},e);return Object.entries(r).forEach(([n,o])=>{o!=null&&(t[n]=o)}),t}var vT=class{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){let n=new Map,o=aR(e,this.defaultParams);return this.styles.styles.forEach(i=>{typeof i!="string"&&i.forEach((a,s)=>{a&&(a=vh(a,o,t));let c=this.normalizer.normalizePropertyName(s,t);a=this.normalizer.normalizeStyleValue(s,c,a,t),n.set(s,a)})}),n}};function dx(r,e,t){return new ET(r,e,t)}var ET=class{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(o=>{let i=o.options&&o.options.params||{};this.states.set(o.name,new vT(o.style,i,n))}),zN(this.states,"true","1"),zN(this.states,"false","0"),t.transitions.forEach(o=>{this.transitionFactories.push(new Gm(e,o,this.states))}),this.fallbackTransition=hx(e,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,o){return this.transitionFactories.find(a=>a.match(e,t,n,o))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}};function hx(r,e,t){let n=[(a,s)=>!0],o={type:Ye.Sequence,steps:[],options:null},i={type:Ye.Transition,animation:o,matchers:n,options:null,queryCount:0,depCount:0};return new Gm(r,i,e)}function zN(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}var fx=new Eh,TT=class{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){let n=[],o=[],i=oR(this._driver,t,n,o);if(n.length)throw Rk(n);o.length&&void 0,this._animations.set(e,i)}_buildPlayer(e,t,n){let o=e.element,i=XN(this._normalizer,e.keyframes,t,n);return this._driver.animate(o,i,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){let o=[],i=this._animations.get(e),a,s=new Map;if(i?(a=iR(this._driver,t,i,tR,lT,new Map,new Map,n,fx,o),a.forEach(u=>{let d=Rn(s,u.element,new Map);u.postStyleProps.forEach(h=>d.set(h,null))})):(o.push(wk()),a=[]),o.length)throw bk(o);s.forEach((u,d)=>{u.forEach((h,f)=>{u.set(f,this._driver.computeStyle(d,f,Lo))})});let c=a.map(u=>{let d=s.get(u.element);return this._buildPlayer(u,new Map,d)}),l=_a(c);return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){let t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);let n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){let t=this._playersById.get(e);if(!t)throw Dk(e);return t}listen(e,t,n,o){let i=NT(t,"","","");return IT(this._getPlayer(e),n,i,o),()=>{}}command(e,t,n,o){if(n=="register"){this.register(e,o[0]);return}if(n=="create"){let a=o[0]||{};this.create(e,t,a);return}let i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(e);break}}},VN="ng-animate-queued",px=".ng-animate-queued",aT="ng-animate-disabled",mx=".ng-animate-disabled",gx="ng-star-inserted",_x=".ng-star-inserted",vx=[],sR={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Ex={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},po="__ng_removed",Th=class{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;let n=e&&e.hasOwnProperty("value"),o=n?e.value:e;if(this.value=yx(o),n){let i=e,{value:a}=i,s=xo(i,["value"]);this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let t=e.params;if(t){let n=this.options.params;Object.keys(t).forEach(o=>{n[o]==null&&(n[o]=t[o])})}}},_h="void",sT=new Th(_h),yT=class{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,qn(t,this._hostClassName)}listen(e,t,n,o){if(!this._triggers.has(t))throw Pk(n,t);if(n==null||n.length==0)throw Ok(t);if(!Cx(n))throw kk(n,t);let i=Rn(this._elementListeners,e,[]),a={name:t,phase:n,callback:o};i.push(a);let s=Rn(this._engine.statesByElement,e,new Map);return s.has(t)||(qn(e,Om),qn(e,Om+"-"+t),s.set(t,sT)),()=>{this._engine.afterFlush(()=>{let c=i.indexOf(a);c>=0&&i.splice(c,1),this._triggers.has(t)||s.delete(t)})}}register(e,t){return this._triggers.has(e)?!1:(this._triggers.set(e,t),!0)}_getTrigger(e){let t=this._triggers.get(e);if(!t)throw xk(e);return t}trigger(e,t,n,o=!0){let i=this._getTrigger(t),a=new yh(this.id,t,e),s=this._engine.statesByElement.get(e);s||(qn(e,Om),qn(e,Om+"-"+t),this._engine.statesByElement.set(e,s=new Map));let c=s.get(t),l=new Th(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),s.set(t,l),c||(c=sT),!(l.value===_h)&&c.value===l.value){if(!Ix(c.params,l.params)){let m=[],_=i.matchStyles(c.value,c.params,m),T=i.matchStyles(l.value,l.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{js(e,_),Uo(e,T)})}return}let h=Rn(this._engine.playersByElement,e,[]);h.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let f=i.matchTransition(c.value,l.value,e,l.params),p=!1;if(!f){if(!o)return;f=i.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:c,toState:l,player:a,isFallbackTransition:p}),p||(qn(e,VN),a.onStart(()=>{Gl(e,VN)})),a.onDone(()=>{let m=this.players.indexOf(a);m>=0&&this.players.splice(m,1);let _=this._engine.playersByElement.get(e);if(_){let T=_.indexOf(a);T>=0&&_.splice(T,1)}}),this.players.push(a),h.push(a),a}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(o=>o.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){let n=this._engine.driver.query(e,Um,!0);n.forEach(o=>{if(o[po])return;let i=this._engine.fetchNamespacesByElement(o);i.size?i.forEach(a=>a.triggerLeaveAnimation(o,t,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(e,t,n,o){let i=this._engine.statesByElement.get(e),a=new Map;if(i){let s=[];if(i.forEach((c,l)=>{if(a.set(l,c.value),this._triggers.has(l)){let u=this.trigger(e,l,_h,o);u&&s.push(u)}}),s.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,a),n&&_a(s).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){let o=new Set;t.forEach(i=>{let a=i.name;if(o.has(a))return;o.add(a);let c=this._triggers.get(a).fallbackTransition,l=n.get(a)||sT,u=new Th(_h),d=new yh(this.id,a,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:a,transition:c,fromState:l,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(e,t){let n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let o=!1;if(n.totalAnimations){let i=n.players.length?n.playersByQueriedElement.get(e):[];if(i&&i.length)o=!0;else{let a=e;for(;a=a.parentNode;)if(n.statesByElement.get(a)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(e),o)n.markElementAsRemoved(this.id,e,!1,t);else{let i=e[po];(!i||i===sR)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){qn(e,this._hostClassName)}drainQueuedTransitions(e){let t=[];return this._queue.forEach(n=>{let o=n.player;if(o.destroyed)return;let i=n.element,a=this._elementListeners.get(i);a&&a.forEach(s=>{if(s.name==n.triggerName){let c=NT(i,n.triggerName,n.fromState.value,n.toState.value);c._data=e,IT(n.player,s.phase,c,s.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):t.push(n)}),this._queue=[],t.sort((n,o)=>{let i=n.transition.ast.depCount,a=o.transition.ast.depCount;return i==0||a==0?i-a:this._engine.driver.containsElement(n.element,o.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},CT=class{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,i)=>{}}get queuedPlayers(){let e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){let n=new yT(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){let n=this._namespaceList,o=this.namespacesByHostElement;if(n.length-1>=0){let a=!1,s=this.driver.getParentElement(t);for(;s;){let c=o.get(s);if(c){let l=n.indexOf(c);n.splice(l+1,0,e),a=!0;break}s=this.driver.getParentElement(s)}a||n.unshift(e)}else n.push(e);return o.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let o=this._namespaceLookup[e];o&&o.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);let o=this._namespaceList.indexOf(n);o>=0&&this._namespaceList.splice(o,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let t=new Set,n=this.statesByElement.get(e);if(n){for(let o of n.values())if(o.namespaceId){let i=this._fetchNamespace(o.namespaceId);i&&t.add(i)}}return t}trigger(e,t,n,o){if(Mm(t)){let i=this._fetchNamespace(e);if(i)return i.trigger(t,n,o),!0}return!1}insertNode(e,t,n,o){if(!Mm(t))return;let i=t[po];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;let a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){let a=this._fetchNamespace(e);a&&a.insertNode(t,n)}o&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),qn(e,aT)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Gl(e,aT))}removeNode(e,t,n){if(Mm(t)){let o=e?this._fetchNamespace(e):null;o?o.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);let i=this.namespacesByHostElement.get(t);i&&i.id!==e&&i.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,o,i){this.collectedLeaveElements.push(t),t[po]={namespaceId:e,setForRemoval:o,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:i}}listen(e,t,n,o,i){return Mm(t)?this._fetchNamespace(e).listen(t,n,o,i):()=>{}}_buildInstruction(e,t,n,o,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,o,e.fromState.options,e.toState.options,t,i)}destroyInnerAnimations(e){let t=this.driver.query(e,Um,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),this.playersByQueriedElement.size!=0&&(t=this.driver.query(e,uT,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){let t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){let t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return _a(this.players).onDone(()=>e());e()})}processLeaveNode(e){let t=e[po];if(t&&t.setForRemoval){if(e[po]=sR,t.namespaceId){this.destroyInnerAnimations(e);let n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(aT)&&this.markElementAsDisabled(e,!1),this.driver.query(e,mx,!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,o)=>this._balanceNamespaceList(n,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++){let o=this.collectedEnterElements[n];qn(o,gx)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let n=[];try{t=this._flushAnimations(n,e)}finally{for(let o=0;o<n.length;o++)n[o]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++){let o=this.collectedLeaveElements[n];this.processLeaveNode(o)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){let n=this._whenQuietFns;this._whenQuietFns=[],t.length?_a(t).onDone(()=>{n.forEach(o=>o())}):n.forEach(o=>o())}}reportError(e){throw Mk(e)}_flushAnimations(e,t){let n=new Eh,o=[],i=new Map,a=[],s=new Map,c=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(L=>{u.add(L);let re=this.driver.query(L,px,!0);for(let oe=0;oe<re.length;oe++)u.add(re[oe])});let d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=$N(h,this.collectedEnterElements),p=new Map,m=0;f.forEach((L,re)=>{let oe=tR+m++;p.set(re,oe),L.forEach(le=>qn(le,oe))});let _=[],T=new Set,E=new Set;for(let L=0;L<this.collectedLeaveElements.length;L++){let re=this.collectedLeaveElements[L],oe=re[po];oe&&oe.setForRemoval&&(_.push(re),T.add(re),oe.hasAnimation?this.driver.query(re,_x,!0).forEach(le=>T.add(le)):E.add(re))}let y=new Map,A=$N(h,Array.from(T));A.forEach((L,re)=>{let oe=lT+m++;y.set(re,oe),L.forEach(le=>qn(le,oe))}),e.push(()=>{f.forEach((L,re)=>{let oe=p.get(re);L.forEach(le=>Gl(le,oe))}),A.forEach((L,re)=>{let oe=y.get(re);L.forEach(le=>Gl(le,oe))}),_.forEach(L=>{this.processLeaveNode(L)})});let w=[],O=[];for(let L=this._namespaceList.length-1;L>=0;L--)this._namespaceList[L].drainQueuedTransitions(t).forEach(oe=>{let le=oe.player,Le=oe.element;if(w.push(le),this.collectedEnterElements.length){let Ee=Le[po];if(Ee&&Ee.setForMove){if(Ee.previousTriggersValues&&Ee.previousTriggersValues.has(oe.triggerName)){let Fe=Ee.previousTriggersValues.get(oe.triggerName),He=this.statesByElement.get(oe.element);if(He&&He.has(oe.triggerName)){let P=He.get(oe.triggerName);P.value=Fe,He.set(oe.triggerName,P)}}le.destroy();return}}let b=!d||!this.driver.containsElement(d,Le),B=y.get(Le),V=p.get(Le),W=this._buildInstruction(oe,n,V,B,b);if(W.errors&&W.errors.length){O.push(W);return}if(b){le.onStart(()=>js(Le,W.fromStyles)),le.onDestroy(()=>Uo(Le,W.toStyles)),o.push(le);return}if(oe.isFallbackTransition){le.onStart(()=>js(Le,W.fromStyles)),le.onDestroy(()=>Uo(Le,W.toStyles)),o.push(le);return}let ke=[];W.timelines.forEach(Ee=>{Ee.stretchStartingKeyframe=!0,this.disabledNodes.has(Ee.element)||ke.push(Ee)}),W.timelines=ke,n.append(Le,W.timelines);let et={instruction:W,player:le,element:Le};a.push(et),W.queriedElements.forEach(Ee=>Rn(s,Ee,[]).push(le)),W.preStyleProps.forEach((Ee,Fe)=>{if(Ee.size){let He=c.get(Fe);He||c.set(Fe,He=new Set),Ee.forEach((P,Z)=>He.add(Z))}}),W.postStyleProps.forEach((Ee,Fe)=>{let He=l.get(Fe);He||l.set(Fe,He=new Set),Ee.forEach((P,Z)=>He.add(Z))})});if(O.length){let L=[];O.forEach(re=>{L.push(Lk(re.triggerName,re.errors))}),w.forEach(re=>re.destroy()),this.reportError(L)}let S=new Map,K=new Map;a.forEach(L=>{let re=L.element;n.has(re)&&(K.set(re,re),this._beforeAnimationBuild(L.player.namespaceId,L.instruction,S))}),o.forEach(L=>{let re=L.element;this._getPreviousPlayers(re,!1,L.namespaceId,L.triggerName,null).forEach(le=>{Rn(S,re,[]).push(le),le.destroy()})});let ne=_.filter(L=>QN(L,c,l)),_e=new Map;WN(_e,this.driver,E,l,Lo).forEach(L=>{QN(L,c,l)&&ne.push(L)});let Ze=new Map;f.forEach((L,re)=>{WN(Ze,this.driver,new Set(L),c,Cm)}),ne.forEach(L=>{let re=_e.get(L),oe=Ze.get(L);_e.set(L,new Map([...re?.entries()??[],...oe?.entries()??[]]))});let z=[],M=[],Ir={};a.forEach(L=>{let{element:re,player:oe,instruction:le}=L;if(n.has(re)){if(u.has(re)){oe.onDestroy(()=>Uo(re,le.toStyles)),oe.disabled=!0,oe.overrideTotalTime(le.totalTime),o.push(oe);return}let Le=Ir;if(K.size>1){let B=re,V=[];for(;B=B.parentNode;){let W=K.get(B);if(W){Le=W;break}V.push(B)}V.forEach(W=>K.set(W,Le))}let b=this._buildAnimation(oe.namespaceId,le,S,i,Ze,_e);if(oe.setRealPlayer(b),Le===Ir)z.push(oe);else{let B=this.playersByElement.get(Le);B&&B.length&&(oe.parentPlayer=_a(B)),o.push(oe)}}else js(re,le.fromStyles),oe.onDestroy(()=>Uo(re,le.toStyles)),M.push(oe),u.has(re)&&o.push(oe)}),M.forEach(L=>{let re=i.get(L.element);if(re&&re.length){let oe=_a(re);L.setRealPlayer(oe)}}),o.forEach(L=>{L.parentPlayer?L.syncPlayerEvents(L.parentPlayer):L.destroy()});for(let L=0;L<_.length;L++){let re=_[L],oe=re[po];if(Gl(re,lT),oe&&oe.hasAnimation)continue;let le=[];if(s.size){let b=s.get(re);b&&b.length&&le.push(...b);let B=this.driver.query(re,uT,!0);for(let V=0;V<B.length;V++){let W=s.get(B[V]);W&&W.length&&le.push(...W)}}let Le=le.filter(b=>!b.destroyed);Le.length?Sx(this,re,Le):this.processLeaveNode(re)}return _.length=0,z.forEach(L=>{this.players.push(L),L.onDone(()=>{L.destroy();let re=this.players.indexOf(L);this.players.splice(re,1)}),L.play()}),z}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,o,i){let a=[];if(t){let s=this.playersByQueriedElement.get(e);s&&(a=s)}else{let s=this.playersByElement.get(e);if(s){let c=!i||i==_h;s.forEach(l=>{l.queued||!c&&l.triggerName!=o||a.push(l)})}}return(n||o)&&(a=a.filter(s=>!(n&&n!=s.namespaceId||o&&o!=s.triggerName))),a}_beforeAnimationBuild(e,t,n){let o=t.triggerName,i=t.element,a=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:o;for(let c of t.timelines){let l=c.element,u=l!==i,d=Rn(n,l,[]);this._getPreviousPlayers(l,u,a,s,t.toState).forEach(f=>{let p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),d.push(f)})}js(i,t.fromStyles)}_buildAnimation(e,t,n,o,i,a){let s=t.triggerName,c=t.element,l=[],u=new Set,d=new Set,h=t.timelines.map(p=>{let m=p.element;u.add(m);let _=m[po];if(_&&_.removedBeforeQueried)return new Bl(p.duration,p.delay);let T=m!==c,E=Ax((n.get(m)||vx).map(S=>S.getRealPlayer())).filter(S=>{let K=S;return K.element?K.element===m:!1}),y=i.get(m),A=a.get(m),w=XN(this._normalizer,p.keyframes,y,A),O=this._buildPlayer(p,w,E);if(p.subTimeline&&o&&d.add(m),T){let S=new yh(e,s,m);S.setRealPlayer(O),l.push(S)}return O});l.forEach(p=>{Rn(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>Tx(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>qn(p,HN));let f=_a(h);return f.onDestroy(()=>{u.forEach(p=>Gl(p,HN)),Uo(c,t.toStyles)}),d.forEach(p=>{Rn(o,p,[]).push(f)}),f}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Bl(e.duration,e.delay)}},yh=class{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Bl,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(o=>IT(e,n,void 0,o))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Rn(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let t=this._player;t.triggerCallback&&t.triggerCallback(e)}};function Tx(r,e,t){let n=r.get(e);if(n){if(n.length){let o=n.indexOf(t);n.splice(o,1)}n.length==0&&r.delete(e)}return n}function yx(r){return r??null}function Mm(r){return r&&r.nodeType===1}function Cx(r){return r=="start"||r=="done"}function jN(r,e){let t=r.style.display;return r.style.display=e??"none",t}function WN(r,e,t,n,o){let i=[];t.forEach(c=>i.push(jN(c)));let a=[];n.forEach((c,l)=>{let u=new Map;c.forEach(d=>{let h=e.computeStyle(l,d,o);u.set(d,h),(!h||h.length==0)&&(l[po]=Ex,a.push(l))}),r.set(l,u)});let s=0;return t.forEach(c=>jN(c,i[s++])),a}function $N(r,e){let t=new Map;if(r.forEach(s=>t.set(s,[])),e.length==0)return t;let n=1,o=new Set(e),i=new Map;function a(s){if(!s)return n;let c=i.get(s);if(c)return c;let l=s.parentNode;return t.has(l)?c=l:o.has(l)?c=n:c=a(l),i.set(s,c),c}return e.forEach(s=>{let c=a(s);c!==n&&t.get(c).push(s)}),t}function qn(r,e){r.classList?.add(e)}function Gl(r,e){r.classList?.remove(e)}function Sx(r,e,t){_a(t).onDone(()=>r.processLeaveNode(e))}function Ax(r){let e=[];return cR(r,e),e}function cR(r,e){for(let t=0;t<r.length;t++){let n=r[t];n instanceof QE?cR(n.players,e):e.push(n)}}function Ix(r,e){let t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let o=0;o<t.length;o++){let i=t[o];if(!e.hasOwnProperty(i)||r[i]!==e[i])return!1}return!0}function QN(r,e,t){let n=t.get(r);if(!n)return!1;let o=e.get(r);return o?n.forEach(i=>o.add(i)):e.set(r,n),t.delete(r),!0}var ql=class{constructor(e,t,n){this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(o,i)=>{},this._transitionEngine=new CT(e.body,t,n),this._timelineEngine=new TT(e.body,t,n),this._transitionEngine.onRemovalComplete=(o,i)=>this.onRemovalComplete(o,i)}registerTrigger(e,t,n,o,i){let a=e+"-"+o,s=this._triggerCache[a];if(!s){let c=[],l=[],u=oR(this._driver,i,c,l);if(c.length)throw Ik(o,c);l.length&&void 0,s=dx(o,u,this._normalizer),this._triggerCache[a]=s}this._transitionEngine.registerTrigger(t,o,s)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,o){this._transitionEngine.insertNode(e,t,n,o)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,o){if(n.charAt(0)=="@"){let[i,a]=FN(n),s=o;this._timelineEngine.command(i,t,a,s)}else this._transitionEngine.trigger(e,t,n,o)}listen(e,t,n,o,i){if(n.charAt(0)=="@"){let[a,s]=FN(n);return this._timelineEngine.listen(a,t,s,i)}return this._transitionEngine.listen(e,t,n,o,i)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function Nx(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=cT(e[0]),e.length>1&&(n=cT(e[e.length-1]))):e instanceof Map&&(t=cT(e)),t||n?new ST(r,t,n):null}var ST=class r{static{this.initialStylesByElement=new WeakMap}constructor(e,t,n){this._element=e,this._startStyles=t,this._endStyles=n,this._state=0;let o=r.initialStylesByElement.get(e);o||r.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Uo(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Uo(this._element,this._initialStyles),this._endStyles&&(Uo(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(r.initialStylesByElement.delete(this._element),this._startStyles&&(js(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(js(this._element,this._endStyles),this._endStyles=null),Uo(this._element,this._initialStyles),this._state=3)}};function cT(r){let e=null;return r.forEach((t,n)=>{Rx(n)&&(e=e||new Map,e.set(n,t))}),e}function Rx(r){return r==="display"||r==="position"}var qm=class{constructor(e,t,n,o){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,o)=>{o!=="offset"&&e.set(o,this._finished?n:DT(this.element,o))}),this.currentSnapshot=e}triggerCallback(e){let t=e==="start"?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}},zm=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return JN(e,t)}getParentElement(e){return RT(e)}query(e,t,n){return ZN(e,t,n)}computeStyle(e,t,n){return DT(e,t)}animate(e,t,n,o,i,a=[]){let s=o==0?"both":"forwards",c={duration:n,delay:o,fill:s};i&&(c.easing=i);let l=new Map,u=a.filter(f=>f instanceof qm);jk(n,o)&&u.forEach(f=>{f.currentSnapshot.forEach((p,m)=>l.set(m,p))});let d=qk(t).map(f=>new Map(f));d=Wk(e,d,l);let h=Nx(e,d);return new qm(e,d,c,h)}};var Lm="@",lR="@.disabled",Vm=class{constructor(e,t,n,o){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=o,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,o=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,o)}removeChild(e,t,n){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,o){this.delegate.setAttribute(e,t,n,o)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,o){this.delegate.setStyle(e,t,n,o)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){t.charAt(0)==Lm&&t==lR?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}},AT=class extends Vm{constructor(e,t,n,o,i){super(t,n,o,i),this.factory=e,this.namespaceId=t}setProperty(e,t,n){t.charAt(0)==Lm?t.charAt(1)=="."&&t==lR?(n=n===void 0?!0:!!n,this.disableAnimations(e,n)):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if(t.charAt(0)==Lm){let o=wx(e),i=t.slice(1),a="";return i.charAt(0)!=Lm&&([i,a]=bx(i)),this.engine.listen(this.namespaceId,o,i,a,s=>{let c=s._data||-1;this.factory.scheduleListenerCallback(c,n,s)})}return this.delegate.listen(e,t,n)}};function wx(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}function bx(r){let e=r.indexOf("."),t=r.substring(0,e),n=r.slice(e+1);return[t,n]}var jm=class{constructor(e,t,n){this.delegate=e,this.engine=t,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(o,i)=>{i?.removeChild(null,o)}}createRenderer(e,t){let n="",o=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){let l=this._rendererCache,u=l.get(o);if(!u){let d=()=>l.delete(o);u=new Vm(n,o,this.engine,d),l.set(o,u)}return u}let i=t.id,a=t.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);let s=l=>{Array.isArray(l)?l.forEach(s):this.engine.registerTrigger(i,a,e,l.name,l)};return t.data.animation.forEach(s),new AT(this,a,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,n){if(e>=0&&e<this._microtaskId){this._zone.run(()=>t(n));return}let o=this._animationCallbacksBuffer;o.length==0&&queueMicrotask(()=>{this._zone.run(()=>{o.forEach(i=>{let[a,s]=i;a(s)}),this._animationCallbacksBuffer=[]})}),o.push([t,n])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var Px=(()=>{class r extends ql{constructor(t,n,o){super(t,n,o)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(n){return new(n||r)(Re(gm),Re(Ws),Re($s))}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac})}}return r})();function Ox(){return new Ym}function kx(r,e,t){return new jm(r,e,t)}var dR=[{provide:$s,useFactory:Ox},{provide:ql,useClass:Px},{provide:jI,useFactory:kx,deps:[nN,ql,fm]}],uR=[{provide:Ws,useFactory:()=>new zm},{provide:qE,useValue:"BrowserAnimations"},...dR],xx=[{provide:Ws,useClass:wT},{provide:qE,useValue:"NoopAnimations"},...dR],hR=(()=>{class r{static withConfig(t){return{ngModule:r,providers:t.disableAnimations?xx:uR}}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=rn({type:r})}static{this.\u0275inj=tn({providers:uR,imports:[Tm]})}}return r})();var kg={};ho(kg,{blockAPICallsBeforeInitialize:()=>Pg,blockAcquireTokenInPopups:()=>QR,blockNonBrowserEnvironment:()=>XR,blockRedirectInIframe:()=>$R,blockReloadInHiddenIframes:()=>WR,clearHash:()=>Gy,createGuid:()=>NM,getCurrentUri:()=>an,getHomepage:()=>zy,invoke:()=>jr,invokeAsync:()=>Y,isInIframe:()=>hf,isInPopup:()=>jR,preconnect:()=>pf,preflightCheck:()=>ff,redirectPreflightCheck:()=>Og,replaceHash:()=>qy});var R={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},zl={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},wn=[R.OPENID_SCOPE,R.PROFILE_SCOPE,R.OFFLINE_ACCESS_SCOPE],OT=[...wn,R.EMAIL_SCOPE],wr={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},kt={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},mo={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Vl={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},ft={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Wm={PLAIN:"plain",S256:"S256"},go={QUERY:"query",FRAGMENT:"fragment"},kT=ie(U({},go),{FORM_POST:"form_post"}),Ch={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},jl={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},Rt={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},pe={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var Sh="appmetadata",fR="client_info",va="1",Wl={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Gr={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},jt={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},xe={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Ei={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},$m={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Qm={username:"username",password:"password"},Ah={httpSuccess:200,httpBadRequest:400},Qs={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Xm={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},_o={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},Jm={Jwt:"JWT",Jwk:"JWK",Pop:"pop"};var xT=300;var Xs={};ho(Xs,{postRequestFailed:()=>Nh,unexpectedError:()=>Ih});var Ih="unexpected_error",Nh="post_request_failed";var Zm={[Ih]:"Unexpected error in authentication.",[Nh]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},pR={unexpectedError:{code:Ih,desc:Zm[Ih]},postRequestFailed:{code:Nh,desc:Zm[Nh]}},Pe=class r extends Error{constructor(e,t,n){let o=t?`${e}: ${t}`:e;super(o),Object.setPrototypeOf(this,r.prototype),this.errorCode=e||R.EMPTY_STRING,this.errorMessage=t||R.EMPTY_STRING,this.subError=n||R.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function Rh(r,e){return new Pe(r,e?`${Zm[r]} ${e}`:Zm[r])}var Wt={};ho(Wt,{authTimeNotFound:()=>Ti,authorizationCodeMissingFromServerResponse:()=>hc,bindingKeyNotRemoved:()=>fc,cannotAppendScopeSet:()=>lc,cannotRemoveEmptyScope:()=>cc,clientInfoDecodingError:()=>Ea,clientInfoEmptyError:()=>Js,deviceCodeExpired:()=>Ph,deviceCodePollingCancelled:()=>Dh,deviceCodeUnknownError:()=>Oh,emptyInputScopeSet:()=>Ca,endSessionEndpointNotSupported:()=>pc,endpointResolutionError:()=>qr,hashNotDeserialized:()=>rc,invalidAssertion:()=>Mh,invalidCacheEnvironment:()=>Ci,invalidCacheRecord:()=>uc,invalidClientCredential:()=>Lh,invalidState:()=>vo,keyIdMissing:()=>mc,maxAgeTranspired:()=>ic,methodNotImplemented:()=>ye,missingTenantIdError:()=>Hh,multipleMatchingAccounts:()=>bh,multipleMatchingAppMetadata:()=>ac,multipleMatchingTokens:()=>wh,nestedAppAuthBridgeDisabled:()=>Bh,networkError:()=>ec,noAccountFound:()=>kh,noAccountInSilentRequest:()=>yi,noCryptoObject:()=>Sa,noNetworkConnectivity:()=>Fh,nonceMismatch:()=>oc,nullOrEmptyToken:()=>Zs,openIdConfigError:()=>tc,requestCannotBeMade:()=>sc,stateMismatch:()=>nc,stateNotFound:()=>ya,tokenClaimsCnfRequiredForSignedJwt:()=>dc,tokenParsingError:()=>Ta,tokenRefreshRequired:()=>Fo,unexpectedCredentialType:()=>xh,userCanceled:()=>Yh,userTimeoutReached:()=>Uh});var Ea="client_info_decoding_error",Js="client_info_empty_error",Ta="token_parsing_error",Zs="null_or_empty_token",qr="endpoints_resolution_error",ec="network_error",tc="openid_config_error",rc="hash_not_deserialized",vo="invalid_state",nc="state_mismatch",ya="state_not_found",oc="nonce_mismatch",Ti="auth_time_not_found",ic="max_age_transpired",wh="multiple_matching_tokens",bh="multiple_matching_accounts",ac="multiple_matching_appMetadata",sc="request_cannot_be_made",cc="cannot_remove_empty_scope",lc="cannot_append_scopeset",Ca="empty_input_scopeset",Dh="device_code_polling_cancelled",Ph="device_code_expired",Oh="device_code_unknown_error",yi="no_account_in_silent_request",uc="invalid_cache_record",Ci="invalid_cache_environment",kh="no_account_found",Sa="no_crypto_object",xh="unexpected_credential_type",Mh="invalid_assertion",Lh="invalid_client_credential",Fo="token_refresh_required",Uh="user_timeout_reached",dc="token_claims_cnf_required_for_signedjwt",hc="authorization_code_missing_from_server_response",fc="binding_key_not_removed",pc="end_session_endpoint_not_supported",mc="key_id_missing",Fh="no_network_connectivity",Yh="user_canceled",Hh="missing_tenant_id_error",ye="method_not_implemented",Bh="nested_app_auth_bridge_disabled";var Ae={[Ea]:"The client info could not be parsed/decoded correctly",[Js]:"The client info was empty",[Ta]:"Token cannot be parsed",[Zs]:"The token is null or empty",[qr]:"Endpoints cannot be resolved",[ec]:"Network request failed",[tc]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[rc]:"The hash parameters could not be deserialized",[vo]:"State was not the expected format",[nc]:"State mismatch error",[ya]:"State not found",[oc]:"Nonce mismatch error",[Ti]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[ic]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[wh]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[bh]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[ac]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[sc]:"Token request cannot be made without authorization code or refresh token.",[cc]:"Cannot remove null or empty scope from ScopeSet",[lc]:"Cannot append ScopeSet",[Ca]:"Empty input ScopeSet cannot be processed",[Dh]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Ph]:"Device code is expired.",[Oh]:"Device code stopped polling for unknown reasons.",[yi]:"Please pass an account object, silent flow is not supported without account information",[uc]:"Cache record object was null or undefined.",[Ci]:"Invalid environment when attempting to create cache entry",[kh]:"No account found in cache for given key.",[Sa]:"No crypto object detected.",[xh]:"Unexpected credential type.",[Mh]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Lh]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Fo]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Uh]:"User defined timeout for device code polling reached",[dc]:"Cannot generate a POP jwt if the token_claims are not populated",[hc]:"Server response does not contain an authorization code to proceed",[fc]:"Could not remove the credential's binding key from storage.",[pc]:"The provided authority does not support logout",[mc]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Fh]:"No network connectivity. Check your internet connection.",[Yh]:"User cancelled the flow.",[Hh]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[ye]:"This method has not been implemented",[Bh]:"The nested app auth bridge is disabled"},mR={clientInfoDecodingError:{code:Ea,desc:Ae[Ea]},clientInfoEmptyError:{code:Js,desc:Ae[Js]},tokenParsingError:{code:Ta,desc:Ae[Ta]},nullOrEmptyToken:{code:Zs,desc:Ae[Zs]},endpointResolutionError:{code:qr,desc:Ae[qr]},networkError:{code:ec,desc:Ae[ec]},unableToGetOpenidConfigError:{code:tc,desc:Ae[tc]},hashNotDeserialized:{code:rc,desc:Ae[rc]},invalidStateError:{code:vo,desc:Ae[vo]},stateMismatchError:{code:nc,desc:Ae[nc]},stateNotFoundError:{code:ya,desc:Ae[ya]},nonceMismatchError:{code:oc,desc:Ae[oc]},authTimeNotFoundError:{code:Ti,desc:Ae[Ti]},maxAgeTranspired:{code:ic,desc:Ae[ic]},multipleMatchingTokens:{code:wh,desc:Ae[wh]},multipleMatchingAccounts:{code:bh,desc:Ae[bh]},multipleMatchingAppMetadata:{code:ac,desc:Ae[ac]},tokenRequestCannotBeMade:{code:sc,desc:Ae[sc]},removeEmptyScopeError:{code:cc,desc:Ae[cc]},appendScopeSetError:{code:lc,desc:Ae[lc]},emptyInputScopeSetError:{code:Ca,desc:Ae[Ca]},DeviceCodePollingCancelled:{code:Dh,desc:Ae[Dh]},DeviceCodeExpired:{code:Ph,desc:Ae[Ph]},DeviceCodeUnknownError:{code:Oh,desc:Ae[Oh]},NoAccountInSilentRequest:{code:yi,desc:Ae[yi]},invalidCacheRecord:{code:uc,desc:Ae[uc]},invalidCacheEnvironment:{code:Ci,desc:Ae[Ci]},noAccountFound:{code:kh,desc:Ae[kh]},noCryptoObj:{code:Sa,desc:Ae[Sa]},unexpectedCredentialType:{code:xh,desc:Ae[xh]},invalidAssertion:{code:Mh,desc:Ae[Mh]},invalidClientCredential:{code:Lh,desc:Ae[Lh]},tokenRefreshRequired:{code:Fo,desc:Ae[Fo]},userTimeoutReached:{code:Uh,desc:Ae[Uh]},tokenClaimsRequired:{code:dc,desc:Ae[dc]},noAuthorizationCodeFromServer:{code:hc,desc:Ae[hc]},bindingKeyNotRemovedError:{code:fc,desc:Ae[fc]},logoutNotSupported:{code:pc,desc:Ae[pc]},keyIdMissing:{code:mc,desc:Ae[mc]},noNetworkConnectivity:{code:Fh,desc:Ae[Fh]},userCanceledError:{code:Yh,desc:Ae[Yh]},missingTenantIdError:{code:Hh,desc:Ae[Hh]},nestedAppAuthBridgeDisabled:{code:Bh,desc:Ae[Bh]}},gc=class r extends Pe{constructor(e,t){super(e,t?`${Ae[e]}: ${t}`:Ae[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,r.prototype)}};function x(r,e){return new gc(r,e)}var Aa={createNewGuid:()=>{throw x(ye)},base64Decode:()=>{throw x(ye)},base64Encode:()=>{throw x(ye)},base64UrlEncode:()=>{throw x(ye)},encodeKid:()=>{throw x(ye)},getPublicKeyThumbprint(){return C(this,null,function*(){throw x(ye)})},removeTokenBindingKey(){return C(this,null,function*(){throw x(ye)})},clearKeystore(){return C(this,null,function*(){throw x(ye)})},signJwt(){return C(this,null,function*(){throw x(ye)})},hashString(){return C(this,null,function*(){throw x(ye)})}};var Xe=function(r){return r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace",r}(Xe||{}),zn=class r{constructor(e,t,n){this.level=Xe.Info;let o=()=>{},i=e||r.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:Xe.Info,this.correlationId=i.correlationId||R.EMPTY_STRING,this.packageName=t||R.EMPTY_STRING,this.packageVersion=n||R.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Xe.Info}}clone(e,t,n){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let i=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Xe[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:Xe.Error,containsPii:!1,correlationId:t||R.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Xe.Error,containsPii:!0,correlationId:t||R.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Xe.Warning,containsPii:!1,correlationId:t||R.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Xe.Warning,containsPii:!0,correlationId:t||R.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Xe.Info,containsPii:!1,correlationId:t||R.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Xe.Info,containsPii:!0,correlationId:t||R.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Xe.Verbose,containsPii:!1,correlationId:t||R.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Xe.Verbose,containsPii:!0,correlationId:t||R.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Xe.Trace,containsPii:!1,correlationId:t||R.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Xe.Trace,containsPii:!0,correlationId:t||R.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var eg="@azure/msal-common",$l="14.15.0";var Ia={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};var at={};ho(at,{createAccessTokenEntity:()=>UT,createIdTokenEntity:()=>LT,createRefreshTokenEntity:()=>FT,generateAppMetadataKey:()=>Vx,generateAuthorityMetadataExpiresAt:()=>rg,generateCredentialKey:()=>qh,isAccessTokenEntity:()=>Lx,isAppMetadataEntity:()=>jx,isAuthorityMetadataEntity:()=>Wx,isAuthorityMetadataExpired:()=>ng,isCredentialEntity:()=>tg,isIdTokenEntity:()=>Ux,isRefreshTokenEntity:()=>Fx,isServerTelemetryEntity:()=>qx,isThrottlingEntity:()=>zx,updateAuthorityEndpointMetadata:()=>Xl,updateCloudDiscoveryMetadata:()=>zh});var Na={};ho(Na,{checkMaxAge:()=>Kh,extractTokenClaims:()=>Si,getJWSPayload:()=>gR});function Si(r,e){let t=gR(r);try{let n=e(t);return JSON.parse(n)}catch{throw x(Ta)}}function gR(r){if(!r)throw x(Zs);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(r);if(!t||t.length<4)throw x(Ta);return t[2]}function Kh(r,e){if(e===0||Date.now()-3e5>r+e)throw x(ic)}var Gh={};ho(Gh,{delay:()=>Mx,isTokenExpired:()=>Ql,nowSeconds:()=>bn,wasClockTurnedBack:()=>MT});function bn(){return Math.round(new Date().getTime()/1e3)}function Ql(r,e){let t=Number(r)||0;return bn()+e>t}function MT(r){return Number(r)>bn()}function Mx(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function qh(r){return[Yx(r),Hx(r),Bx(r),Kx(r),Gx(r)].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}function LT(r,e,t,n,o){return{credentialType:pe.ID_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t,realm:o}}function UT(r,e,t,n,o,i,a,s,c,l,u,d,h,f,p){let m={homeAccountId:r,credentialType:pe.ACCESS_TOKEN,secret:t,cachedAt:bn().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:e,clientId:n,realm:o,target:i,tokenType:u||xe.BEARER};if(d&&(m.userAssertionHash=d),l&&(m.refreshOn=l.toString()),f&&(m.requestedClaims=f,m.requestedClaimsHash=p),m.tokenType?.toLowerCase()!==xe.BEARER.toLowerCase())switch(m.credentialType=pe.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case xe.POP:let _=Si(t,c);if(!_?.cnf?.kid)throw x(dc);m.keyId=_.cnf.kid;break;case xe.SSH:m.keyId=h}return m}function FT(r,e,t,n,o,i,a){let s={credentialType:pe.REFRESH_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function tg(r){return r.hasOwnProperty("homeAccountId")&&r.hasOwnProperty("environment")&&r.hasOwnProperty("credentialType")&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("secret")}function Lx(r){return r?tg(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===pe.ACCESS_TOKEN||r.credentialType===pe.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function Ux(r){return r?tg(r)&&r.hasOwnProperty("realm")&&r.credentialType===pe.ID_TOKEN:!1}function Fx(r){return r?tg(r)&&r.credentialType===pe.REFRESH_TOKEN:!1}function Yx(r){return[r.homeAccountId,r.environment].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}function Hx(r){let e=r.credentialType===pe.REFRESH_TOKEN&&r.familyId||r.clientId;return[r.credentialType,e,r.realm||""].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}function Bx(r){return(r.target||"").toLowerCase()}function Kx(r){return(r.requestedClaimsHash||"").toLowerCase()}function Gx(r){return r.tokenType&&r.tokenType.toLowerCase()!==xe.BEARER.toLowerCase()?r.tokenType.toLowerCase():""}function qx(r,e){let t=r.indexOf(jt.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&n}function zx(r,e){let t=!1;r&&(t=r.indexOf(Ei.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),t&&n}function Vx({environment:r,clientId:e}){return[Sh,r,e].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}function jx(r,e){return e?r.indexOf(Sh)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function Wx(r,e){return e?r.indexOf(Wl.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function rg(){return bn()+Wl.REFRESH_TIME_SECONDS}function Xl(r,e,t){r.authorization_endpoint=e.authorization_endpoint,r.token_endpoint=e.token_endpoint,r.end_session_endpoint=e.end_session_endpoint,r.issuer=e.issuer,r.endpointsFromNetwork=t,r.jwks_uri=e.jwks_uri}function zh(r,e,t){r.aliases=e.aliases,r.preferred_cache=e.preferred_cache,r.preferred_network=e.preferred_network,r.aliasesFromNetwork=t}function ng(r){return r.expiresAt<=bn()}var Eo={};ho(Eo,{authorityMismatch:()=>Jh,authorityUriInsecure:()=>vc,cannotAllowNativeBroker:()=>Xh,cannotSetOIDCOptions:()=>Qh,claimsRequestParsingError:()=>Vh,emptyInputScopesError:()=>Tc,invalidAuthenticationHeader:()=>$h,invalidAuthorityMetadata:()=>Ic,invalidClaims:()=>Ai,invalidCloudDiscoveryMetadata:()=>Ra,invalidCodeChallengeMethod:()=>Ac,invalidPromptValue:()=>yc,logoutRequestEmpty:()=>Sc,missingNonceAuthenticationHeader:()=>Wh,missingSshJwk:()=>Ni,missingSshKid:()=>jh,pkceParamsMissing:()=>Ii,redirectUriEmpty:()=>_c,tokenRequestEmpty:()=>Cc,untrustedAuthority:()=>Nc,urlEmptyError:()=>Ec,urlParseError:()=>Yo});var _c="redirect_uri_empty",Vh="claims_request_parsing_error",vc="authority_uri_insecure",Yo="url_parse_error",Ec="empty_url_error",Tc="empty_input_scopes_error",yc="invalid_prompt_value",Ai="invalid_claims",Cc="token_request_empty",Sc="logout_request_empty",Ac="invalid_code_challenge_method",Ii="pkce_params_missing",Ra="invalid_cloud_discovery_metadata",Ic="invalid_authority_metadata",Nc="untrusted_authority",Ni="missing_ssh_jwk",jh="missing_ssh_kid",Wh="missing_nonce_authentication_header",$h="invalid_authentication_header",Qh="cannot_set_OIDCOptions",Xh="cannot_allow_native_broker",Jh="authority_mismatch";var St={[_c]:"A redirect URI is required for all calls, and none has been set.",[Vh]:"Could not parse the given claims request object.",[vc]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Yo]:"URL could not be parsed into appropriate segments.",[Ec]:"URL was empty or null.",[Tc]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[yc]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Ai]:"Given claims parameter must be a stringified JSON object.",[Cc]:"Token request was empty and not found in cache.",[Sc]:"The logout request was null or undefined.",[Ac]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Ii]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Ra]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Ic]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Nc]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Ni]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[jh]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Wh]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[$h]:"Invalid authentication header provided",[Qh]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Xh]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[Jh]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},_R={redirectUriNotSet:{code:_c,desc:St[_c]},claimsRequestParsingError:{code:Vh,desc:St[Vh]},authorityUriInsecure:{code:vc,desc:St[vc]},urlParseError:{code:Yo,desc:St[Yo]},urlEmptyError:{code:Ec,desc:St[Ec]},emptyScopesError:{code:Tc,desc:St[Tc]},invalidPrompt:{code:yc,desc:St[yc]},invalidClaimsRequest:{code:Ai,desc:St[Ai]},tokenRequestEmptyError:{code:Cc,desc:St[Cc]},logoutRequestEmptyError:{code:Sc,desc:St[Sc]},invalidCodeChallengeMethod:{code:Ac,desc:St[Ac]},invalidCodeChallengeParams:{code:Ii,desc:St[Ii]},invalidCloudDiscoveryMetadata:{code:Ra,desc:St[Ra]},invalidAuthorityMetadata:{code:Ic,desc:St[Ic]},untrustedAuthority:{code:Nc,desc:St[Nc]},missingSshJwk:{code:Ni,desc:St[Ni]},missingSshKid:{code:jh,desc:St[jh]},missingNonceAuthenticationHeader:{code:Wh,desc:St[Wh]},invalidAuthenticationHeader:{code:$h,desc:St[$h]},cannotSetOIDCOptions:{code:Qh,desc:St[Qh]},cannotAllowNativeBroker:{code:Xh,desc:St[Xh]},authorityMismatch:{code:Jh,desc:St[Jh]}},Zh=class r extends Pe{constructor(e){super(e,St[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,r.prototype)}};function Me(r){return new Zh(r)}var Et=class{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},n=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return n.forEach(i=>{if(i.trim()){let[a,s]=i.split(/=(.+)/g,2);a&&s&&(t[o(a)]=o(s))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}};var pt=class r{constructor(e){let t=e?Et.trimArrayEntries([...e]):[],n=t?Et.removeEmptyStringsFromArray(t):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(o=>this.scopes.add(o))}static fromString(e){let n=(e||R.EMPTY_STRING).split(" ");return new r(n)}static createSearchScopes(e){let t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(R.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw Me(Tc)}containsScope(e){let t=this.printScopesLowerCase().split(" "),n=new r(t);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return OT.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw x(lc)}}removeScope(e){if(!e)throw x(cc);this.scopes.delete(e.trim())}removeOIDCScopes(){OT.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw x(Ca);let t=new Set;return e.scopes.forEach(n=>t.add(n.toLowerCase())),this.scopes.forEach(n=>t.add(n.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw x(Ca);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),n=e.getScopeCount(),o=this.getScopeCount();return t.size<o+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):R.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function Jl(r,e){if(!r)throw x(Js);try{let t=e(r);return JSON.parse(t)}catch{throw x(Ea)}}function Ri(r){if(!r)throw x(Ea);let e=r.split(Rt.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?R.EMPTY_STRING:e[1]}}function Zl(r,e){return!!r&&!!e&&r===e.split(".")[1]}function eu(r,e,t,n){if(n){let{oid:o,sub:i,tid:a,name:s,tfp:c,acr:l}=n,u=a||c||l||"";return{tenantId:u,localAccountId:o||i||"",name:s,isHomeTenant:Zl(u,r)}}else return{tenantId:t,localAccountId:e,isHomeTenant:Zl(t,r)}}function Rc(r,e,t,n){let o=r;if(e){let i=e,{isHomeTenant:s}=i,c=xo(i,["isHomeTenant"]);o=U(U({},r),c)}if(t){let a=eu(r.homeAccountId,r.localAccountId,r.tenantId,t),{isHomeTenant:s}=a,c=xo(a,["isHomeTenant"]);return o=ie(U(U({},o),c),{idTokenClaims:t,idToken:n}),o}return o}var zr={Default:0,Adfs:1,Dsts:2,Ciam:3};function og(r){return r&&(r.tid||r.tfp||r.acr)||null}var yr={AAD:"AAD",OIDC:"OIDC"};var st=class r{generateAccountId(){return[this.homeAccountId,this.environment].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){let o=new r;t.authorityType===zr.Adfs?o.authorityType=jl.ADFS_ACCOUNT_TYPE:t.protocolMode===yr.AAD?o.authorityType=jl.MSSTS_ACCOUNT_TYPE:o.authorityType=jl.GENERIC_ACCOUNT_TYPE;let i;e.clientInfo&&n&&(i=Jl(e.clientInfo,n)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;let a=e.environment||t&&t.getPreferredCache();if(!a)throw x(Ci);o.environment=a,o.realm=i?.utid||og(e.idTokenClaims)||"",o.localAccountId=i?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let s=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,c=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(o.username=s||c||"",o.name=e.idTokenClaims?.name||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{let l=eu(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[l]}return o}static createFromAccountInfo(e,t,n){let o=new r;return o.authorityType=e.authorityType||jl.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=t,o.msGraphHost=n,o.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),o}static generateHomeAccountId(e,t,n,o,i){if(!(t===zr.Adfs||t===zr.Dsts)){if(e)try{let a=Jl(e,o.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}n.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let o=!0;if(n){let i=e.idTokenClaims||{},a=t.idTokenClaims||{};o=i.iat===a.iat&&i.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o}};var wa={};ho(wa,{getDeserializedResponse:()=>YT,stripLeadingHashOrQuery:()=>vR});function vR(r){return r.startsWith("#/")?r.substring(2):r.startsWith("#")||r.startsWith("?")?r.substring(1):r}function YT(r){if(!r||r.indexOf("=")<0)return null;try{let e=vR(r),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw x(rc)}return null}var Ie=class r{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Me(Ec);e.includes("#")||(this._urlString=r.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Et.endsWith(t,"?")?t=t.slice(0,-1):Et.endsWith(t,"?/")&&(t=t.slice(0,-2)),Et.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Me(Yo)}if(!e.HostNameAndPort||!e.PathSegments)throw Me(Yo);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Me(vc)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return r.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===mo.COMMON||n[0]===mo.ORGANIZATIONS)&&(n[0]=e),r.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Me(Yo);let n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=n.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),n.PathSegments=o,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw Me(Yo);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===R.FORWARD_SLASH){let o=new r(t).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!YT(e)}};var TR={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},HT=TR.endpointMetadata,BT=TR.instanceDiscoveryMetadata,KT=new Set;BT.metadata.forEach(r=>{r.aliases.forEach(e=>{KT.add(e)})});function yR(r,e){let t,n=r.canonicalAuthority;if(n){let o=new Ie(n).getUrlComponents().HostNameAndPort;t=ER(o,r.cloudDiscoveryMetadata?.metadata,Gr.CONFIG,e)||ER(o,BT.metadata,Gr.HARDCODED_VALUES,e)||r.knownAuthorities}return t||[]}function ER(r,e,t,n){if(n?.trace(`getAliasesFromMetadata called with source: ${t}`),r&&e){let o=ef(e,r);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function CR(r){return ef(BT.metadata,r)}function ef(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(n.aliases.includes(e))return n}return null}var ig="cache_quota_exceeded",tf="cache_error_unknown";var GT={[ig]:"Exceeded cache storage capacity.",[tf]:"Unexpected error occurred when using cache storage."},wi=class r extends Error{constructor(e,t){let n=t||(GT[e]?GT[e]:GT[tf]);super(`${e}: ${n}`),Object.setPrototypeOf(this,r.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};var bi=class r{constructor(e,t,n,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(eg,$l),this.staticAuthorityOptions=o}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){let t=this.getAllAccounts(e);return t.length>1?t.sort(o=>o.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){let t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(n=>this.getTenantProfilesFromAccountEntity(n,t?.tenantId,t))}getTenantedAccountInfoByFilter(e,t,n,o){let i=null,a;if(o&&!this.tenantProfileMatchesFilter(n,o))return null;let s=this.getIdToken(e,t,n.tenantId);return s&&(a=Si(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,o))?null:(i=Rc(e,n,a,s?.secret),i)}getTenantProfilesFromAccountEntity(e,t,n){let o=e.getAccountInfo(),i=o.tenantProfiles||new Map,a=this.getTokenKeys();if(t){let c=i.get(t);if(c)i=new Map([[t,c]]);else return[]}let s=[];return i.forEach(c=>{let l=this.getTenantedAccountInfoByFilter(o,a,c,n);l&&s.push(l)}),s}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}saveCacheRecord(e,t,n){return C(this,null,function*(){if(!e)throw x(uc);try{e.account&&this.setAccount(e.account),e.idToken&&t?.idToken!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&t?.accessToken!==!1&&(yield this.saveAccessToken(e.accessToken)),e.refreshToken&&t?.refreshToken!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(o){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),o instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${o.message}`,n),o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED"||o.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",n),new wi(ig)):new wi(o.name,o.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${o}`,n),new wi(tf))}})}saveAccessToken(e){return C(this,null,function*(){let t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=pt.fromString(e.target),i=[];n.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,t,!1))return;let s=this.getAccessTokenCredential(a);s&&this.credentialMatchesFilter(s,t)&&pt.fromString(s.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(a))}),yield Promise.all(i),this.setAccessTokenCredential(e)})}getAccountsFilteredBy(e){let t=this.getAccountKeys(),n=[];return t.forEach(o=>{if(!this.isAccountKey(o,e.homeAccountId))return;let i=this.getAccount(o,this.commonLogger);if(!i||e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.username&&!this.matchUsername(i.username,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;let a={localAccountId:e?.localAccountId,name:e?.name},s=i.tenantProfiles?.filter(c=>this.tenantProfileMatchesFilter(c,a));s&&s.length===0||n.push(i)}),n}isAccountKey(e,t,n){return!(e.split(Rt.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split(Rt.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(t.indexOf(pe.ID_TOKEN.toLowerCase())===-1&&t.indexOf(pe.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(pe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(pe.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(pe.REFRESH_TOKEN.toLowerCase())>-1){let n=`${pe.REFRESH_TOKEN}${Rt.CACHE_KEY_SEPARATOR}${this.clientId}${Rt.CACHE_KEY_SEPARATOR}`,o=`${pe.REFRESH_TOKEN}${Rt.CACHE_KEY_SEPARATOR}${va}${Rt.CACHE_KEY_SEPARATOR}`;if(t.indexOf(n.toLowerCase())===-1&&t.indexOf(o.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===pe.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===xe.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),n={};return t.forEach(o=>{if(!this.isAppMetadata(o))return;let i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(n[o]=i))}),n}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),n=null;return t.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;let i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(n=i)}),n}removeAllAccounts(){return C(this,null,function*(){let e=this.getAccountKeys(),t=[];e.forEach(n=>{t.push(this.removeAccount(n))}),yield Promise.all(t)})}removeAccount(e){return C(this,null,function*(){let t=this.getAccount(e,this.commonLogger);t&&(yield this.removeAccountContext(t),this.removeItem(e))})}removeAccountContext(e){return C(this,null,function*(){let t=this.getTokenKeys(),n=e.generateAccountId(),o=[];t.idToken.forEach(i=>{i.indexOf(n)===0&&this.removeIdToken(i)}),t.accessToken.forEach(i=>{i.indexOf(n)===0&&o.push(this.removeAccessToken(i))}),t.refreshToken.forEach(i=>{i.indexOf(n)===0&&this.removeRefreshToken(i)}),yield Promise.all(o)})}updateOutdatedCachedAccount(e,t,n){if(t&&t.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");let o=this.getAccountKeys().filter(l=>l.startsWith(t.homeAccountId)),i=[];o.forEach(l=>{let u=this.getCachedAccountEntity(l);u&&i.push(u)});let a=i.find(l=>Zl(l.realm,l.homeAccountId))||i[0];a.tenantProfiles=i.map(l=>({tenantId:l.realm,localAccountId:l.localAccountId,name:l.name,isHomeTenant:Zl(l.realm,l.homeAccountId)}));let s=r.toObject(new st,U({},a)),c=s.generateAccountKey();return o.forEach(l=>{l!==c&&this.removeOutdatedAccount(e)}),this.setAccount(s),n?.verbose("Updated an outdated account entity in the cache"),s}return t}removeAccessToken(e){return C(this,null,function*(){let t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===pe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===xe.POP){let o=t.keyId;if(o)try{yield this.cryptoImpl.removeTokenBindingKey(o)}catch{throw x(fc)}}return this.removeItem(e)}})}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){let t=st.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getIdToken called");let a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:pe.ID_TOKEN,clientId:this.clientId,realm:n},s=this.getIdTokensByFilter(a,t),c=s.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let l=s;if(!n){let u=new Map;s.forEach((h,f)=>{h.realm===e.tenantId&&u.set(f,h)});let d=u.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(d===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;l=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),l.forEach((u,d)=>{this.removeIdToken(d)}),o&&i&&o.addFields({multiMatchedID:s.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t){let n=t&&t.idToken||this.getTokenKeys().idToken,o=new Map;return n.forEach(i=>{if(!this.idTokenKeyMatchesFilter(i,U({clientId:this.clientId},e)))return;let a=this.getIdTokenCredential(i);a&&this.credentialMatchesFilter(a,e)&&o.set(i,a)}),o}idTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,n,o,i,a){this.commonLogger.trace("CacheManager - getAccessToken called");let s=pt.createSearchScopes(t.scopes),c=t.authenticationScheme||xe.BEARER,l=c&&c.toLowerCase()!==xe.BEARER.toLowerCase()?pe.ACCESS_TOKEN_WITH_AUTH_SCHEME:pe.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:o||e.tenantId,target:s,tokenType:c,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=n&&n.accessToken||this.getTokenKeys().accessToken,h=[];d.forEach(p=>{if(this.accessTokenKeyMatchesFilter(p,u,!0)){let m=this.getAccessTokenCredential(p);m&&this.credentialMatchesFilter(m,u)&&h.push(m)}});let f=h.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),h.forEach(p=>{this.removeAccessToken(qh(p))}),i&&a&&i.addFields({multiMatchedAT:h.length},a),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),h[0])}accessTokenKeyMatchesFilter(e,t,n){let o=e.toLowerCase();if(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&o.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&o.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){let i=t.target.asArray();for(let a=0;a<i.length;a++){if(n&&!o.includes(i[a].toLowerCase()))return!1;if(!n&&o.includes(i[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){let t=this.getTokenKeys(),n=[];return t.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,e,!0))return;let i=this.getAccessTokenCredential(o);i&&this.credentialMatchesFilter(i,e)&&n.push(i)}),n}getRefreshToken(e,t,n,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");let a=t?va:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:pe.REFRESH_TOKEN,clientId:this.clientId,familyId:a},c=n&&n.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach(d=>{if(this.refreshTokenKeyMatchesFilter(d,s)){let h=this.getRefreshTokenCredential(d);h&&this.credentialMatchesFilter(h,s)&&l.push(h)}});let u=l.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&o&&i&&o.addFields({multiMatchedRT:u},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.familyId&&n.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),o=Object.keys(n).map(a=>n[a]),i=o.length;if(i<1)return null;if(i>1)throw x(ac);return o[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===va)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){let n=e.oid||e.sub;return t===n}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return t.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,t){return!!(e&&typeof e=="string"&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let o=yR(this.staticAuthorityOptions,this.commonLogger);if(o.includes(t)&&o.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return e.realm?.toLowerCase()===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==pe.ACCESS_TOKEN&&e.credentialType!==pe.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:pt.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(Sh)!==-1}isAuthorityMetadata(e){return e.indexOf(Wl.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Wl.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let n in t)e[n]=t[n];return e}},rf=class extends bi{setAccount(){throw x(ye)}getAccount(){throw x(ye)}getCachedAccountEntity(){throw x(ye)}setIdTokenCredential(){throw x(ye)}getIdTokenCredential(){throw x(ye)}setAccessTokenCredential(){throw x(ye)}getAccessTokenCredential(){throw x(ye)}setRefreshTokenCredential(){throw x(ye)}getRefreshTokenCredential(){throw x(ye)}setAppMetadata(){throw x(ye)}getAppMetadata(){throw x(ye)}setServerTelemetry(){throw x(ye)}getServerTelemetry(){throw x(ye)}setAuthorityMetadata(){throw x(ye)}getAuthorityMetadata(){throw x(ye)}getAuthorityMetadataKeys(){throw x(ye)}setThrottlingCache(){throw x(ye)}getThrottlingCache(){throw x(ye)}removeItem(){throw x(ye)}getKeys(){throw x(ye)}getAccountKeys(){throw x(ye)}getTokenKeys(){throw x(ye)}clear(){return C(this,null,function*(){throw x(ye)})}updateCredentialCacheKey(){throw x(ye)}removeOutdatedAccount(){throw x(ye)}};var ag={tokenRenewalOffsetSeconds:xT,preventCorsPreflight:!1},$x={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Xe.Info,correlationId:R.EMPTY_STRING},Qx={claimsBasedCachingEnabled:!1},Xx={sendGetRequestAsync(){return C(this,null,function*(){throw x(ye)})},sendPostRequestAsync(){return C(this,null,function*(){throw x(ye)})}},Jx={sku:R.SKU,version:$l,cpu:R.EMPTY_STRING,os:R.EMPTY_STRING},Zx={clientSecret:R.EMPTY_STRING,clientAssertion:void 0},eM={azureCloudInstance:Ia.None,tenant:`${R.DEFAULT_COMMON_TENANT}`},tM={application:{appName:"",appVersion:""}};function SR({authOptions:r,systemOptions:e,loggerOptions:t,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){let f=U(U({},$x),t);return{authOptions:rM(r),systemOptions:U(U({},ag),e),loggerOptions:f,cacheOptions:U(U({},Qx),n),storageInterface:o||new rf(r.clientId,Aa,new zn(f)),networkInterface:i||Xx,cryptoInterface:a||Aa,clientCredentials:s||Zx,libraryInfo:U(U({},Jx),c),telemetry:U(U({},tM),l),serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null}}function rM(r){return U({clientCapabilities:[],azureCloudOptions:eM,skipAuthorityMetadataCache:!1,instanceAware:!1},r)}function nf(r){return r.authOptions.authority.options.protocolMode===yr.OIDC}var Vr=class r extends Pe{constructor(e,t,n,o,i){super(e,t,n),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,r.prototype)}};var Ho=class r{static generateThrottlingStorageKey(e){return`${Ei.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){let n=r.generateThrottlingStorageKey(t),o=e.getThrottlingCache(n);if(o){if(o.throttleTime<Date.now()){e.removeItem(n);return}throw new Vr(o.errorCodes?.join(" ")||R.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,n){if(r.checkResponseStatus(n)||r.checkResponseForRetryAfter(n)){let o={throttleTime:r.calculateThrottleTime(parseInt(n.headers[wr.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(wr.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||Ei.DEFAULT_THROTTLE_TIME_SECONDS),n+Ei.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,n,o){let i={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:o,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},a=this.generateThrottlingStorageKey(i);e.removeItem(a)}};var sg=class{constructor(e,t){this.networkClient=e,this.cacheManager=t}sendPostRequest(e,t,n){return C(this,null,function*(){Ho.preProcess(this.cacheManager,e);let o;try{o=yield this.networkClient.sendPostRequestAsync(t,n)}catch(i){throw i instanceof Pe?i:x(ec)}return Ho.postProcess(this.cacheManager,e,o),o})}};var $t={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var tu={};ho(tu,{ACCESS_TOKEN:()=>iM,CCS_HEADER:()=>fM,CLAIMS:()=>jT,CLIENT_ASSERTION:()=>_y,CLIENT_ASSERTION_TYPE:()=>vy,CLIENT_ID:()=>ba,CLIENT_INFO:()=>uM,CLIENT_REQUEST_ID:()=>ny,CLIENT_SECRET:()=>gy,CODE:()=>ZT,CODE_CHALLENGE:()=>ey,CODE_CHALLENGE_METHOD:()=>ty,CODE_VERIFIER:()=>ry,DEVICE_CODE:()=>my,DOMAIN_HINT:()=>Iy,ERROR:()=>nM,ERROR_DESCRIPTION:()=>oM,EXPIRES_IN:()=>sM,FOCI:()=>hM,GRANT_TYPE:()=>VT,ID_TOKEN:()=>aM,ID_TOKEN_HINT:()=>py,LOGIN_HINT:()=>Ay,LOGOUT_HINT:()=>Cy,NATIVE_BROKER:()=>yy,NONCE:()=>XT,OBO_ASSERTION:()=>Ey,ON_BEHALF_OF:()=>dM,POST_LOGOUT_URI:()=>fy,PROMPT:()=>JT,REDIRECT_URI:()=>qT,REFRESH_TOKEN:()=>$T,REFRESH_TOKEN_EXPIRES_IN:()=>cM,REQUESTED_TOKEN_USE:()=>Ty,REQ_CNF:()=>ug,RESPONSE_MODE:()=>zT,RESPONSE_TYPE:()=>cg,RETURN_SPA_CODE:()=>dg,SCOPE:()=>WT,SESSION_STATE:()=>lM,SID:()=>Sy,STATE:()=>QT,TOKEN_TYPE:()=>lg,X_APP_NAME:()=>dy,X_APP_VER:()=>hy,X_CLIENT_CPU:()=>sy,X_CLIENT_CURR_TELEM:()=>cy,X_CLIENT_EXTRA_SKU:()=>pM,X_CLIENT_LAST_TELEM:()=>ly,X_CLIENT_OS:()=>ay,X_CLIENT_SKU:()=>oy,X_CLIENT_VER:()=>iy,X_MS_LIB_CAPABILITY:()=>uy});var ba="client_id",qT="redirect_uri",cg="response_type",zT="response_mode",VT="grant_type",jT="claims",WT="scope",nM="error",oM="error_description",iM="access_token",aM="id_token",$T="refresh_token",sM="expires_in",cM="refresh_token_expires_in",QT="state",XT="nonce",JT="prompt",lM="session_state",uM="client_info",ZT="code",ey="code_challenge",ty="code_challenge_method",ry="code_verifier",ny="client-request-id",oy="x-client-SKU",iy="x-client-VER",ay="x-client-OS",sy="x-client-CPU",cy="x-client-current-telemetry",ly="x-client-last-telemetry",uy="x-ms-lib-capability",dy="x-app-name",hy="x-app-ver",fy="post_logout_redirect_uri",py="id_token_hint",my="device_code",gy="client_secret",_y="client_assertion",vy="client_assertion_type",lg="token_type",ug="req_cnf",Ey="assertion",Ty="requested_token_use",dM="on_behalf_of",hM="foci",fM="X-AnchorMailbox",dg="return_spa_code",yy="nativebroker",Cy="logout_hint",Sy="sid",Ay="login_hint",Iy="domain_hint",pM="x-client-xtra-sku";var Bo=class{static validateRedirectUri(e){if(!e)throw Me(_c)}static validatePrompt(e){let t=[];for(let n in ft)t.push(ft[n]);if(t.indexOf(e)<0)throw Me(yc)}static validateClaims(e){try{JSON.parse(e)}catch{throw Me(Ai)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Me(Ii);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Wm.PLAIN,Wm.S256].indexOf(e)<0)throw Me(Ac)}};var Ko=class{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(cg,encodeURIComponent(R.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(cg,encodeURIComponent(`${R.TOKEN_RESPONSE_TYPE} ${R.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(zT,encodeURIComponent(e||kT.QUERY))}addNativeBroker(){this.parameters.set(yy,encodeURIComponent("1"))}addScopes(e,t=!0,n=wn){t&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let o=t?[...e||[],...n]:e||[],i=new pt(o);this.parameters.set(WT,encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(ba,encodeURIComponent(e))}addRedirectUri(e){Bo.validateRedirectUri(e),this.parameters.set(qT,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Bo.validateRedirectUri(e),this.parameters.set(fy,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(py,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(Iy,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(Ay,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(wr.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(wr.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(Sy,encodeURIComponent(e))}addClaims(e,t){let n=this.addClientCapabilitiesToClaims(e,t);Bo.validateClaims(n),this.parameters.set(jT,encodeURIComponent(n))}addCorrelationId(e){this.parameters.set(ny,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(oy,e.sku),this.parameters.set(iy,e.version),e.os&&this.parameters.set(ay,e.os),e.cpu&&this.parameters.set(sy,e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set(dy,e.appName),e?.appVersion&&this.parameters.set(hy,e.appVersion)}addPrompt(e){Bo.validatePrompt(e),this.parameters.set(`${JT}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(QT,encodeURIComponent(e))}addNonce(e){this.parameters.set(XT,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Bo.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(ey,encodeURIComponent(e)),this.parameters.set(ty,encodeURIComponent(t));else throw Me(Ii)}addAuthorizationCode(e){this.parameters.set(ZT,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(my,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set($T,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(ry,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(gy,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(_y,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(vy,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(Ey,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(Ty,encodeURIComponent(e))}addGrantType(e){this.parameters.set(VT,encodeURIComponent(e))}addClientInfo(){this.parameters.set(fR,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,n])=>{!this.parameters.has(t)&&n&&this.parameters.set(t,n)})}addClientCapabilitiesToClaims(e,t){let n;if(!e)n={};else try{n=JSON.parse(e)}catch{throw Me(Ai)}return t&&t.length>0&&(n.hasOwnProperty(Vl.ACCESS_TOKEN)||(n[Vl.ACCESS_TOKEN]={}),n[Vl.ACCESS_TOKEN][Vl.XMS_CC]={values:t}),JSON.stringify(n)}addUsername(e){this.parameters.set(Qm.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(Qm.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(lg,xe.POP),this.parameters.set(ug,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(lg,xe.SSH),this.parameters.set(ug,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(cy,e.generateCurrentRequestHeaderValue()),this.parameters.set(ly,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(uy,Ei.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(Cy,encodeURIComponent(e))}createQueryString(){let e=new Array;return this.parameters.forEach((t,n)=>{e.push(`${n}=${t}`)}),e.join("&")}};var fg={};ho(fg,{createDiscoveredInstance:()=>wy});function AR(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}function IR(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}function NR(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}var g={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},zH=new Map([[g.AcquireTokenByCode,"ATByCode"],[g.AcquireTokenByRefreshToken,"ATByRT"],[g.AcquireTokenSilent,"ATS"],[g.AcquireTokenSilentAsync,"ATSAsync"],[g.AcquireTokenPopup,"ATPopup"],[g.AcquireTokenRedirect,"ATRedirect"],[g.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[g.CryptoOptsSignJwt,"CryptoSignJwt"],[g.SilentCacheClientAcquireToken,"SltCacheClientAT"],[g.SilentIframeClientAcquireToken,"SltIframeClientAT"],[g.SilentRefreshClientAcquireToken,"SltRClientAT"],[g.SsoSilent,"SsoSlt"],[g.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[g.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[g.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[g.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[g.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[g.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[g.BrokerHandhshake,"BrokerHandshake"],[g.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[g.AcquireTokenByBroker,"ATByBroker"],[g.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[g.RefreshTokenClientAcquireToken,"RTClientAT"],[g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[g.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[g.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[g.AcquireTokenFromCache,"ATFromCache"],[g.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[g.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[g.AcquireTokenBySilentIframe,"ATBySltIframe"],[g.InitializeBaseRequest,"InitBaseReq"],[g.InitializeSilentRequest,"InitSltReq"],[g.InitializeClientApplication,"InitClientApplication"],[g.SilentIframeClientTokenHelper,"SIClientTHelper"],[g.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[g.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[g.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[g.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[g.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[g.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[g.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[g.StandardInteractionClientInitializeAuthorizationCodeRequest,"StdIntClientInitAuthCodeReq"],[g.GetAuthCodeUrl,"GetAuthCodeUrl"],[g.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[g.HandleCodeResponse,"HandleCodeResp"],[g.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[g.AuthClientAcquireToken,"AuthClientAT"],[g.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[g.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[g.AuthClientCreateQueryString,"AuthClientCreateQueryStr"],[g.PopTokenGenerateCnf,"PopTGenCnf"],[g.PopTokenGenerateKid,"PopTGenKid"],[g.HandleServerTokenResponse,"HandleServerTRes"],[g.DeserializeResponse,"DeserializeRes"],[g.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[g.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[g.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[g.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[g.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[g.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[g.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[g.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[g.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[g.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[g.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[g.AcquireTokenByCodeAsync,"ATByCodeAsync"],[g.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[g.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[g.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[g.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[g.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[g.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[g.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[g.NativeGenerateAuthResult,"NtvGenAuthRes"],[g.RemoveHiddenIframe,"RemoveHiddenIframe"],[g.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[g.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[g.GeneratePkceCodes,"GenPkceCodes"],[g.GenerateCodeVerifier,"GenCodeVerifier"],[g.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[g.Sha256Digest,"Sha256Digest"],[g.GetRandomValues,"GetRandomValues"]]),Ny={NotStarted:0,InProgress:1,Completed:2};var jr=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,o);if(o){let s=e+"CallCount";n?.incrementFields({[s]:1},o)}try{let s=r(...i);return a?.end({success:!0}),t.trace(`Returning result from ${e}`),s}catch(s){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s}},Y=(r,e,t,n,o)=>(...i)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,o);if(o){let s=e+"CallCount";n?.incrementFields({[s]:1},o)}return n?.setPreQueueTime(e,o),r(...i).then(s=>(t.trace(`Returning result from ${e}`),a?.end({success:!0}),s)).catch(s=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s})};var RR=(()=>{class r{constructor(t,n,o,i){this.networkInterface=t,this.logger=n,this.performanceClient=o,this.correlationId=i}detectRegion(t,n){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.RegionDiscoveryDetectRegion,this.correlationId);let o=t;if(o)n.region_source=Qs.ENVIRONMENT_VARIABLE;else{let i=r.IMDS_OPTIONS;try{let a=yield Y(this.getRegionFromIMDS.bind(this),g.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(R.IMDS_VERSION,i);if(a.status===Ah.httpSuccess&&(o=a.body,n.region_source=Qs.IMDS),a.status===Ah.httpBadRequest){let s=yield Y(this.getCurrentVersion.bind(this),g.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!s)return n.region_source=Qs.FAILED_AUTO_DETECTION,null;let c=yield Y(this.getRegionFromIMDS.bind(this),g.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(s,i);c.status===Ah.httpSuccess&&(o=c.body,n.region_source=Qs.IMDS)}}catch{return n.region_source=Qs.FAILED_AUTO_DETECTION,null}}return o||(n.region_source=Qs.FAILED_AUTO_DETECTION),o||null})}getRegionFromIMDS(t,n){return C(this,null,function*(){return this.performanceClient?.addQueueMeasurement(g.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${R.IMDS_ENDPOINT}?api-version=${t}&format=text`,n,R.IMDS_TIMEOUT)})}getCurrentVersion(t){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let n=yield this.networkInterface.sendGetRequestAsync(`${R.IMDS_ENDPOINT}?format=json`,t);return n.status===Ah.httpBadRequest&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch{return null}})}}return r.IMDS_OPTIONS={headers:{Metadata:"true"}},r})();var Vn=class r{constructor(e,t,n,o,i,a,s,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=s,this.correlationId=a,this.managedIdentity=c||!1,this.regionDiscovery=new RR(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(R.CIAM_AUTH_URL))return zr.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case R.ADFS:return zr.Adfs;case R.DSTS:return zr.Dsts}return zr.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Ie(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw x(qr)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw x(qr)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw x(qr)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw x(pc);return this.replacePath(this.metadata.end_session_endpoint)}else throw x(qr)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw x(qr)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw x(qr)}canReplaceTenant(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===zr.Default&&this.protocolMode===yr.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,o=new Ie(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((s,c)=>{let l=i[c];if(c===0&&this.canReplaceTenant(o)){let u=new Ie(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];l!==u&&(this.logger.verbose(`Replacing tenant domain name ${l} with id ${u}`),l=u)}s!==l&&(t=t.replace(`/${l}/`,`/${s}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===zr.Adfs||this.protocolMode!==yr.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}resolveEndpointsAsync(){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=yield Y(this.updateCloudDiscoveryMetadata.bind(this),g.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=yield Y(this.updateEndpointMetadata.bind(this),g.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)})}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:rg(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==Gr.CACHE&&n?.source!==Gr.CACHE&&(e.expiresAt=rg(),e.canonical_authority=this.canonicalAuthority);let o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}updateEndpointMetadata(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===Gr.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){let o=yield Y(this.updateMetadataWithRegionalInformation.bind(this),g.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);Xl(e,o,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=yield Y(this.getEndpointMetadataFromNetwork.bind(this),g.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=yield Y(this.updateMetadataWithRegionalInformation.bind(this),g.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),Xl(e,n,!0),Gr.NETWORK;throw x(tc,this.defaultOpenIdConfigurationEndpoint)})}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Xl(e,t,!1),{source:Gr.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let o=this.getEndpointMetadataFromHardcodedValues();if(o)return Xl(e,o,!1),{source:Gr.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=ng(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Gr.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Ie(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Me(Ic)}return null}getEndpointMetadataFromNetwork(){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let n=yield this.networkInterface.sendGetRequestAsync(t,e);return AR(n.body)?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${n}`),null}})}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in HT?HT[this.hostnameAndPort]:null}updateMetadataWithRegionalInformation(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==R.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Xm.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,r.replaceWithRegionalInformation(e,t);let n=yield Y(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),g.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=Xm.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,r.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=Xm.AUTO_DETECTION_REQUESTED_FAILED}return e})}updateCloudDiscoveryMetadata(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let n=yield Y(this.getCloudDiscoveryMetadataFromNetwork.bind(this),g.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return zh(e,n,!0),Gr.NETWORK;throw Me(Nc)})}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||R.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||R.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||R.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),zh(e,t,!1),Gr.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let o=CR(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),zh(e,o,!1),Gr.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=ng(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),Gr.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===zr.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=ef(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Me(Ra)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}getCloudDiscoveryMetadataFromNetwork(){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${R.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},n=null;try{let o=yield this.networkInterface.sendGetRequestAsync(e,t),i,a;if(IR(o.body))i=o.body,a=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else if(NR(o.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),i=o.body,i.error===R.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=ef(a,this.hostnameAndPort)}catch(o){if(o instanceof Pe)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${o.errorCode}
Error Description: ${o.errorMessage}`);else{let i=o;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${i.name}
Error Description: ${i.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n})}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&Ie.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==Ia.None){let o=t.tenant?t.tenant:R.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${o}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return R.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw x(qr)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return KT.has(e)}static isPublicCloudAuthority(e){return R.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){let o=new Ie(e);o.validateAsUri();let i=o.getUrlComponents(),a=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=`${t}.${R.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let s=Ie.constructAuthorityUriFromObject(ie(U({},o.getUrlComponents()),{HostNameAndPort:a})).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(e,t){let n=U({},e);return n.authorization_endpoint=r.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=r.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=r.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e,o=new Ie(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(R.CIAM_AUTH_URL)){let i=o.HostNameAndPort.split(".")[0];t=`${t}${i}${R.AAD_TENANT_DOMAIN_SUFFIX}`}return t}};Vn.reservedTenantDomains=new Set(["{tenant}","{tenantid}",mo.COMMON,mo.CONSUMERS,mo.ORGANIZATIONS]);function wR(r){let n=new Ie(r).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case mo.COMMON:case mo.ORGANIZATIONS:case mo.CONSUMERS:return;default:return n}}function hg(r){return r.endsWith(R.FORWARD_SLASH)?r:`${r}${R.FORWARD_SLASH}`}function Ry(r){let e=r.cloudDiscoveryMetadata,t;if(e)try{t=JSON.parse(e)}catch{throw Me(Ra)}return{canonicalAuthority:r.authority?hg(r.authority):void 0,knownAuthorities:r.knownAuthorities,cloudDiscoveryMetadata:t}}function wy(r,e,t,n,o,i,a){return C(this,null,function*(){a?.addQueueMeasurement(g.AuthorityFactoryCreateDiscoveredInstance,i);let s=Vn.transformCIAMAuthority(hg(r)),c=new Vn(s,e,t,n,o,i,a);try{return yield Y(c.resolveEndpointsAsync.bind(c),g.AuthorityResolveEndpointsAsync,o,a,i)(),c}catch{throw x(qr)}})}var Da=class{constructor(e,t){this.config=SR(e),this.logger=new zn(this.config.loggerOptions,eg,$l),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new sg(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[wr.CONTENT_TYPE]=R.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case $t.HOME_ACCOUNT_ID:try{let n=Ri(e.credential);t[wr.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case $t.UPN:t[wr.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}executePostToTokenEndpoint(e,t,n,o,i,a){return C(this,null,function*(){a&&this.performanceClient?.addQueueMeasurement(a,i);let s=yield this.networkManager.sendPostRequest(o,e,{body:t,headers:n});return this.performanceClient?.addFields({refreshTokenSize:s.body.refresh_token?.length||0,httpVerToken:s.headers?.[wr.X_MS_HTTP_VERSION]||""},i),this.config.serverTelemetryManager&&s.status<500&&s.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),s})}updateAuthority(e,t){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.UpdateTokenEndpointAuthority,t);let n=`https://${e}/${this.authority.tenant}/`,o=yield wy(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o})}createTokenQueryParameters(e){let t=new Ko;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}};var Di={};ho(Di,{badToken:()=>Oa,consentRequired:()=>Dy,interactionRequired:()=>by,loginRequired:()=>Py,nativeAccountUnavailable:()=>of,noTokensFound:()=>Pa,refreshTokenExpired:()=>af});var Pa="no_tokens_found",of="native_account_unavailable",af="refresh_token_expired",by="interaction_required",Dy="consent_required",Py="login_required",Oa="bad_token";var bR=[by,Dy,Py,Oa],mM=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],pg={[Pa]:"No refresh token found in the cache. Please sign-in.",[of]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[af]:"Refresh token has expired.",[Oa]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."},DR={noTokensFoundError:{code:Pa,desc:pg[Pa]},native_account_unavailable:{code:of,desc:pg[of]},bad_token:{code:Oa,desc:pg[Oa]}},Cr=class r extends Pe{constructor(e,t,n,o,i,a,s,c){super(e,t,n),Object.setPrototypeOf(this,r.prototype),this.timestamp=o||R.EMPTY_STRING,this.traceId=i||R.EMPTY_STRING,this.correlationId=a||R.EMPTY_STRING,this.claims=s||R.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}};function Oy(r,e,t){let n=!!r&&bR.indexOf(r)>-1,o=!!t&&mM.indexOf(t)>-1,i=!!e&&bR.some(a=>e.indexOf(a)>-1);return n||i||o}function ru(r){return new Cr(r,pg[r])}var Qt=class r{static setRequestState(e,t,n){let o=r.generateLibraryState(e,n);return t?`${o}${R.RESOURCE_DELIM}${t}`:o}static generateLibraryState(e,t){if(!e)throw x(Sa);let n={id:e.createNewGuid()};t&&(n.meta=t);let o=JSON.stringify(n);return e.base64Encode(o)}static parseRequestState(e,t){if(!e)throw x(Sa);if(!t)throw x(vo);try{let n=t.split(R.RESOURCE_DELIM),o=n[0],i=n.length>1?n.slice(1).join(R.RESOURCE_DELIM):R.EMPTY_STRING,a=e.base64Decode(o),s=JSON.parse(a);return{userRequestState:i||R.EMPTY_STRING,libraryState:s}}catch{throw x(vo)}}};var gM={SW:"sw",UHW:"uhw"},Dn=class{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}generateCnf(e,t){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.PopTokenGenerateCnf,e.correlationId);let n=yield Y(this.generateKid.bind(this),g.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:o}})}generateKid(e){return C(this,null,function*(){return this.performanceClient?.addQueueMeasurement(g.PopTokenGenerateKid,e.correlationId),{kid:yield this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:gM.SW}})}signPopToken(e,t,n){return C(this,null,function*(){return this.signPayload(e,t,n)})}signPayload(e,t,n,o){return C(this,null,function*(){let{resourceRequestMethod:i,resourceRequestUri:a,shrClaims:s,shrNonce:c,shrOptions:l}=n,d=(a?new Ie(a):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt(U({at:e,ts:bn(),m:i?.toUpperCase(),u:d?.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:d?.AbsolutePath,q:d?.QueryString?[[],d.QueryString]:void 0,client_claims:s||void 0},o),t,l,n.correlationId)})}};var mg=class{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};function _M(r){let e="code=",t=r.error_uri?.lastIndexOf(e);return t&&t>=0?r.error_uri?.substring(t+e.length):void 0}var Go=class r{constructor(e,t,n,o,i,a,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=o,this.serializableCache=i,this.persistencePlugin=a,this.performanceClient=s}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?x(ya,"Cached State"):x(ya,"Server State");let n,o;try{n=decodeURIComponent(e.state)}catch{throw x(vo,e.state)}try{o=decodeURIComponent(t)}catch{throw x(vo,e.state)}if(n!==o)throw x(nc);if(e.error||e.error_description||e.suberror){let i=_M(e);throw Oy(e.error,e.error_description,e.suberror)?new Cr(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",i):new Vr(e.error||"",e.error_description,e.suberror,i)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){let n=`Error(s): ${e.error_codes||R.NOT_AVAILABLE} - Timestamp: ${e.timestamp||R.NOT_AVAILABLE} - Description: ${e.error_description||R.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||R.NOT_AVAILABLE} - Trace ID: ${e.trace_id||R.NOT_AVAILABLE}`,o=e.error_codes?.length?e.error_codes[0]:void 0,i=new Vr(e.error,n,e.suberror,o,e.status);if(t&&e.status&&e.status>=zl.SERVER_ERROR_RANGE_START&&e.status<=zl.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${i}`);return}else if(t&&e.status&&e.status>=zl.CLIENT_ERROR_RANGE_START&&e.status<=zl.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${i}`);return}throw Oy(e.error,e.error_description,e.suberror)?new Cr(e.error,e.error_description,e.suberror,e.timestamp||R.EMPTY_STRING,e.trace_id||R.EMPTY_STRING,e.correlation_id||R.EMPTY_STRING,e.claims||R.EMPTY_STRING,o):i}}handleServerTokenResponse(e,t,n,o,i,a,s,c,l){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.HandleServerTokenResponse,e.correlation_id);let u;if(e.id_token){if(u=Si(e.id_token||R.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&u.nonce!==i.nonce)throw x(oc);if(o.maxAge||o.maxAge===0){let p=u.auth_time;if(!p)throw x(Ti);Kh(p,o.maxAge)}}this.homeAccountIdentifier=st.generateHomeAccountId(e.client_info||R.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u);let d;i&&i.state&&(d=Qt.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;let h=this.generateCacheRecord(e,t,n,o,u,a,i),f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new mg(this.serializableCache,!0),yield this.persistencePlugin.beforeCacheAccess(f)),s&&!c&&h.account){let p=h.account.generateAccountKey();if(!this.cacheStorage.getAccount(p,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),yield r.generateAuthenticationResult(this.cryptoObj,t,h,!1,o,u,d,void 0,l)}yield this.cacheStorage.saveCacheRecord(h,o.storeInCache,o.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),yield this.persistencePlugin.afterCacheAccess(f))}return r.generateAuthenticationResult(this.cryptoObj,t,h,!1,o,u,d,e,l)})}generateCacheRecord(e,t,n,o,i,a,s){let c=t.getPreferredCache();if(!c)throw x(Ci);let l=og(i),u,d;e.id_token&&i&&(u=LT(this.homeAccountIdentifier,c,e.id_token,this.clientId,l||""),d=nu(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i,e.client_info,c,l,s,void 0,this.logger));let h=null;if(e.access_token){let m=e.scope?pt.fromString(e.scope):new pt(o.scopes||[]),_=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,T=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,E=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,y=n+_,A=y+T,w=E&&E>0?n+E:void 0;h=UT(this.homeAccountIdentifier,c,e.access_token,this.clientId,l||t.tenant||"",m.printScopes(),y,A,this.cryptoObj.base64Decode,w,e.token_type,a,e.key_id,o.claims,o.requestedClaimsHash)}let f=null;if(e.refresh_token){let m;if(e.refresh_token_expires_in){let _=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;m=n+_}f=FT(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,a,m)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:c,familyId:e.foci}),{account:d,idToken:u,accessToken:h,refreshToken:f,appMetadata:p}}static generateAuthenticationResult(e,t,n,o,i,a,s,c,l){return C(this,null,function*(){let u=R.EMPTY_STRING,d=[],h=null,f,p,m=R.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===xe.POP&&!i.popKid){let y=new Dn(e),{secret:A,keyId:w}=n.accessToken;if(!w)throw x(mc);u=yield y.signPopToken(A,w,i)}else u=n.accessToken.secret;d=pt.fromString(n.accessToken.target).asArray(),h=new Date(Number(n.accessToken.expiresOn)*1e3),f=new Date(Number(n.accessToken.extendedExpiresOn)*1e3),n.accessToken.refreshOn&&(p=new Date(Number(n.accessToken.refreshOn)*1e3))}n.appMetadata&&(m=n.appMetadata.familyId===va?va:"");let _=a?.oid||a?.sub||"",T=a?.tid||"";c?.spa_accountid&&n.account&&(n.account.nativeAccountId=c?.spa_accountid);let E=n.account?Rc(n.account.getAccountInfo(),void 0,a,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:_,tenantId:T,scopes:d,account:E,idToken:n?.idToken?.secret||"",idTokenClaims:a||{},accessToken:u,fromCache:o,expiresOn:h,extExpiresOn:f,refreshOn:p,correlationId:i.correlationId,requestId:l||R.EMPTY_STRING,familyId:m,tokenType:n.accessToken?.tokenType||R.EMPTY_STRING,state:s?s.userRequestState:R.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||R.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||R.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}})}};function nu(r,e,t,n,o,i,a,s,c,l,u){u?.verbose("setCachedAccount called");let h=r.getAccountKeys().find(T=>T.startsWith(t)),f=null;h&&(f=r.getAccount(h,u));let p=f||st.createAccount({homeAccountId:t,idTokenClaims:o,clientInfo:i,environment:a,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},e,n),m=p.tenantProfiles||[],_=s||p.realm;if(_&&!m.find(T=>T.tenantId===_)){let T=eu(t,p.localAccountId,_,o);m.push(T)}return p.tenantProfiles=m,p}function gg(r,e,t){return C(this,null,function*(){return typeof r=="string"?r:r({clientId:e,tokenEndpoint:t})})}var wc=class extends Da{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}getAuthCodeUrl(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.GetAuthCodeUrl,e.correlationId);let t=yield Y(this.createAuthCodeUrlQueryString.bind(this),g.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return Ie.appendQueryString(this.authority.authorizationEndpoint,t)})}acquireToken(e,t){return C(this,null,function*(){if(this.performanceClient?.addQueueMeasurement(g.AuthClientAcquireToken,e.correlationId),!e.code)throw x(sc);let n=bn(),o=yield Y(this.executeTokenRequest.bind(this),g.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=o.headers?.[wr.X_MS_REQUEST_ID],a=new Go(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(o.body),Y(a.handleServerTokenResponse.bind(a),g.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,n,e,t,void 0,void 0,void 0,i)})}handleFragmentResponse(e,t){if(new Go(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw x(hc);return e}getLogoutUri(e){if(!e)throw Me(Sc);let t=this.createLogoutUrlQueryString(e);return Ie.appendQueryString(this.authority.endSessionEndpoint,t)}executeTokenRequest(e,t){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),o=Ie.appendQueryString(e.tokenEndpoint,n),i=yield Y(this.createTokenRequestBody.bind(this),g.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),a;if(t.clientInfo)try{let l=Jl(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${l.uid}${Rt.CLIENT_INFO_SEPARATOR}${l.utid}`,type:$t.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}let s=this.createTokenRequestHeaders(a||t.ccsCredential),c={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return Y(this.executePostToTokenEndpoint.bind(this),g.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,i,s,c,t.correlationId,g.AuthorizationCodeClientExecutePostToTokenEndpoint)})}createTokenRequestBody(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthClientCreateTokenRequestBody,e.correlationId);let t=new Ko;if(t.addClientId(e.tokenBodyParameters?.[ba]||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Bo.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!nf(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let i=this.config.clientCredentials.clientAssertion;t.addClientAssertion(yield gg(i.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(i.assertionType)}if(t.addGrantType(Ch.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===xe.POP){let i=new Dn(this.cryptoUtils,this.performanceClient),a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(yield Y(i.generateCnf.bind(i),g.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(a)}else if(e.authenticationScheme===xe.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw Me(Ni);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();t.addCorrelationId(n),(!Et.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let o;if(e.clientInfo)try{let i=Jl(e.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${i.uid}${Rt.CLIENT_INFO_SEPARATOR}${i.utid}`,type:$t.HOME_ACCOUNT_ID}}catch(i){this.logger.verbose("Could not parse client info for CCS Header: "+i)}else o=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case $t.HOME_ACCOUNT_ID:try{let i=Ri(o.credential);t.addCcsOid(i)}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case $t.UPN:t.addCcsUpn(o.credential);break}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[dg])&&t.addExtraQueryParameters({[dg]:"1"}),t.createQueryString()})}createAuthCodeUrlQueryString(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.AuthClientCreateQueryString,e.correlationId);let t=new Ko;t.addClientId(e.extraQueryParameters?.[ba]||this.config.authOptions.clientId);let n=[...e.scopes||[],...e.extraScopesToConsent||[]];t.addScopes(n,!0,this.oidcDefaultScopes),t.addRedirectUri(e.redirectUri);let o=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(o),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),nf(this.config)||t.addApplicationTelemetry(this.config.telemetry.application),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==ft.SELECT_ACCOUNT)if(e.sid&&e.prompt===ft.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){let i=this.extractAccountSid(e.account),a=this.extractLoginHint(e.account);if(a&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),a=null),a){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),t.addLoginHint(a);try{let s=Ri(e.account.homeAccountId);t.addCcsOid(s)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(i&&e.prompt===ft.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(i);try{let s=Ri(e.account.homeAccountId);t.addCcsOid(s)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{let s=Ri(e.account.homeAccountId);t.addCcsOid(s)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.addExtraQueryParams(e,t),e.nativeBroker&&(t.addNativeBroker(),e.authenticationScheme===xe.POP)){let i=new Dn(this.cryptoUtils),a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(yield Y(i.generateCnf.bind(i),g.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(a)}return t.createQueryString()})}createLogoutUrlQueryString(e){let t=new Ko;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}};var vM=300,ka=class extends Da{constructor(e,t){super(e,t)}acquireToken(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientAcquireToken,e.correlationId);let t=bn(),n=yield Y(this.executeTokenRequest.bind(this),g.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=n.headers?.[wr.X_MS_REQUEST_ID],i=new Go(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),Y(i.handleServerTokenResponse.bind(i),g.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,o)})}acquireTokenByRefreshToken(e){return C(this,null,function*(){if(!e)throw Me(Cc);if(this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw x(yi);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return yield Y(this.acquireTokenWithCachedRefreshToken.bind(this),g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){let o=n instanceof Cr&&n.errorCode===Pa,i=n instanceof Vr&&n.errorCode===$m.INVALID_GRANT_ERROR&&n.subError===$m.CLIENT_MISMATCH_ERROR;if(o||i)return Y(this.acquireTokenWithCachedRefreshToken.bind(this),g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return Y(this.acquireTokenWithCachedRefreshToken.bind(this),g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)})}acquireTokenWithCachedRefreshToken(e,t){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=jr(this.cacheManager.getRefreshToken.bind(this.cacheManager),g.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!n)throw ru(Pa);if(n.expiresOn&&Ql(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||vM))throw ru(af);let o=ie(U({},e),{refreshToken:n.secret,authenticationScheme:e.authenticationScheme||xe.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:$t.HOME_ACCOUNT_ID}});try{return yield Y(this.acquireToken.bind(this),g.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(i){if(i instanceof Cr&&i.subError===Oa){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let a=qh(n);this.cacheManager.removeRefreshToken(a)}throw i}})}executeTokenRequest(e,t){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),o=Ie.appendQueryString(t.tokenEndpoint,n),i=yield Y(this.createTokenRequestBody.bind(this),g.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),s={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return Y(this.executePostToTokenEndpoint.bind(this),g.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,a,s,e.correlationId,g.RefreshTokenClientExecutePostToTokenEndpoint)})}createTokenRequestBody(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=e.correlationId,n=new Ko;if(n.addClientId(e.tokenBodyParameters?.[ba]||this.config.authOptions.clientId),e.redirectUri&&n.addRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),n.addGrantType(Ch.REFRESH_TOKEN_GRANT),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!nf(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),n.addCorrelationId(t),n.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let o=this.config.clientCredentials.clientAssertion;n.addClientAssertion(yield gg(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(o.assertionType)}if(e.authenticationScheme===xe.POP){let o=new Dn(this.cryptoUtils,this.performanceClient),i;e.popKid?i=this.cryptoUtils.encodeKid(e.popKid):i=(yield Y(o.generateCnf.bind(o),g.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(i)}else if(e.authenticationScheme===xe.SSH)if(e.sshJwk)n.addSshJwk(e.sshJwk);else throw Me(Ni);if((!Et.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case $t.HOME_ACCOUNT_ID:try{let o=Ri(e.ccsCredential.credential);n.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case $t.UPN:n.addCcsUpn(e.ccsCredential.credential);break}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),n.createQueryString()})}};var sf=class extends Da{constructor(e,t){super(e,t)}acquireToken(e){return C(this,null,function*(){try{let[t,n]=yield this.acquireCachedToken(ie(U({},e),{scopes:e.scopes?.length?e.scopes:[...wn]}));return n===_o.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new ka(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),t}catch(t){if(t instanceof gc&&t.errorCode===Fo)return new ka(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw t}})}acquireCachedToken(e){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.SilentFlowClientAcquireCachedToken,e.correlationId);let t=_o.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Et.isEmptyObj(e.claims))throw this.setCacheOutcome(_o.FORCE_REFRESH_OR_CLAIMS,e.correlationId),x(Fo);if(!e.account)throw x(yi);let n=e.account.tenantId||wR(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,n,this.performanceClient,e.correlationId);if(i){if(MT(i.cachedAt)||Ql(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(_o.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),x(Fo);i.refreshOn&&Ql(i.refreshOn,0)&&(t=_o.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(_o.NO_CACHED_ACCESS_TOKEN,e.correlationId),x(Fo);let a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,o,n,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[yield Y(this.generateResultFromCacheRecord.bind(this),g.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(s,e),t]})}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==_o.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}generateResultFromCacheRecord(e,t){return C(this,null,function*(){this.performanceClient?.addQueueMeasurement(g.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let n;if(e.idToken&&(n=Si(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){let o=n?.auth_time;if(!o)throw x(Ti);Kh(o,t.maxAge)}return Go.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)})}};var ky={sendGetRequestAsync:()=>Promise.reject(x(ye)),sendPostRequestAsync:()=>Promise.reject(x(ye))};var PR=",",OR="|";function EM(r){let{skus:e,libraryName:t,libraryVersion:n,extensionName:o,extensionVersion:i}=r,a=new Map([[0,[t,n]],[2,[o,i]]]),s=[];if(e?.length){if(s=e.split(PR),s.length<4)return e}else s=Array.from({length:4},()=>OR);return a.forEach((c,l)=>{c.length===2&&c[0]?.length&&c[1]?.length&&TM({skuArr:s,index:l,skuName:c[0],skuVersion:c[1]})}),s.join(PR)}function TM(r){let{skuArr:e,index:t,skuName:n,skuVersion:o}=r;t>=e.length||(e[t]=[n,o].join(OR))}var bc=class r{constructor(e,t){this.cacheOutcome=_o.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||R.EMPTY_STRING,this.wrapperVer=e.wrapperVer||R.EMPTY_STRING,this.telemetryCacheKey=jt.CACHE_KEY+Rt.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${jt.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);let o=t.join(jt.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),a=[e,i].join(jt.VALUE_SEPARATOR);return[jt.SCHEMA_VERSION,a,o].join(jt.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(jt.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(jt.VALUE_SEPARATOR),i=e.errors.length,a=t<i?jt.OVERFLOW_TRUE:jt.OVERFLOW_FALSE,s=[i,a].join(jt.VALUE_SEPARATOR);return[jt.SCHEMA_VERSION,e.cacheHits,n,o,s].join(jt.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=jt.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Pe?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(jt.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey);else{let o={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}}static maxErrorsToSend(e){let t,n=0,o=0,i=e.errors.length;for(t=0;t<i;t++){let a=e.failedRequests[2*t]||R.EMPTY_STRING,s=e.failedRequests[2*t+1]||R.EMPTY_STRING,c=e.errors[t]||R.EMPTY_STRING;if(o+=a.toString().length+s.toString().length+c.length+3,o<jt.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||R.EMPTY_STRING),e.push(this.regionSource||R.EMPTY_STRING),e.push(this.regionOutcome||R.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return EM(e)}};var _g="missing_kid_error",vg="missing_alg_error";var yM={[_g]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[vg]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},xy=class r extends Pe{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,r.prototype)}};function My(r){return new xy(r,yM[r])}var cf=class r{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw My(_g);if(!e.alg)throw My(vg);let t=new r({typ:e.typ||Jm.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}};var Eg=class{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}},ou=class{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Ny.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Eg}}startPerformanceMeasurement(){return new Eg}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}};var Dc="pkce_not_created",iu="crypto_nonexistent",qo="empty_navigate_uri",au="hash_empty_error",xa="no_state_in_hash",su="hash_does_not_contain_known_properties",cu="unable_to_parse_state",lu="state_interaction_type_mismatch",uu="interaction_in_progress",du="popup_window_error",hu="empty_window_error",on="user_cancelled",Tg="monitor_popup_timeout",fu="monitor_window_timeout",pu="redirect_in_iframe",mu="block_iframe_reload",gu="block_nested_popups",yg="iframe_closed_prematurely",zo="silent_logout_unsupported",_u="no_account_error",Cg="silent_prompt_value_error",vu="no_token_request_cache_error",Eu="unable_to_parse_token_request_cache_error",Ma="no_cached_authority_error",Sg="auth_request_not_set_error",Ag="invalid_cache_type",La="non_browser_environment",Vo="database_not_open",Pi="no_network_connectivity",Tu="post_request_failed",yu="get_request_failed",Pc="failed_to_parse_response",Cu="unable_to_load_token",Ua="crypto_key_not_found",Su="auth_code_required",Au="auth_code_or_nativeAccountId_required",Iu="spa_code_and_nativeAccountId_present",Fa="database_unavailable",Nu="unable_to_acquire_token_from_native_platform",Ru="native_handshake_timeout",wu="native_extension_not_installed",jn="native_connection_not_established",bu="uninitialized_public_client_application",Du="native_prompt_not_supported",Pu="invalid_base64_string",Ou="invalid_pop_token_request";var Oi="For more visit: aka.ms/msaljs/browser-errors",Te={[Dc]:"The PKCE code challenge and verifier could not be generated.",[iu]:"The crypto object or function is not available.",[qo]:"Navigation URI is empty. Please check stack trace for more info.",[au]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Oi}`,[xa]:"Hash does not contain state. Please verify that the request originated from msal.",[su]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Oi}`,[cu]:"Unable to parse state. Please verify that the request originated from msal.",[lu]:"Hash contains state but the interaction type does not match the caller.",[uu]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Oi}`,[du]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[hu]:"window.open returned null or undefined window object.",[on]:"User cancelled the flow.",[Tg]:`Token acquisition in popup failed due to timeout.  ${Oi}`,[fu]:`Token acquisition in iframe failed due to timeout.  ${Oi}`,[pu]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[mu]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Oi}`,[gu]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[yg]:"The iframe being monitored was closed prematurely.",[zo]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[_u]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Cg]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[vu]:"No token request found in cache.",[Eu]:"The cached token request could not be parsed.",[Ma]:"No cached authority found.",[Sg]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Ag]:"Invalid cache type",[La]:"Login and token requests are not supported in non-browser environments.",[Vo]:"Database is not open!",[Pi]:"No network connectivity. Check your internet connection.",[Tu]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[yu]:"Network request failed. Please check the network trace to determine root cause.",[Pc]:"Failed to parse network response. Check network trace.",[Cu]:"Error loading token to cache.",[Ua]:"Cryptographic Key or Keypair not found in browser storage.",[Su]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Au]:"An authorization code or nativeAccountId must be provided to this flow.",[Iu]:"Request cannot contain both spa code and native account id.",[Fa]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Nu]:`Unable to acquire token from native platform.  ${Oi}`,[Ru]:"Timed out while attempting to establish connection to browser extension",[wu]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[jn]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Oi}`,[bu]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Oi}`,[Du]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Pu]:"Invalid base64 encoded string.",[Ou]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true."},R1={pkceNotGenerated:{code:Dc,desc:Te[Dc]},cryptoDoesNotExist:{code:iu,desc:Te[iu]},emptyNavigateUriError:{code:qo,desc:Te[qo]},hashEmptyError:{code:au,desc:Te[au]},hashDoesNotContainStateError:{code:xa,desc:Te[xa]},hashDoesNotContainKnownPropertiesError:{code:su,desc:Te[su]},unableToParseStateError:{code:cu,desc:Te[cu]},stateInteractionTypeMismatchError:{code:lu,desc:Te[lu]},interactionInProgress:{code:uu,desc:Te[uu]},popupWindowError:{code:du,desc:Te[du]},emptyWindowError:{code:hu,desc:Te[hu]},userCancelledError:{code:on,desc:Te[on]},monitorPopupTimeoutError:{code:Tg,desc:Te[Tg]},monitorIframeTimeoutError:{code:fu,desc:Te[fu]},redirectInIframeError:{code:pu,desc:Te[pu]},blockTokenRequestsInHiddenIframeError:{code:mu,desc:Te[mu]},blockAcquireTokenInPopupsError:{code:gu,desc:Te[gu]},iframeClosedPrematurelyError:{code:yg,desc:Te[yg]},silentLogoutUnsupportedError:{code:zo,desc:Te[zo]},noAccountError:{code:_u,desc:Te[_u]},silentPromptValueError:{code:Cg,desc:Te[Cg]},noTokenRequestCacheError:{code:vu,desc:Te[vu]},unableToParseTokenRequestCacheError:{code:Eu,desc:Te[Eu]},noCachedAuthorityError:{code:Ma,desc:Te[Ma]},authRequestNotSet:{code:Sg,desc:Te[Sg]},invalidCacheType:{code:Ag,desc:Te[Ag]},notInBrowserEnvironment:{code:La,desc:Te[La]},databaseNotOpen:{code:Vo,desc:Te[Vo]},noNetworkConnectivity:{code:Pi,desc:Te[Pi]},postRequestFailed:{code:Tu,desc:Te[Tu]},getRequestFailed:{code:yu,desc:Te[yu]},failedToParseNetworkResponse:{code:Pc,desc:Te[Pc]},unableToLoadTokenError:{code:Cu,desc:Te[Cu]},signingKeyNotFoundInStorage:{code:Ua,desc:Te[Ua]},authCodeRequired:{code:Su,desc:Te[Su]},authCodeOrNativeAccountRequired:{code:Au,desc:Te[Au]},spaCodeAndNativeAccountPresent:{code:Iu,desc:Te[Iu]},databaseUnavailable:{code:Fa,desc:Te[Fa]},unableToAcquireTokenFromNativePlatform:{code:Nu,desc:Te[Nu]},nativeHandshakeTimeout:{code:Ru,desc:Te[Ru]},nativeExtensionNotInstalled:{code:wu,desc:Te[wu]},nativeConnectionNotEstablished:{code:jn,desc:Te[jn]},uninitializedPublicClientApplication:{code:bu,desc:Te[bu]},nativePromptNotSupported:{code:Du,desc:Te[Du]},invalidBase64StringError:{code:Pu,desc:Te[Pu]},invalidPopTokenRequest:{code:Ou,desc:Te[Ou]}},Oc=class r extends Pe{constructor(e){super(e,Te[e]),Object.setPrototypeOf(this,r.prototype),this.name="BrowserAuthError"}};function $(r){return new Oc(r)}var xt={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Ya={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},ki={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},rt={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},Ly={GET:"GET",POST:"POST"},Ge={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},xi={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},lf={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Ve={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962},ee=function(r){return r.Redirect="redirect",r.Popup="popup",r.Silent="silent",r.None="none",r}(ee||{}),Mt={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},Uy={scopes:wn},Fy="jwk",Yy={React:"@azure/msal-react",Angular:"@azure/msal-angular"},Ig="msal.db",kR=1,xR=`${Ig}.keys`,Wr={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},MR=[Wr.Default,Wr.Skip,Wr.RefreshTokenAndNetwork],LR="msal.browser.log.level",UR="msal.browser.log.pii";function uf(r){return encodeURIComponent(df(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function kc(r){return FR(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function df(r){return FR(new TextEncoder().encode(r))}function FR(r){let e=Array.from(r,t=>String.fromCodePoint(t)).join("");return btoa(e)}var CM="RSASSA-PKCS1-v1_5",BR="SHA-256",SM=2048,AM=new Uint8Array([1,0,1]),YR="0123456789abcdef",HR=new Uint32Array(1),By={name:CM,hash:BR,modulusLength:SM,publicExponent:AM};function KR(r){if("crypto"in window)r.verbose("BrowserCrypto: modern crypto interface available");else throw r.error("BrowserCrypto: crypto interface is unavailable"),$(iu)}function Ky(r,e,t){return C(this,null,function*(){e?.addQueueMeasurement(g.Sha256Digest,t);let o=new TextEncoder().encode(r);return window.crypto.subtle.digest(BR,o)})}function GR(r){return window.crypto.getRandomValues(r)}function Hy(){return window.crypto.getRandomValues(HR),HR[0]}function mr(){let r=Date.now(),e=Hy()*1024+(Hy()&1023),t=new Uint8Array(16),n=Math.trunc(e/2**30),o=e&2**30-1,i=Hy();t[0]=r/2**40,t[1]=r/2**32,t[2]=r/2**24,t[3]=r/2**16,t[4]=r/2**8,t[5]=r,t[6]=112|n>>>8,t[7]=n,t[8]=128|o>>>24,t[9]=o>>>16,t[10]=o>>>8,t[11]=o,t[12]=i>>>24,t[13]=i>>>16,t[14]=i>>>8,t[15]=i;let a="";for(let s=0;s<t.length;s++)a+=YR.charAt(t[s]>>>4),a+=YR.charAt(t[s]&15),(s===3||s===5||s===7||s===9)&&(a+="-");return a}function qR(r,e){return C(this,null,function*(){return window.crypto.subtle.generateKey(By,r,e)})}function Ng(r){return C(this,null,function*(){return window.crypto.subtle.exportKey(Fy,r)})}function zR(r,e,t){return C(this,null,function*(){return window.crypto.subtle.importKey(Fy,r,By,e,t)})}function VR(r,e){return C(this,null,function*(){return window.crypto.subtle.sign(By,r,e)})}function Rg(r){return C(this,null,function*(){let e=yield Ky(r),t=new Uint8Array(e);return kc(t)})}var ku="storage_not_supported",wg="stubbed_public_client_application_called",xu="in_mem_redirect_unavailable";var bg={[ku]:"Given storage configuration option was not supported.",[wg]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[xu]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},IM={storageNotSupportedError:{code:ku,desc:bg[ku]},stubPcaInstanceCalled:{code:wg,desc:bg[wg]},inMemRedirectUnavailable:{code:xu,desc:bg[xu]}},xc=class r extends Pe{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,r.prototype)}};function Dg(r){return new xc(r,bg[r])}function Gy(r){r.location.hash="",typeof r.history.replaceState=="function"&&r.history.replaceState(null,"",`${r.location.origin}${r.location.pathname}${r.location.search}`)}function qy(r){let e=r.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function hf(){return window.parent!==window}function jR(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${xt.POPUP_NAME_PREFIX}.`)===0}function an(){return window.location.href.split("?")[0].split("#")[0]}function zy(){let e=new Ie(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function WR(){if(Ie.hashContainsKnownProperties(window.location.hash)&&hf())throw $(mu)}function $R(r){if(hf()&&!r)throw $(pu)}function QR(){if(jR())throw $(gu)}function XR(){if(typeof window>"u")throw $(La)}function Pg(r){if(!r)throw $(bu)}function ff(r){XR(),WR(),QR(),Pg(r)}function Og(r,e){if(ff(r),$R(e.system.allowRedirectInIframe),e.cache.cacheLocation===rt.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw Dg(xu)}function pf(r){let e=document.createElement("link");e.rel="preconnect",e.href=new URL(r).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function NM(){return mr()}var mf=class r{navigateInternal(e,t){return r.defaultNavigateWindow(e,t)}navigateExternal(e,t){return r.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(n=>{setTimeout(()=>{n(!0)},t.timeout)})}};var xg=class{sendGetRequestAsync(e,t){return C(this,null,function*(){let n;try{n=yield fetch(e,{method:Ly.GET,headers:this.getFetchHeaders(t)})}catch{throw window.navigator.onLine?$(yu):$(Pi)}try{return{headers:this.getHeaderDict(n.headers),body:yield n.json(),status:n.status}}catch{throw $(Pc)}})}sendPostRequestAsync(e,t){return C(this,null,function*(){let n=t&&t.body||R.EMPTY_STRING,o;try{o=yield fetch(e,{method:Ly.POST,headers:this.getFetchHeaders(t),body:n})}catch{throw window.navigator.onLine?$(Tu):$(Pi)}try{return{headers:this.getHeaderDict(o.headers),body:yield o.json(),status:o.status}}catch{throw $(Pc)}})}getFetchHeaders(e){let t=new Headers;if(!(e&&e.headers))return t;let n=e.headers;return Object.keys(n).forEach(o=>{t.append(o,n[o])}),t}getHeaderDict(e){let t={};return e.forEach((n,o)=>{t[o]=n}),t}};var RM=6e4,Mg=1e4,wM=3e4,bM=2e3;function JR({auth:r,cache:e,system:t,telemetry:n},o){let i={clientId:R.EMPTY_STRING,authority:`${R.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:R.EMPTY_STRING,authorityMetadata:R.EMPTY_STRING,redirectUri:R.EMPTY_STRING,postLogoutRedirectUri:R.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:yr.AAD,OIDCOptions:{serverResponseType:go.FRAGMENT,defaultScopes:[R.OPENID_SCOPE,R.PROFILE_SCOPE,R.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Ia.None,tenant:R.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},a={cacheLocation:rt.SessionStorage,temporaryCacheLocation:rt.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===rt.LocalStorage),claimsBasedCachingEnabled:!1},s={loggerCallback:()=>{},logLevel:Xe.Info,piiLoggingEnabled:!1},c=ie(U({},ag),{loggerOptions:s,networkClient:o?new xg:ky,navigationClient:new mf,loadFrameTimeout:0,windowHashTimeout:t?.loadFrameTimeout||RM,iframeHashTimeout:t?.loadFrameTimeout||Mg,navigateFrameWait:0,redirectNavigationTimeout:wM,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:t?.nativeBrokerHandshakeTimeout||bM,pollIntervalMilliseconds:xt.DEFAULT_POLL_INTERVAL_MS}),l=ie(U(U({},c),t),{loggerOptions:t?.loggerOptions||s}),u={application:{appName:R.EMPTY_STRING,appVersion:R.EMPTY_STRING},client:new ou};if(r?.protocolMode!==yr.OIDC&&r?.OIDCOptions&&new zn(l.loggerOptions).warning(JSON.stringify(Me(Eo.cannotSetOIDCOptions))),r?.protocolMode&&r.protocolMode!==yr.AAD&&l?.allowNativeBroker)throw Me(Eo.cannotAllowNativeBroker);return{auth:ie(U(U({},i),r),{OIDCOptions:U(U({},i.OIDCOptions),r?.OIDCOptions)}),cache:U(U({},a),e),system:l,telemetry:U(U({},u),n)}}var ZR="@azure/msal-browser",Ha="3.24.0";var Lg=class r{static loggerCallback(e,t){switch(e){case Xe.Error:console.error(t);return;case Xe.Info:console.info(t);return;case Xe.Verbose:console.debug(t);return;case Xe.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=JR(e,this.browserEnvironment);let t;try{t=window[rt.SessionStorage]}catch{}let n=t?.getItem(LR),o=t?.getItem(UR)?.toLowerCase(),i=o==="true"?!0:o==="false"?!1:void 0,a=U({},this.config.system.loggerOptions),s=n&&Object.keys(Xe).includes(n)?Xe[n]:void 0;s&&(a.loggerCallback=r.loggerCallback,a.logLevel=s),i!==void 0&&(a.piiLoggingEnabled=i),this.logger=new zn(a,ZR,Ha),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}};var Ug=(()=>{class r extends Lg{getModuleName(){return r.MODULE_NAME}getId(){return r.ID}initialize(){return C(this,null,function*(){return this.available=typeof window<"u",this.available})}}return r.MODULE_NAME="",r.ID="StandardOperatingContext",r})();function sn(r){return new TextDecoder().decode(DM(r))}function DM(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw $(Pu)}let t=atob(e);return Uint8Array.from(t,n=>n.codePointAt(0)||0)}var Fg=class{constructor(){this.dbName=Ig,this.version=kR,this.tableName=xR,this.dbOpen=!1}open(){return C(this,null,function*(){return new Promise((e,t)=>{let n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",o=>{o.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",o=>{let i=o;this.db=i.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t($(Fa)))})})}closeConnection(){let e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}validateDbIsOpen(){return C(this,null,function*(){if(!this.dbOpen)return this.open()})}getItem(e){return C(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n($(Vo));let a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);a.addEventListener("success",s=>{let c=s;this.closeConnection(),t(c.target.result)}),a.addEventListener("error",s=>{this.closeConnection(),n(s)})})})}setItem(e,t){return C(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((n,o)=>{if(!this.db)return o($(Vo));let s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);s.addEventListener("success",()=>{this.closeConnection(),n()}),s.addEventListener("error",c=>{this.closeConnection(),o(c)})})})}removeItem(e){return C(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n($(Vo));let a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);a.addEventListener("success",()=>{this.closeConnection(),t()}),a.addEventListener("error",s=>{this.closeConnection(),n(s)})})})}getKeys(){return C(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t($(Vo));let i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();i.addEventListener("success",a=>{let s=a;this.closeConnection(),e(s.target.result)}),i.addEventListener("error",a=>{this.closeConnection(),t(a)})})})}containsKey(e){return C(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n($(Vo));let a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);a.addEventListener("success",s=>{let c=s;this.closeConnection(),t(c.target.result===1)}),a.addEventListener("error",s=>{this.closeConnection(),n(s)})})})}deleteDatabase(){return C(this,null,function*(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{let n=window.indexedDB.deleteDatabase(Ig),o=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(o),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(o),e(!0))),n.addEventListener("error",()=>(clearTimeout(o),t(!1)))})})}};var Mc=class{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){let e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}};var Yg=class{constructor(e){this.inMemoryCache=new Mc,this.indexedDBCache=new Fg,this.logger=e}handleDatabaseAccessError(e){if(e instanceof Oc&&e.errorCode===Fa)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}getItem(e){return C(this,null,function*(){let t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),yield this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t})}setItem(e,t){return C(this,null,function*(){this.inMemoryCache.setItem(e,t);try{yield this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}})}removeItem(e){return C(this,null,function*(){this.inMemoryCache.removeItem(e);try{yield this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}})}getKeys(){return C(this,null,function*(){let e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),yield this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e})}containsKey(e){return C(this,null,function*(){let t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),yield this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t})}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}clearPersistent(){return C(this,null,function*(){try{this.logger.verbose("Deleting persistent keystore");let e=yield this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}})}};var tw=(()=>{class r{constructor(t,n){this.logger=t,KR(t),this.cache=new Yg(this.logger),this.performanceClient=n}createNewGuid(){return mr()}base64Encode(t){return df(t)}base64Decode(t){return sn(t)}base64UrlEncode(t){return uf(t)}encodeKid(t){return this.base64UrlEncode(JSON.stringify({kid:t}))}getPublicKeyThumbprint(t){return C(this,null,function*(){let n=this.performanceClient?.startMeasurement(g.CryptoOptsGetPublicKeyThumbprint,t.correlationId),o=yield qR(r.EXTRACTABLE,r.POP_KEY_USAGES),i=yield Ng(o.publicKey),a={e:i.e,kty:i.kty,n:i.n},s=ew(a),c=yield this.hashString(s),l=yield Ng(o.privateKey),u=yield zR(l,!1,["sign"]);return yield this.cache.setItem(c,{privateKey:u,publicKey:o.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri}),n&&n.end({success:!0}),c})}removeTokenBindingKey(t){return C(this,null,function*(){return yield this.cache.removeItem(t),!(yield this.cache.containsKey(t))})}clearKeystore(){return C(this,null,function*(){this.cache.clearInMemory();try{return yield this.cache.clearPersistent(),!0}catch(t){return t instanceof Error?this.logger.error(`Clearing keystore failed with error: ${t.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}})}signJwt(t,n,o,i){return C(this,null,function*(){let a=this.performanceClient?.startMeasurement(g.CryptoOptsSignJwt,i),s=yield this.cache.getItem(n);if(!s)throw $(Ua);let c=yield Ng(s.publicKey),l=ew(c),u=uf(JSON.stringify({kid:n})),d=cf.getShrHeaderString(ie(U({},o?.header),{alg:c.alg,kid:u})),h=uf(d);t.cnf={jwk:JSON.parse(l)};let f=uf(JSON.stringify(t)),p=`${h}.${f}`,_=new TextEncoder().encode(p),T=yield VR(s.privateKey,_),E=kc(new Uint8Array(T)),y=`${p}.${E}`;return a&&a.end({success:!0}),y})}hashString(t){return C(this,null,function*(){return Rg(t)})}}return r.POP_KEY_USAGES=["sign","verify"],r.EXTRACTABLE=!0,r})();function ew(r){return JSON.stringify(r,Object.keys(r).sort())}var gf=class{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==rt.LocalStorage&&e!==rt.SessionStorage||!window[e])throw Dg(ku)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,t){this.windowStorage.setItem(e,t)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}};function Hg(r,e){if(!e)return null;try{return Qt.parseRequestState(r,e).libraryState.meta}catch{throw x(Wt.invalidState)}}var Mu=class r extends bi{constructor(e,t,n,o,i,a){super(e,n,o,i),this.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,this.cacheConfig=t,this.logger=o,this.internalStorage=new Mc,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=a}setupBrowserStorage(e){switch(e){case rt.LocalStorage:case rt.SessionStorage:try{return new gf(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=rt.MemoryStorage,new Mc}setupTemporaryCacheStorage(e,t){switch(t){case rt.LocalStorage:case rt.SessionStorage:try{return new gf(e||rt.SessionStorage)}catch(n){return this.logger.verbose(n),this.internalStorage}case rt.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){let e=`${R.CACHE_PREFIX}.${kt.ID_TOKEN}`,t=`${R.CACHE_PREFIX}.${kt.CLIENT_INFO}`,n=`${R.CACHE_PREFIX}.${kt.ERROR}`,o=`${R.CACHE_PREFIX}.${kt.ERROR_DESC}`,i=this.browserStorage.getItem(e),a=this.browserStorage.getItem(t),s=this.browserStorage.getItem(n),c=this.browserStorage.getItem(o),l=[i,a,s,c];[kt.ID_TOKEN,kt.CLIENT_INFO,kt.ERROR,kt.ERROR_DESC].forEach((d,h)=>{let f=l[h];f&&this.setTemporaryCache(d,f,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");let e=this.getItem(xi.ACCOUNT_KEYS),t=this.getItem(`${xi.TOKEN_KEYS}.${this.clientId}`);if(e&&t){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(o=>{if(this.isCredentialKey(o)){let i=this.getItem(o);if(i){let a=this.validateAndParseJson(i);if(a&&a.hasOwnProperty("credentialType"))switch(a.credentialType){case pe.ID_TOKEN:if(at.isIdTokenEntity(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${o} found, saving key to token key map`);let s=a,c=this.updateCredentialCacheKey(o,s);this.addTokenKey(c,pe.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${o}`);break;case pe.ACCESS_TOKEN:case pe.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(at.isAccessTokenEntity(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${o} found, saving key to token key map`);let s=a,c=this.updateCredentialCacheKey(o,s);this.addTokenKey(c,pe.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${o}`);break;case pe.REFRESH_TOKEN:if(at.isRefreshTokenEntity(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${o} found, saving key to token key map`);let s=a,c=this.updateCredentialCacheKey(o,s);this.addTokenKey(c,pe.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${o}`);break}}}if(this.isAccountKey(o)){let i=this.getItem(o);if(i){let a=this.validateAndParseJson(i);a&&st.isAccountEntity(a)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${o} found, saving key to account key map`),this.addAccountKeyToMap(o))}}})}validateAndParseJson(e){try{let t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");let n=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,n,t)}getCachedAccountEntity(e){let t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;let n=this.validateAndParseJson(t);return!n||!st.isAccountEntity(n)?(this.removeAccountKeyFromMap(e),null):bi.toObject(new st,n)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");let t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");let e=this.getItem(xi.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);let t=this.getAccountKeys();t.indexOf(e)===-1?(t.push(e),this.setItem(xi.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);let t=this.getAccountKeys(),n=t.indexOf(e);n>-1?(t.splice(n,1),this.setItem(xi.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e){return C(this,null,function*(){uh(r.prototype,this,"removeAccount").call(this,e),this.removeAccountKeyFromMap(e)})}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,pe.ID_TOKEN)}removeAccessToken(e){return C(this,null,function*(){uh(r.prototype,this,"removeAccessToken").call(this,e),this.removeTokenKey(e,pe.ACCESS_TOKEN)})}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,pe.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");let e=this.getItem(`${xi.TOKEN_KEYS}.${this.clientId}`);if(e){let t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");let n=this.getTokenKeys();switch(t){case pe.ID_TOKEN:n.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case pe.ACCESS_TOKEN:n.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(e));break;case pe.REFRESH_TOKEN:n.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),x(Wt.unexpectedCredentialType)}this.setItem(`${xi.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");let n=this.getTokenKeys();switch(t){case pe.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);let o=n.idToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case pe.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);let i=n.accessToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case pe.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);let a=n.refreshToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),x(Wt.unexpectedCredentialType)}this.setItem(`${xi.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}getIdTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,pe.ID_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!at.isIdTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,pe.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");let t=at.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,pe.ID_TOKEN)}getAccessTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,pe.ACCESS_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!at.isAccessTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,pe.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");let t=at.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,pe.ACCESS_TOKEN)}getRefreshTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,pe.REFRESH_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!at.isRefreshTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,pe.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");let t=at.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,pe.REFRESH_TOKEN)}getAppMetadata(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!at.isAppMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");let t=at.generateAppMetadataKey(e);this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!at.isServerTelemetryEntity(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){let t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;let n=this.validateAndParseJson(t);return n&&at.isAuthorityMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(lf.WRAPPER_SKU,e),this.internalStorage.setItem(lf.WRAPPER_VER,t)}getWrapperMetadata(){let e=this.internalStorage.getItem(lf.WRAPPER_SKU)||R.EMPTY_STRING,t=this.internalStorage.getItem(lf.WRAPPER_VER)||R.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){let e=this.generateCacheKey(kt.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");let o=this.generateCacheKey(kt.ACTIVE_ACCOUNT),i=this.getItem(o);if(!i)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;let a=this.getAccountInfoFilteredBy({localAccountId:i});return a?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(a),a):null}let n=this.validateAndParseJson(t);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){let t=this.generateCacheKey(kt.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(kt.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");let o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(o)),this.browserStorage.setItem(n,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(n)}getThrottlingCache(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!at.isThrottlingEntity(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){let n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){let i=this.getItemCookie(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}let o=this.temporaryCacheStorage.getItem(n);if(!o){if(this.cacheConfig.cacheLocation===rt.LocalStorage){let i=this.browserStorage.getItem(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,t,n){let o=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(o,t))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}clear(){return C(this,null,function*(){yield this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(R.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(R.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()})}clearTokensAndKeysWithClaims(e,t){return C(this,null,function*(){e.addQueueMeasurement(g.ClearTokensAndKeysWithClaims,t);let n=this.getTokenKeys(),o=[];n.accessToken.forEach(i=>{let a=this.getAccessTokenCredential(i);a?.requestedClaimsHash&&i.includes(a.requestedClaimsHash.toLowerCase())&&o.push(this.removeAccessToken(i))}),yield Promise.all(o),o.length>0&&this.logger.warning(`${o.length} access tokens with claims in the cache keys have been removed from the cache.`)})}setItemCookie(e,t,n){let o=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(n){let i=this.getCookieExpirationTime(n);o+=`expires=${i};`}this.cacheConfig.secureCookies&&(o+="Secure;"),document.cookie=o}getItemCookie(e){let t=`${encodeURIComponent(e)}=`,n=document.cookie.split(";");for(let o=0;o<n.length;o++){let i=n[o];for(;i.charAt(0)===" ";)i=i.substring(1);if(i.indexOf(t)===0)return decodeURIComponent(i.substring(t.length,i.length))}return R.EMPTY_STRING}clearMsalCookies(){let e=`${R.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(n=>{for(;n.charAt(0)===" ";)n=n.substring(1);if(n.indexOf(e)===0){let o=n.split("=")[0];this.clearItemCookie(o)}})}clearItemCookie(e){this.setItemCookie(e,R.EMPTY_STRING,-1)}getCookieExpirationTime(e){let t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):Et.startsWith(e,R.CACHE_PREFIX)||Et.startsWith(e,kt.ADAL_ID_TOKEN)?e:`${R.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){let{libraryState:{id:t}}=Qt.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Ge.AUTHORITY}.${t}`)}generateNonceKey(e){let{libraryState:{id:t}}=Qt.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Ge.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){let{libraryState:{id:t}}=Qt.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Ge.REQUEST_STATE}.${t}`)}getCachedAuthority(e){let t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;let o=this.generateAuthorityKey(n);return this.getTemporaryCache(o)}updateCacheEntries(e,t,n,o,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");let a=this.generateStateKey(e);this.setTemporaryCache(a,e,!1);let s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);let c=this.generateAuthorityKey(e);if(this.setTemporaryCache(c,n,!1),i){let l={credential:i.homeAccountId,type:$t.HOME_ACCOUNT_ID};this.setTemporaryCache(Ge.CCS_CREDENTIAL,JSON.stringify(l),!0)}else if(o){let l={credential:o,type:$t.UPN};this.setTemporaryCache(Ge.CCS_CREDENTIAL,JSON.stringify(l),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(Ge.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Ge.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Ge.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Ge.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(Ge.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(Ge.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){let t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||R.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(Ge.REQUEST_STATE)===-1)return;let n=this.temporaryCacheStorage.getItem(t);if(!n)return;let o=Hg(this.cryptoImpl,n);o&&o.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");let t=df(JSON.stringify(e));this.setTemporaryCache(Ge.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");let t=this.getTemporaryCache(Ge.REQUEST_PARAMS,!0);if(!t)throw $(vu);let n;try{n=JSON.parse(sn(t))}catch(o){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${o}`),$(Eu)}if(this.removeTemporaryItem(this.generateCacheKey(Ge.REQUEST_PARAMS)),!n.authority){let o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw $(Ma);n.authority=i}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");let e=this.getTemporaryCache(Ge.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;let t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){let t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){let e=`${R.CACHE_PREFIX}.${Ge.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){let t=`${R.CACHE_PREFIX}.${Ge.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw $(uu);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){let e=this.getTemporaryCache(kt.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(kt.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));let t=this.getTemporaryCache(kt.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(kt.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));let n=t||e;if(n){let o=Na.extractTokenClaims(n,sn);if(o.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),o.preferred_username;if(o.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),o.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){let n=at.generateCredentialKey(t);if(e!==n){let o=this.getItem(e);if(o)return this.browserStorage.removeItem(e),this.setItem(n,o),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}hydrateCache(e,t){return C(this,null,function*(){let n=at.createIdTokenEntity(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId),o;t.claims&&(o=yield this.cryptoImpl.hashString(t.claims));let i=at.createAccessTokenEntity(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,sn,void 0,e.tokenType,void 0,t.sshKid,t.claims,o),a={idToken:n,accessToken:i};return this.saveCacheRecord(a)})}saveCacheRecord(e,t,n){return C(this,null,function*(){try{yield uh(r.prototype,this,"saveCacheRecord").call(this,e,t,n)}catch(o){if(o instanceof wi&&this.performanceClient&&n)try{let i=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},n)}catch{}throw o}})}},rw=(r,e)=>{let t={cacheLocation:rt.MemoryStorage,temporaryCacheLocation:rt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new Mu(r,t,Aa,e)};function nw(r,e,t,n){return r.verbose("getAllAccounts called"),t?e.getAllAccounts(n):[]}function ow(r,e,t){if(e.trace("getAccount called"),Object.keys(r).length===0)return e.warning("getAccount: No accountFilter provided"),null;let n=t.getAccountInfoFilteredBy(r);return n?(e.verbose("getAccount: Account matching provided filter found, returning"),n):(e.verbose("getAccount: No matching account found, returning null"),null)}function iw(r,e,t){if(e.trace("getAccountByUsername called"),!r)return e.warning("getAccountByUsername: No username provided"),null;let n=t.getAccountInfoFilteredBy({username:r});return n?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${r}`),n):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function aw(r,e,t){if(e.trace("getAccountByHomeId called"),!r)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;let n=t.getAccountInfoFilteredBy({homeAccountId:r});return n?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${r}`),n):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function sw(r,e,t){if(e.trace("getAccountByLocalId called"),!r)return e.warning("getAccountByLocalId: No localAccountId provided"),null;let n=t.getAccountInfoFilteredBy({localAccountId:r});return n?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${r}`),n):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function cw(r,e){e.setActiveAccount(r)}function lw(r){return r.getActiveAccount()}var te={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};var Bg=class{constructor(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(e){if(typeof window<"u"){let t=mr();return this.eventCallbacks.set(t,e),this.logger.verbose(`Event callback registered with id: ${t}`),t}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(e,t,n,o){if(typeof window<"u"){let i={eventType:e,interactionType:t||null,payload:n||null,error:o||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${e}`),this.eventCallbacks.forEach((a,s)=>{this.logger.verbose(`Emitting event to callback ${s}: ${e}`),a.apply(null,[i])})}}handleAccountCacheChange(e){try{e.key?.includes(kt.ACTIVE_ACCOUNT_FILTERS)&&this.emitEvent(te.ACTIVE_ACCOUNT_CHANGED);let t=e.newValue||e.oldValue;if(!t)return;let n=JSON.parse(t);if(typeof n!="object"||!st.isAccountEntity(n))return;let i=bi.toObject(new st,n).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(te.ACCOUNT_ADDED,void 0,i)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(te.ACCOUNT_REMOVED,void 0,i))}catch{return}}};var Lu=class{constructor(e,t,n,o,i,a,s,c,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=a,this.nativeMessageHandler=c,this.correlationId=l||mr(),this.logger=o.clone(xt.MSAL_SKU,Ha,this.correlationId),this.performanceClient=s}clearCacheOnLogout(e){return C(this,null,function*(){if(e){st.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{yield this.browserStorage.removeAccount(st.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),yield this.browserStorage.clear(),yield this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}})}getRedirectUri(e){this.logger.verbose("getRedirectUri called");let t=e||this.config.auth.redirectUri||an();return Ie.getAbsoluteUrl(t,an())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");let n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new bc(n,this.browserStorage)}getDiscoveredAuthority(e){return C(this,null,function*(){let{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(g.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);let o={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,a=n?.length?n==="true":this.config.auth.instanceAware,s=t&&a?this.config.auth.authority.replace(Ie.getDomainFromUrl(i),t.environment):i,c=Vn.generateAuthority(s,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),l=yield Y(fg.createDiscoveredInstance,g.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(c,this.config.system.networkClient,this.browserStorage,o,this.logger,this.correlationId,this.performanceClient);if(t&&!l.isAlias(t.environment))throw Me(Eo.authorityMismatch);return l})}};var PM=32;function uw(r,e,t){return C(this,null,function*(){r.addQueueMeasurement(g.GeneratePkceCodes,t);let n=jr(OM,g.GenerateCodeVerifier,e,r,t)(r,e,t),o=yield Y(kM,g.GenerateCodeChallengeFromVerifier,e,r,t)(n,r,e,t);return{verifier:n,challenge:o}})}function OM(r,e,t){try{let n=new Uint8Array(PM);return jr(GR,g.GetRandomValues,e,r,t)(n),kc(n)}catch{throw $(Dc)}}function kM(r,e,t,n){return C(this,null,function*(){e.addQueueMeasurement(g.GenerateCodeChallengeFromVerifier,n);try{let o=yield Y(Ky,g.Sha256Digest,t,e,n)(r,e,n);return kc(new Uint8Array(o))}catch{throw $(Dc)}})}function _f(r,e,t,n){return C(this,null,function*(){t.addQueueMeasurement(g.InitializeBaseRequest,r.correlationId);let o=r.authority||e.auth.authority,i=[...r&&r.scopes||[]],a=ie(U({},r),{correlationId:r.correlationId,authority:o,scopes:i});if(!a.authenticationScheme)a.authenticationScheme=xe.BEARER,n.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(a.authenticationScheme===xe.SSH){if(!r.sshJwk)throw Me(Eo.missingSshJwk);if(!r.sshKid)throw Me(Eo.missingSshKid)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&r.claims&&!Et.isEmptyObj(r.claims)&&(a.requestedClaimsHash=yield Rg(r.claims)),a})}function dw(r,e,t,n,o){return C(this,null,function*(){n.addQueueMeasurement(g.InitializeSilentRequest,r.correlationId);let i=yield Y(_f,g.InitializeBaseRequest,o,n,r.correlationId)(r,t,n,o);return ie(U(U({},r),i),{account:e,forceRefresh:r.forceRefresh||!1})})}var cn=class extends Lu{initializeAuthorizationCodeRequest(e){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);let t=yield Y(uw,g.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n=ie(U({},e),{redirectUri:e.redirectUri,code:R.EMPTY_STRING,codeVerifier:t.verifier});return e.codeChallenge=t.challenge,e.codeChallengeMethod=R.S256_CODE_CHALLENGE_METHOD,n})}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);let t=U({correlationId:this.correlationId||mr()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){let n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Ie.getAbsoluteUrl(e.postLogoutRedirectUri,an())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Ie.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,an())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Ie.getAbsoluteUrl(an(),an())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){let t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}createAuthCodeClient(e){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.StandardInteractionClientCreateAuthCodeClient,this.correlationId);let t=yield Y(this.getClientConfiguration.bind(this),g.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new wc(t,this.performanceClient)})}getClientConfiguration(e){return C(this,null,function*(){let{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:a}=e;this.performanceClient.addQueueMeasurement(g.StandardInteractionClientGetClientConfiguration,this.correlationId);let s=yield Y(this.getDiscoveredAuthority.bind(this),g.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:a}),c=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:c.loggerCallback,piiLoggingEnabled:c.piiLoggingEnabled,logLevel:c.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:xt.MSAL_SKU,version:Ha,cpu:R.EMPTY_STRING,os:R.EMPTY_STRING},telemetry:this.config.telemetry}})}initializeAuthorizationRequest(e,t){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);let n=this.getRedirectUri(e.redirectUri),o={interactionType:t},i=Qt.setRequestState(this.browserCrypto,e&&e.state||R.EMPTY_STRING,o),a=yield Y(_f,g.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(ie(U({},e),{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),s=ie(U({},a),{redirectUri:n,state:i,nonce:e.nonce||mr(),responseMode:this.config.auth.OIDCOptions.serverResponseType}),c=e.account||this.browserStorage.getActiveAccount();if(c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${c.homeAccountId}`,this.correlationId),s.account=c),!s.loginHint&&!c){let l=this.browserStorage.getLegacyLoginHint();l&&(s.loginHint=l)}return s})}};var hw="ContentError",Kg="user_switch";var fw="USER_INTERACTION_REQUIRED",pw="USER_CANCEL",mw="NO_NETWORK",gw="PERSISTENT_ERROR",_w="DISABLED",vw="ACCOUNT_UNAVAILABLE";var xM=-2147186943,MM={[Kg]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Wn=class r extends Pe{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,r.prototype),this.name="NativeAuthError",this.ext=n}};function Ba(r){if(r.ext&&r.ext.status&&(r.ext.status===gw||r.ext.status===_w)||r.ext&&r.ext.error&&r.ext.error===xM)return!0;switch(r.errorCode){case hw:return!0;default:return!1}}function vf(r,e,t){if(t&&t.status)switch(t.status){case vw:return ru(Di.nativeAccountUnavailable);case fw:return new Cr(r,e);case pw:return $(on);case mw:return $(Pi)}return new Wn(r,MM[r]||e,t)}var Uu=class extends cn{acquireToken(e){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.SilentCacheClientAcquireToken,e.correlationId);let t=this.initializeServerTelemetryManager(Ve.acquireTokenSilent_silentFlow),n=yield Y(this.getClientConfiguration.bind(this),g.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),o=new sf(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{let a=(yield Y(o.acquireCachedToken.bind(o),g.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),a}catch(i){throw i instanceof Oc&&i.errorCode===Ua&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}})}logout(e){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}};var Vy={BROKER_CLIENT_ID:"brk_client_id",BROKER_REDIRECT_URI:"brk_redirect_uri"},$n=class extends Lu{constructor(e,t,n,o,i,a,s,c,l,u,d,h){super(e,t,n,o,i,a,c,l,h),this.apiId=s,this.accountId=u,this.nativeMessageHandler=l,this.nativeStorageManager=d,this.silentCacheClient=new Uu(e,this.nativeStorageManager,n,o,i,a,c,l,h),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);let f=this.nativeMessageHandler.getExtensionId()===Ya.PREFERRED_EXTENSION_ID?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=bc.makeExtraSkuString({libraryName:xt.MSAL_SKU,libraryVersion:Ha,extensionName:f,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=ie(U({},e.extraParameters),{[tu.X_CLIENT_EXTRA_SKU]:this.skus})}acquireToken(e){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");let t=this.performanceClient.startMeasurement(g.NativeInteractionClientAcquireToken,e.correlationId),n=Gh.nowSeconds();try{let o=yield this.initializeNativeRequest(e);try{let l=yield this.acquireTokensFromCache(this.accountId,o);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),l}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}let i=xo(o,[]),a={method:ki.GetToken,request:i},s=yield this.nativeMessageHandler.sendMessage(a),c=this.validateNativeResponse(s);return yield this.handleNativeResponse(c,o,n).then(l=>(t.end({success:!0,isNativeBroker:!0,requestId:l.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),l)).catch(l=>{throw t.end({success:!1,errorCode:l.errorCode,subErrorCode:l.subError,isNativeBroker:!0}),l})}catch(o){throw o instanceof Wn&&this.serverTelemetryManager.setNativeBrokerErrorCode(o.errorCode),o}})}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:pt.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}acquireTokensFromCache(e,t){return C(this,null,function*(){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),x(Wt.noAccountFound);let n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!n)throw x(Wt.noAccountFound);try{let o=this.createSilentCacheRequest(t,n),i=yield this.silentCacheClient.acquireToken(o),a=ie(U({},n),{idTokenClaims:i?.idTokenClaims,idToken:i?.idToken});return ie(U({},i),{account:a})}catch(o){throw o}})}acquireTokenRedirect(e,t){return C(this,null,function*(){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");let n=xo(e,[]);delete n.onRedirectNavigate;let o=yield this.initializeNativeRequest(n),i={method:ki.GetToken,request:o};try{let c=yield this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(c)}catch(c){if(c instanceof Wn&&(this.serverTelemetryManager.setNativeBrokerErrorCode(c.errorCode),Ba(c)))throw c}this.browserStorage.setTemporaryCache(Ge.NATIVE_REQUEST,JSON.stringify(o),!0);let a={apiId:Ve.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),yield this.navigationClient.navigateExternal(s,a)})}handleRedirectPromise(e,t){return C(this,null,function*(){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;let c=n,{prompt:o}=c,i=xo(c,["prompt"]);o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ge.NATIVE_REQUEST));let a={method:ki.GetToken,request:i},s=Gh.nowSeconds();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");let l=yield this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(l);let u=this.handleNativeResponse(l,i,s);this.browserStorage.setInteractionInProgress(!1);let d=yield u;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),d}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}})}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}handleNativeResponse(e,t,n){return C(this,null,function*(){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");let o=Na.extractTokenClaims(e.id_token,sn),i=this.createHomeAccountIdentifier(e,o),a=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(i!==a&&e.account.id!==t.accountId)throw vf(Kg);let s=yield this.getDiscoveredAuthority({requestAuthority:t.authority}),c=nu(this.browserStorage,s,i,sn,o,e.client_info,void 0,o.tid,void 0,e.account.id,this.logger),l=yield this.generateAuthenticationResult(e,t,o,c,s.canonicalAuthority,n);return this.cacheAccount(c),this.cacheNativeTokens(e,t,i,o,e.access_token,l.tenantId,n),l})}createHomeAccountIdentifier(e,t){return st.generateHomeAccountId(e.client_info||R.EMPTY_STRING,zr.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?pt.fromString(e.scope):pt.fromString(t.scope)}generatePopAccessToken(e,t){return C(this,null,function*(){if(t.tokenType===xe.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;let n=new Dn(this.browserCrypto),o={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw x(Wt.keyIdMissing);return n.signPopToken(e.access_token,t.keyId,o)}else return e.access_token})}generateAuthenticationResult(e,t,n,o,i,a){return C(this,null,function*(){let s=this.addTelemetryFromNativeResponse(e),c=e.scope?pt.fromString(e.scope):pt.fromString(t.scope),l=e.account.properties||{},u=l.UID||n.oid||n.sub||R.EMPTY_STRING,d=l.TenantId||n.tid||R.EMPTY_STRING,h=Rc(o.getAccountInfo(),void 0,n,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);let f=yield this.generatePopAccessToken(e,t),p=t.tokenType===xe.POP?xe.POP:xe.BEARER;return{authority:i,uniqueId:u,tenantId:d,scopes:c.asArray(),account:h,idToken:e.id_token,idTokenClaims:n,accessToken:f,fromCache:s?this.isResponseFromCache(s):!1,expiresOn:new Date(Number(a+e.expires_in)*1e3),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}})}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,n,o,i,a,s){let c=at.createIdTokenEntity(n,t.authority,e.id_token||"",t.clientId,o.tid||""),l=t.tokenType===xe.POP?R.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,u=s+l,d=this.generateScopes(e,t),h=at.createAccessTokenEntity(n,t.authority,i,t.clientId,o.tid||a,d.printScopes(),u,0,sn,void 0,t.tokenType,void 0,t.keyId),f={idToken:c,accessToken:h};this.nativeStorageManager.saveCacheRecord(f,t.storeInCache)}addTelemetryFromNativeResponse(e){let t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Rh(Xs.unexpectedError,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}initializeNativeRequest(e){return C(this,null,function*(){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");let t=e.authority||this.config.auth.authority;e.account&&(yield this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}));let n=new Ie(t);n.validateAsUri();let l=e,{scopes:o}=l,i=xo(l,["scopes"]),a=new pt(o||[]);a.appendScopes(wn);let s=()=>{switch(this.apiId){case Ve.ssoSilent:case Ve.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),ft.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case ft.NONE:case ft.CONSENT:case ft.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),$(Du)}},c=ie(U({},i),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:s(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:U(U({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(c.signPopToken&&e.popKid)throw $(Ou);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=Ya.MATS_TELEMETRY,e.authenticationScheme===xe.POP){let u={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},d=new Dn(this.browserCrypto),h;if(c.keyId)h=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{let f=yield Y(d.generateCnf.bind(d),g.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(u,this.logger);h=f.reqCnfString,c.keyId=f.kid,c.signPopToken=!0}c.reqCnf=h}return this.addRequestSKUs(c),c})}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(Vy.BROKER_CLIENT_ID)&&e.extraParameters.hasOwnProperty(Vy.BROKER_REDIRECT_URI)&&e.extraParameters.hasOwnProperty(tu.CLIENT_ID)){let t=e.extraParameters[tu.CLIENT_ID],n=e.redirectUri,o=e.extraParameters[Vy.BROKER_REDIRECT_URI];e.extraParameters={child_client_id:t,child_redirect_uri:n},e.redirectUri=o}}};var Pn=class r{constructor(e,t,n,o){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(g.NativeMessageHandlerHandshake)}sendMessage(e){return C(this,null,function*(){this.logger.trace("NativeMessageHandler - sendMessage called.");let t={channel:Ya.CHANNEL_ID,extensionId:this.extensionId,responseId:mr(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((n,o)=>{this.resolvers.set(t.responseId,{resolve:n,reject:o})})})}static createProvider(e,t,n){return C(this,null,function*(){e.trace("NativeMessageHandler - createProvider called.");try{let o=new r(e,t,n,Ya.PREFERRED_EXTENSION_ID);return yield o.sendHandshakeRequest(),o}catch{let i=new r(e,t,n);return yield i.sendHandshakeRequest(),i}})}sendHandshakeRequest(){return C(this,null,function*(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);let e={channel:Ya.CHANNEL_ID,extensionId:this.extensionId,responseId:mr(),body:{method:ki.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n($(Ru)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;let t=e.data;if(!(!t.channel||t.channel!==Ya.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===ki.HandshakeRequest){let n=this.handshakeResolvers.get(t.responseId);if(!n){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),n.reject($(wu))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");let t=e.data,n=this.resolvers.get(t.responseId),o=this.handshakeResolvers.get(t.responseId);try{let i=t.body.method;if(i===ki.Response){if(!n)return;let a=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(a)}`),a.status!=="Success")n.reject(vf(a.code,a.description,a.ext));else if(a.result)a.result.code&&a.result.description?n.reject(vf(a.result.code,a.result.description,a.result.ext)):n.resolve(a.result);else throw Rh(Xs.unexpectedError,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(i===ki.HandshakeResponse){if(!o){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(i):o&&o.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,o){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case xe.BEARER:case xe.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}};var Ka=class{constructor(e,t,n,o,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=o,this.performanceClient=i}handleCodeResponse(e,t){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.HandleCodeResponse,t.correlationId);let n;try{n=this.authModule.handleFragmentResponse(e,t.state)}catch(o){throw o instanceof Vr&&o.subError===on?$(on):o}return Y(this.handleCodeResponseFromServer.bind(this),g.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(n,t)})}handleCodeResponseFromServer(e,t,n=!0){return C(this,null,function*(){if(this.performanceClient.addQueueMeasurement(g.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&(yield Y(this.authModule.updateAuthority.bind(this.authModule),g.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId)),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{let i=this.createCcsCredentials(t);i&&(this.authCodeRequest.ccsCredential=i)}return yield Y(this.authModule.acquireToken.bind(this.authModule),g.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)})}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:$t.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:$t.UPN}:null}};function Gg(r,e,t){let n=wa.getDeserializedResponse(r);if(!n)throw wa.stripLeadingHashOrQuery(r)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${r}`),$(su)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),$(au));return n}function Ew(r,e,t){if(!r.state)throw $(xa);let n=Hg(e,r.state);if(!n)throw $(cu);if(n.interactionType!==t)throw $(lu)}var qg=class extends cn{constructor(e,t,n,o,i,a,s,c,l,u){super(e,t,n,o,i,a,s,l,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=c}acquireToken(e){try{let n={popupName:this.generatePopupName(e.scopes||wn,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(e,n))}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");let t=this.initializeLogoutRequest(e),n={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),n.popup=this.openSizedPopup("about:blank",n),this.logoutPopupAsync(t,n,o,i))}catch(t){return Promise.reject(t)}}acquireTokenPopupAsync(e,t){return C(this,null,function*(){this.logger.verbose("acquireTokenPopupAsync called");let n=this.initializeServerTelemetryManager(Ve.acquireTokenPopup),o=yield Y(this.initializeAuthorizationRequest.bind(this),g.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,ee.Popup);pf(o.authority);try{let i=yield Y(this.initializeAuthorizationCodeRequest.bind(this),g.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(o),a=yield Y(this.createAuthCodeClient.bind(this),g.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account}),s=Pn.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),c;s&&(c=this.performanceClient.startMeasurement(g.FetchAccountIdWithNativeBroker,e.correlationId));let l=yield a.getAuthCodeUrl(ie(U({},o),{nativeBroker:s})),u=new Ka(a,this.browserStorage,i,this.logger,this.performanceClient),d=this.initiateAuthRequest(l,t);this.eventHandler.emitEvent(te.POPUP_OPENED,ee.Popup,{popupWindow:d},null);let h=yield this.monitorPopupForHash(d,t.popupWindowParent),f=jr(Gg,g.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(h,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Ho.removeThrottle(this.browserStorage,this.config.auth.clientId,i),f.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw $(jn);let m=new $n(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ve.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,f.accountId,this.nativeStorage,o.correlationId),{userRequestState:_}=Qt.parseRequestState(this.browserCrypto,o.state);return yield m.acquireToken(ie(U({},o),{state:_,prompt:void 0}))}return yield u.handleCodeResponse(f,o)}catch(i){throw t.popup?.close(),i instanceof Pe&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),i}})}logoutPopupAsync(e,t,n,o){return C(this,null,function*(){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(te.LOGOUT_START,ee.Popup,e);let i=this.initializeServerTelemetryManager(Ve.logoutPopup);try{yield this.clearCacheOnLogout(e.account);let a=yield Y(this.createAuthCodeClient.bind(this),g.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:n,account:e.account||void 0});try{a.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&a.authority.protocolMode===yr.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(te.LOGOUT_SUCCESS,ee.Popup,e),o){let l={apiId:Ve.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=Ie.getAbsoluteUrl(o,an());yield this.navigationClient.navigateInternal(u,l)}t.popup?.close();return}}let s=a.getLogoutUri(e);this.eventHandler.emitEvent(te.LOGOUT_SUCCESS,ee.Popup,e);let c=this.openPopup(s,t);if(this.eventHandler.emitEvent(te.POPUP_OPENED,ee.Popup,{popupWindow:c},null),yield this.monitorPopupForHash(c,t.popupWindowParent).catch(()=>{}),o){let l={apiId:Ve.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=Ie.getAbsoluteUrl(o,an());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${u}`),yield this.navigationClient.navigateInternal(u,l)}else this.logger.verbose("No main window navigation requested")}catch(a){throw t.popup?.close(),a instanceof Pe&&(a.setCorrelationId(this.correlationId),i.cacheFailedRequest(a)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(te.LOGOUT_FAILURE,ee.Popup,null,a),this.eventHandler.emitEvent(te.LOGOUT_END,ee.Popup),a}this.eventHandler.emitEvent(te.LOGOUT_END,ee.Popup)})}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),$(qo)}monitorPopupForHash(e,t){return new Promise((n,o)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");let i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),o($(on));return}let a="";try{a=e.location.href}catch{}if(!a||a==="about:blank")return;clearInterval(i);let s="",c=this.config.auth.OIDCOptions.serverResponseType;e&&(c===go.QUERY?s=e.location.search:s=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),n(s)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t)),!n)throw $(hu);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),$(du)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:n,popupWindowParent:o}){let i=o.screenLeft?o.screenLeft:o.screenX,a=o.screenTop?o.screenTop:o.screenY,s=o.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=o.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=n.popupSize?.width,u=n.popupSize?.height,d=n.popupPosition?.top,h=n.popupPosition?.left;return(!l||l<0||l>s)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),l=xt.POPUP_WIDTH),(!u||u<0||u>c)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=xt.POPUP_HEIGHT),(!d||d<0||d>c)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),d=Math.max(0,c/2-xt.POPUP_HEIGHT/2+a)),(!h||h<0||h>s)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),h=Math.max(0,s/2-xt.POPUP_WIDTH/2+i)),o.open(e,t,`width=${l}, height=${u}, top=${d}, left=${h}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(ee.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${xt.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){let t=e.account&&e.account.homeAccountId;return`${xt.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}};var Ef=class{constructor(e,t,n,o,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=o,this.performanceClient=i}initiateAuthRequest(e,t){return C(this,null,function*(){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Ge.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Ge.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);let n={apiId:Ve.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),yield t.navigationClient.navigateExternal(e,n);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),yield t.navigationClient.navigateExternal(e,n);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),$(qo)})}handleCodeResponse(e,t){return C(this,null,function*(){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);let n=this.browserStorage.generateStateKey(t),o=this.browserStorage.getTemporaryCache(n);if(!o)throw x(Wt.stateNotFound,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,o)}catch(l){throw l instanceof Vr&&l.subError===on?$(on):l}let a=this.browserStorage.generateNonceKey(o),s=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&(yield Y(this.authModule.updateAuthority.bind(this.authModule),g.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId)),i.nonce=s||void 0,i.state=o,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{let l=this.checkCcsCredentials();l&&(this.authCodeRequest.ccsCredential=l)}let c=yield this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(t),c})}checkCcsCredentials(){let e=this.browserStorage.getTemporaryCache(Ge.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}};var zg=class extends cn{constructor(e,t,n,o,i,a,s,c,l,u){super(e,t,n,o,i,a,s,l,u),this.nativeStorage=c}acquireToken(e){return C(this,null,function*(){let t=yield Y(this.initializeAuthorizationRequest.bind(this),g.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,ee.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);let n=this.initializeServerTelemetryManager(Ve.acquireTokenRedirect),o=i=>{i.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(te.RESTORE_FROM_BFCACHE,ee.Redirect))};try{let i=yield Y(this.initializeAuthorizationCodeRequest.bind(this),g.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),a=yield Y(this.createAuthCodeClient.bind(this),g.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),s=new Ef(a,this.browserStorage,i,this.logger,this.performanceClient),c=yield a.getAuthCodeUrl(ie(U({},t),{nativeBroker:Pn.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)})),l=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${l}`),window.addEventListener("pageshow",o),yield s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof Pe&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),window.removeEventListener("pageshow",o),this.browserStorage.cleanRequestByState(t.state),i}})}handleRedirectPromise(e="",t){return C(this,null,function*(){let n=this.initializeServerTelemetryManager(Ve.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let[o,i]=this.getRedirectResponse(e||"");if(!o)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(ee.Redirect),t.event.errorCode="no_server_response",null;let a=this.browserStorage.getTemporaryCache(Ge.ORIGIN_URI,!0)||R.EMPTY_STRING,s=Ie.removeHashFromUrl(a),c=Ie.removeHashFromUrl(window.location.href);if(s===c&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&qy(a),yield this.handleResponse(o,n);if(this.config.auth.navigateToLoginRequestUrl){if(!hf()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Ge.URL_HASH,i,!0);let l={apiId:Ve.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},u=!0;if(!a||a==="null"){let d=zy();this.browserStorage.setTemporaryCache(Ge.ORIGIN_URI,d,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),u=yield this.navigationClient.navigateInternal(d,l)}else this.logger.verbose(`Navigating to loginRequestUrl: ${a}`),u=yield this.navigationClient.navigateInternal(a,l);if(!u)return yield this.handleResponse(o,n)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),yield this.handleResponse(o,n);return null}catch(o){throw o instanceof Pe&&(o.setCorrelationId(this.correlationId),n.cacheFailedRequest(o)),this.browserStorage.cleanRequestByInteractionType(ee.Redirect),o}})}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===go.QUERY?t=window.location.search:t=window.location.hash);let n=wa.getDeserializedResponse(t);if(n){try{Ew(n,this.browserCrypto,ee.Redirect)}catch(i){return i instanceof Pe&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return Gy(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}let o=this.browserStorage.getTemporaryCache(Ge.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ge.URL_HASH)),o&&(n=wa.getDeserializedResponse(o),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,o]):[null,""]}handleResponse(e,t){return C(this,null,function*(){let n=e.state;if(!n)throw $(xa);let o=this.browserStorage.getCachedRequest(n);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw $(jn);let c=new $n(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ve.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,o.correlationId),{userRequestState:l}=Qt.parseRequestState(this.browserCrypto,n);return c.acquireToken(ie(U({},o),{state:l,prompt:void 0})).finally(()=>{this.browserStorage.cleanRequestByState(n)})}let i=this.browserStorage.getCachedAuthority(n);if(!i)throw $(Ma);let a=yield Y(this.createAuthCodeClient.bind(this),g.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:i});return Ho.removeThrottle(this.browserStorage,this.config.auth.clientId,o),new Ef(a,this.browserStorage,o,this.logger,this.performanceClient).handleCodeResponse(e,n)})}logout(e){return C(this,null,function*(){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(Ve.logout);try{this.eventHandler.emitEvent(te.LOGOUT_START,ee.Redirect,e),yield this.clearCacheOnLogout(t.account);let o={apiId:Ve.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=yield Y(this.createAuthCodeClient.bind(this),g.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(i.authority.protocolMode===yr.OIDC)try{i.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId){this.browserStorage.removeAccount(t.account?.homeAccountId),this.eventHandler.emitEvent(te.LOGOUT_SUCCESS,ee.Redirect,t);return}}let a=i.getLogoutUri(t);if(this.eventHandler.emitEvent(te.LOGOUT_SUCCESS,ee.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(a)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),yield this.navigationClient.navigateExternal(a,o);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),yield this.navigationClient.navigateExternal(a,o);return}}catch(o){throw o instanceof Pe&&(o.setCorrelationId(this.correlationId),n.cacheFailedRequest(o)),this.eventHandler.emitEvent(te.LOGOUT_FAILURE,ee.Redirect,null,o),this.eventHandler.emitEvent(te.LOGOUT_END,ee.Redirect),o}this.eventHandler.emitEvent(te.LOGOUT_END,ee.Redirect)})}getRedirectStartPage(e){let t=e||window.location.href;return Ie.getAbsoluteUrl(t,an())}};function Tw(r,e,t,n,o){return C(this,null,function*(){if(e.addQueueMeasurement(g.SilentHandlerInitiateAuthRequest,n),!r)throw t.info("Navigate url is empty"),$(qo);return o?Y(LM,g.SilentHandlerLoadFrame,t,e,n)(r,o,e,n):jr(UM,g.SilentHandlerLoadFrameSync,t,e,n)(r)})}function yw(r,e,t,n,o,i,a){return C(this,null,function*(){return n.addQueueMeasurement(g.SilentHandlerMonitorIframeForHash,i),new Promise((s,c)=>{e<Mg&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${Mg}ms). This may result in timeouts.`);let l=window.setTimeout(()=>{window.clearInterval(u),c($(fu))},e),u=window.setInterval(()=>{let d="",h=r.contentWindow;try{d=h?h.location.href:""}catch{}if(!d||d==="about:blank")return;let f="";h&&(a===go.QUERY?f=h.location.search:f=h.location.hash),window.clearTimeout(l),window.clearInterval(u),s(f)},t)}).finally(()=>{jr(FM,g.RemoveHiddenIframe,o,n,i)(r)})})}function LM(r,e,t,n){return t.addQueueMeasurement(g.SilentHandlerLoadFrame,n),new Promise((o,i)=>{let a=Cw();window.setTimeout(()=>{if(!a){i("Unable to load iframe");return}a.src=r,o(a)},e)})}function UM(r){let e=Cw();return e.src=r,e}function Cw(){let r=document.createElement("iframe");return r.className="msalSilentIframe",r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(r),r}function FM(r){document.body===r.parentNode&&document.body.removeChild(r)}var Vg=class extends cn{constructor(e,t,n,o,i,a,s,c,l,u,d){super(e,t,n,o,i,a,c,u,d),this.apiId=s,this.nativeStorage=l}acquireToken(e){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");let t=U({},e);t.prompt?t.prompt!==ft.NONE&&t.prompt!==ft.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${ft.NONE}`),t.prompt=ft.NONE):t.prompt=ft.NONE;let n=yield Y(this.initializeAuthorizationRequest.bind(this),g.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,ee.Silent);pf(n.authority);let o=this.initializeServerTelemetryManager(this.apiId),i;try{return i=yield Y(this.createAuthCodeClient.bind(this),g.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:o,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),yield Y(this.silentTokenHelper.bind(this),g.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(i,n)}catch(a){if(a instanceof Pe&&(a.setCorrelationId(this.correlationId),o.cacheFailedRequest(a)),!i||!(a instanceof Pe)||a.errorCode!==xt.INVALID_GRANT_ERROR)throw a;this.performanceClient.addFields({retryError:a.errorCode},this.correlationId);let s=yield Y(this.initializeAuthorizationRequest.bind(this),g.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,ee.Silent);return yield Y(this.silentTokenHelper.bind(this),g.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,s)}})}logout(){return Promise.reject($(zo))}silentTokenHelper(e,t){return C(this,null,function*(){let n=t.correlationId;this.performanceClient.addQueueMeasurement(g.SilentIframeClientTokenHelper,n);let o=yield Y(this.initializeAuthorizationCodeRequest.bind(this),g.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,n)(t),i=yield Y(e.getAuthCodeUrl.bind(e),g.GetAuthCodeUrl,this.logger,this.performanceClient,n)(ie(U({},t),{nativeBroker:Pn.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)})),a=new Ka(e,this.browserStorage,o,this.logger,this.performanceClient),s=yield Y(Tw,g.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,n)(i,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),c=this.config.auth.OIDCOptions.serverResponseType,l=yield Y(yw,g.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(s,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,c),u=jr(Gg,g.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,c,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw $(jn);let d=new $n(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,n),{userRequestState:h}=Qt.parseRequestState(this.browserCrypto,t.state);return Y(d.acquireToken.bind(d),g.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,n)(ie(U({},t),{state:h,prompt:t.prompt||ft.NONE}))}return Y(a.handleCodeResponse.bind(a),g.HandleCodeResponse,this.logger,this.performanceClient,n)(u,t)})}};var jg=class extends cn{acquireToken(e){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.SilentRefreshClientAcquireToken,e.correlationId);let t=yield Y(_f,g.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n=U(U({},e),t);e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));let o=this.initializeServerTelemetryManager(Ve.acquireTokenSilent_silentFlow),i=yield this.createRefreshTokenClient({serverTelemetryManager:o,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return Y(i.acquireTokenByRefreshToken.bind(i),g.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(n).catch(a=>{throw a.setCorrelationId(this.correlationId),o.cacheFailedRequest(a),a})})}logout(){return Promise.reject($(zo))}createRefreshTokenClient(e){return C(this,null,function*(){let t=yield Y(this.getClientConfiguration.bind(this),g.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new ka(t,this.performanceClient)})}};var Wg=class{constructor(e,t,n,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=n,this.cryptoObj=o}loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw $(La);let o=t.id_token?Na.extractTokenClaims(t.id_token,sn):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new Vn(Vn.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||mr()):void 0,s=this.loadAccount(e,n.clientInfo||t.client_info||"",o,a),c=this.loadIdToken(t,s.homeAccountId,s.environment,s.realm),l=this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,n),u=this.loadRefreshToken(t,s.homeAccountId,s.environment);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:u},o,a)}loadAccount(e,t,n,o){if(this.logger.verbose("TokenCache - loading account"),e.account){let c=st.createFromAccountInfo(e.account);return this.storage.setAccount(c),c}else if(!o||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),$(Cu);let i=st.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=nu(this.storage,o,i,sn,n,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return this.storage.setAccount(s),s}loadIdToken(e,t,n,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");let i=at.createIdTokenEntity(t,n,e.id_token,this.config.auth.clientId,o);return this.storage.setIdTokenCredential(i),i}loadAccessToken(e,t,n,o,i,a){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");let s=t.scope?pt.fromString(t.scope):new pt(e.scopes),c=a.expiresOn||t.expires_in+new Date().getTime()/1e3,l=a.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=at.createAccessTokenEntity(n,o,t.access_token,this.config.auth.clientId,i,s.printScopes(),c,l,sn);return this.storage.setAccessTokenCredential(u),u}loadRefreshToken(e,t,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");let o=at.createRefreshTokenEntity(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(o),o}generateAuthenticationResult(e,t,n,o){let i="",a=[],s=null,c;t?.accessToken&&(i=t.accessToken.secret,a=pt.fromString(t.accessToken.target).asArray(),s=new Date(Number(t.accessToken.expiresOn)*1e3),c=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));let l=t.account;return{authority:o?o.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:l.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:n||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:c,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:l.cloudGraphHostName||"",msGraphHost:l.msGraphHost||"",fromNativeBroker:!1}}};var $g=class extends wc{constructor(e){super(e),this.includeRedirectUri=!1}};var Qg=class extends cn{constructor(e,t,n,o,i,a,s,c,l,u){super(e,t,n,o,i,a,c,l,u),this.apiId=s}acquireToken(e){return C(this,null,function*(){if(!e.code)throw $(Su);let t=yield Y(this.initializeAuthorizationRequest.bind(this),g.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,ee.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{let o=ie(U({},t),{code:e.code}),i=yield Y(this.getClientConfiguration.bind(this),g.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new $g(i);this.logger.verbose("Auth code client created");let s=new Ka(a,this.browserStorage,o,this.logger,this.performanceClient);return yield Y(s.handleCodeResponseFromServer.bind(s),g.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(o){throw o instanceof Pe&&(o.setCorrelationId(this.correlationId),n.cacheFailedRequest(o)),o}})}logout(){return Promise.reject($(zo))}};function jo(r){let e=r?.idTokenClaims;if(e?.tfp||e?.acr)return"B2C";if(e?.tid){if(e?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function Xg(r,e){try{ff(r)}catch(t){throw e.end({success:!1},t),t}}var Fu=class r{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new tw(this.logger,this.performanceClient):Aa,this.eventHandler=new Bg(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Mu(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,Ry(this.config.auth),this.performanceClient):rw(this.config.auth.clientId,this.logger);let t={cacheLocation:rt.MemoryStorage,temporaryCacheLocation:rt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Mu(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new Wg(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static createController(e,t){return C(this,null,function*(){let n=new r(e);return yield n.initialize(t),n})}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}initialize(e){return C(this,null,function*(){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}let t=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowNativeBroker,o=this.performanceClient.startMeasurement(g.InitializeClientApplication,t);if(this.eventHandler.emitEvent(te.INITIALIZE_START),n)try{this.nativeExtensionProvider=yield Pn.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(i){this.logger.verbose(i)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),yield Y(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),g.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(te.INITIALIZE_END),o.end({allowNativeBroker:n,success:!0})})}handleRedirectPromise(e){return C(this,null,function*(){if(this.logger.verbose("handleRedirectPromise called"),Pg(this.initialized),this.isBrowserEnvironment){let t=e||"",n=this.redirectResponse.get(t);return typeof n>"u"?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null})}handleRedirectPromiseInternal(e){return C(this,null,function*(){let t=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),o=n&&Pn.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=o?n?.correlationId:this.browserStorage.getTemporaryCache(Ge.CORRELATION_ID,!0)||"",a=this.performanceClient.startMeasurement(g.AcquireTokenRedirect,i);this.eventHandler.emitEvent(te.HANDLE_REDIRECT_START,ee.Redirect);let s;if(o&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");let c=new $n(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ve.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);s=Y(c.handleRedirectPromise.bind(c),g.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");let c=this.createRedirectClient(i);s=Y(c.handleRedirectPromise.bind(c),g.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(e,a)}return s.then(c=>(c?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(te.LOGIN_SUCCESS,ee.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_SUCCESS,ee.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:jo(c.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),this.eventHandler.emitEvent(te.HANDLE_REDIRECT_END,ee.Redirect),c)).catch(c=>{let l=c;throw t.length>0?this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_FAILURE,ee.Redirect,null,l):this.eventHandler.emitEvent(te.LOGIN_FAILURE,ee.Redirect,null,l),this.eventHandler.emitEvent(te.HANDLE_REDIRECT_END,ee.Redirect),a.end({success:!1},l),c})})}acquireTokenRedirect(e){return C(this,null,function*(){let t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);let n=this.performanceClient.startMeasurement(g.AcquireTokenPreRedirect,t);n.add({accountType:jo(e.account),scenarioId:e.scenarioId});let o=e.onRedirectNavigate;if(o)e.onRedirectNavigate=a=>{let s=typeof o=="function"?o(a):void 0;return s!==!1?n.end({success:!0}):n.discard(),s};else{let a=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=s=>{let c=typeof a=="function"?a(s):void 0;return c!==!1?n.end({success:!0}):n.discard(),c}}let i=this.getAllAccounts().length>0;try{Og(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_START,ee.Redirect,e):this.eventHandler.emitEvent(te.LOGIN_START,ee.Redirect,e);let a;return this.nativeExtensionProvider&&this.canUseNative(e)?a=new $n(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ve.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(c=>{if(c instanceof Wn&&Ba(c))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(c instanceof Cr)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),c}):a=this.createRedirectClient(t).acquireToken(e),yield a}catch(a){throw n.end({success:!1},a),i?this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_FAILURE,ee.Redirect,null,a):this.eventHandler.emitEvent(te.LOGIN_FAILURE,ee.Redirect,null,a),a}})}acquireTokenPopup(e){let t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(g.AcquireTokenPopup,t);n.add({scenarioId:e.scenarioId,accountType:jo(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Xg(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(a){return Promise.reject(a)}let o=this.getAllAccounts();o.length>0?this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_START,ee.Popup,e):this.eventHandler.emitEvent(te.LOGIN_START,ee.Popup,e);let i;return this.canUseNative(e)?i=this.acquireTokenNative(ie(U({},e),{correlationId:t}),Ve.acquireTokenPopup).then(a=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,requestId:a.requestId,accountType:jo(a.account)}),a)).catch(a=>{if(a instanceof Wn&&Ba(a))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(a instanceof Cr)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),a}):i=this.createPopupClient(t).acquireToken(e),i.then(a=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(te.LOGIN_SUCCESS,ee.Popup,a):this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_SUCCESS,ee.Popup,a),n.end({success:!0,requestId:a.requestId,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:jo(a.account)}),a)).catch(a=>(o.length>0?this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_FAILURE,ee.Popup,null,a):this.eventHandler.emitEvent(te.LOGIN_FAILURE,ee.Popup,null,a),n.end({success:!1},a),Promise.reject(a)))}trackPageVisibilityWithMeasurement(){let e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}ssoSilent(e){return C(this,null,function*(){let t=this.getRequestCorrelationId(e),n=ie(U({},e),{prompt:e.prompt,correlationId:t});this.ssoSilentMeasurement=this.performanceClient.startMeasurement(g.SsoSilent,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:jo(e.account)}),Xg(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(te.SSO_SILENT_START,ee.Silent,n);let o;return this.canUseNative(n)?o=this.acquireTokenNative(n,Ve.ssoSilent).catch(i=>{if(i instanceof Wn&&Ba(i))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(n.correlationId).acquireToken(n);throw i}):o=this.createSilentIframeClient(n.correlationId).acquireToken(n),o.then(i=>(this.eventHandler.emitEvent(te.SSO_SILENT_SUCCESS,ee.Silent,i),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:i.fromNativeBroker,requestId:i.requestId,accessTokenSize:i.accessToken.length,idTokenSize:i.idToken.length,accountType:jo(i.account)}),i)).catch(i=>{throw this.eventHandler.emitEvent(te.SSO_SILENT_FAILURE,ee.Silent,null,i),this.ssoSilentMeasurement?.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})})}acquireTokenByCode(e){return C(this,null,function*(){let t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);let n=this.performanceClient.startMeasurement(g.AcquireTokenByCode,t);Xg(this.initialized,n),this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_BY_CODE_START,ee.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw $(Iu);if(e.code){let o=e.code,i=this.hybridAuthCodeResponses.get(o);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync(ie(U({},e),{correlationId:t})).then(a=>(this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_BY_CODE_SUCCESS,ee.Silent,a),this.hybridAuthCodeResponses.delete(o),n.end({success:!0,isNativeBroker:a.fromNativeBroker,requestId:a.requestId,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:jo(a.account)}),a)).catch(a=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_BY_CODE_FAILURE,ee.Silent,null,a),n.end({success:!1},a),a}),this.hybridAuthCodeResponses.set(o,i)),yield i}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){let o=yield this.acquireTokenNative(ie(U({},e),{correlationId:t}),Ve.acquireTokenByCode,e.nativeAccountId).catch(i=>{throw i instanceof Wn&&Ba(i)&&(this.nativeExtensionProvider=void 0),i});return n.end({accountType:jo(o.account),success:!0}),o}else throw $(Nu);else throw $(Au)}catch(o){throw this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_BY_CODE_FAILURE,ee.Silent,null,o),n.end({success:!1},o),o}})}acquireTokenByCodeAsync(e){return C(this,null,function*(){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(g.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),yield this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(o=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker,requestId:o.requestId}),o)).catch(o=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})})}acquireTokenFromCache(e,t){return C(this,null,function*(){switch(this.performanceClient.addQueueMeasurement(g.AcquireTokenFromCache,e.correlationId),t){case Wr.Default:case Wr.AccessToken:case Wr.AccessTokenAndRefreshToken:let n=this.createSilentCacheClient(e.correlationId);return Y(n.acquireToken.bind(n),g.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw x(Wt.tokenRefreshRequired)}})}acquireTokenByRefreshToken(e,t){return C(this,null,function*(){switch(this.performanceClient.addQueueMeasurement(g.AcquireTokenByRefreshToken,e.correlationId),t){case Wr.Default:case Wr.AccessTokenAndRefreshToken:case Wr.RefreshToken:case Wr.RefreshTokenAndNetwork:let n=this.createSilentRefreshClient(e.correlationId);return Y(n.acquireToken.bind(n),g.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw x(Wt.tokenRefreshRequired)}})}acquireTokenBySilentIframe(e){return C(this,null,function*(){this.performanceClient.addQueueMeasurement(g.AcquireTokenBySilentIframe,e.correlationId);let t=this.createSilentIframeClient(e.correlationId);return Y(t.acquireToken.bind(t),g.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)})}logout(e){return C(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect(U({correlationId:t},e))})}logoutRedirect(e){return C(this,null,function*(){let t=this.getRequestCorrelationId(e);return Og(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)})}logoutPopup(e){try{let t=this.getRequestCorrelationId(e);return ff(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}clearCache(e){return C(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)})}getAllAccounts(e){return nw(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return ow(e,this.logger,this.browserStorage)}getAccountByUsername(e){return iw(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return aw(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return sw(e,this.logger,this.browserStorage)}setActiveAccount(e){cw(e,this.browserStorage)}getActiveAccount(){return lw(this.browserStorage)}hydrateCache(e,t){return C(this,null,function*(){this.logger.verbose("hydrateCache called");let n=st.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)})}acquireTokenNative(e,t,n){return C(this,null,function*(){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw $(jn);return new $n(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)})}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!Pn.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case ft.NONE:case ft.CONSENT:case ft.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){let t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new qg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new zg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new Vg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ve.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new Uu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new jg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Qg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ve.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?mr():R.EMPTY_STRING}loginRedirect(e){return C(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect(U({correlationId:t},e||Uy))})}loginPopup(e){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(U({correlationId:t},e||Uy))}acquireTokenSilent(e){return C(this,null,function*(){let t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(g.AcquireTokenSilent,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Xg(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);let o=e.account||this.getActiveAccount();if(!o)throw $(_u);n.add({accountType:jo(o)});let i={clientId:this.config.auth.clientId,authority:e.authority||R.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},a=JSON.stringify(i),s=this.activeSilentTokenRequests.get(a);if(typeof s>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);let c=Y(this.acquireTokenSilentAsync.bind(this),g.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)(ie(U({},e),{correlationId:t}),o).then(l=>(this.activeSilentTokenRequests.delete(a),n.end({success:!0,fromCache:l.fromCache,isNativeBroker:l.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:l.requestId,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length}),l)).catch(l=>{throw this.activeSilentTokenRequests.delete(a),n.end({success:!1},l),l});return this.activeSilentTokenRequests.set(a,c),ie(U({},yield c),{state:e.state})}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discard(),ie(U({},yield s),{state:e.state})})}acquireTokenSilentAsync(e,t){return C(this,null,function*(){let n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(g.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_START,ee.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);let o=yield Y(dw,g.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||Wr.Default;return this.acquireTokenSilentNoIframe(o,i).catch(s=>C(this,null,function*(){if(YM(s,i))if(this.activeIframeRequest)if(i!==Wr.Skip){let[l,u]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${u}`,o.correlationId);let d=this.performanceClient.startMeasurement(g.AwaitConcurrentIframe,o.correlationId);d.add({awaitIframeCorrelationId:u});let h=yield l;if(d.end({success:h}),h)return this.logger.verbose(`Parallel iframe request with correlationId: ${u} succeeded. Retrying cache and/or RT redemption`,o.correlationId),this.acquireTokenSilentNoIframe(o,i);throw this.logger.info(`Iframe request with correlationId: ${u} failed. Interaction is required.`),s}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),Y(this.acquireTokenBySilentIframe.bind(this),g.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o);else{let l;return this.activeIframeRequest=[new Promise(u=>{l=u}),o.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),Y(this.acquireTokenBySilentIframe.bind(this),g.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o).then(u=>(l(!0),u)).catch(u=>{throw l(!1),u}).finally(()=>{this.activeIframeRequest=void 0})}else throw s})).then(s=>(this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_SUCCESS,ee.Silent,s),e.correlationId&&this.performanceClient.addFields({fromCache:s.fromCache,isNativeBroker:s.fromNativeBroker,requestId:s.requestId},e.correlationId),s)).catch(s=>{throw this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_FAILURE,ee.Silent,null,s),s}).finally(()=>{document.removeEventListener("visibilitychange",n)})})}acquireTokenSilentNoIframe(e,t){return C(this,null,function*(){return Pn.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,Ve.acquireTokenSilent_silentFlow).catch(n=>C(this,null,function*(){throw n instanceof Wn&&Ba(n)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,x(Wt.tokenRefreshRequired)):n}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),Y(this.acquireTokenFromCache.bind(this),g.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===Wr.AccessToken)throw n;return this.eventHandler.emitEvent(te.ACQUIRE_TOKEN_NETWORK_START,ee.Silent,e),Y(this.acquireTokenByRefreshToken.bind(this),g.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))})}};function YM(r,e){let t=!(r instanceof Cr&&r.subError!==Di.badToken),n=r.errorCode===xt.INVALID_GRANT_ERROR||r.errorCode===Wt.tokenRefreshRequired,o=t&&n||r.errorCode===Di.noTokensFound||r.errorCode===Di.refreshTokenExpired,i=MR.includes(e);return o&&i}function Sw(r,e){return C(this,null,function*(){let t=new Ug(r);return yield t.initialize(),Fu.createController(t,e)})}var Tf=class r{static createPublicClientApplication(e){return C(this,null,function*(){let t=yield Sw(e);return new r(e,t)})}constructor(e,t){this.controller=t||new Fu(new Ug(e))}initialize(e){return C(this,null,function*(){return this.controller.initialize(e)})}acquireTokenPopup(e){return C(this,null,function*(){return this.controller.acquireTokenPopup(e)})}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e){return this.controller.addEventCallback(e)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}hydrateCache(e,t){return C(this,null,function*(){return this.controller.hydrateCache(e,t)})}clearCache(e){return this.controller.clearCache(e)}};var yf=class{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case te.LOGIN_START:return Mt.Login;case te.SSO_SILENT_START:return Mt.SsoSilent;case te.ACQUIRE_TOKEN_START:if(e.interactionType===ee.Redirect||e.interactionType===ee.Popup)return Mt.AcquireToken;break;case te.HANDLE_REDIRECT_START:return Mt.HandleRedirect;case te.LOGOUT_START:return Mt.Logout;case te.SSO_SILENT_SUCCESS:case te.SSO_SILENT_FAILURE:if(t&&t!==Mt.SsoSilent)break;return Mt.None;case te.LOGOUT_END:if(t&&t!==Mt.Logout)break;return Mt.None;case te.HANDLE_REDIRECT_END:if(t&&t!==Mt.HandleRedirect)break;return Mt.None;case te.LOGIN_SUCCESS:case te.LOGIN_FAILURE:case te.ACQUIRE_TOKEN_SUCCESS:case te.ACQUIRE_TOKEN_FAILURE:case te.RESTORE_FROM_BFCACHE:if(e.interactionType===ee.Redirect||e.interactionType===ee.Popup){if(t&&t!==Mt.Login&&t!==Mt.AcquireToken)break;return Mt.None}break}return null}};var Aw="@azure/msal-angular",jy="3.0.24",Sf=new Mo("MSAL_INSTANCE"),Yu=new Mo("MSAL_GUARD_CONFIG"),Jg=new Mo("MSAL_INTERCEPTOR_CONFIG"),HM=new Mo("MSAL_BROADCAST_CONFIG"),To=(()=>{class r{constructor(t,n){this.instance=t,this.location=n;let o=this.location.path(!0).split("#").pop();o&&(this.redirectHash=`#${o}`),this.instance.initializeWrapperLibrary(Yy.Angular,jy)}initialize(){return Gn(this.instance.initialize())}acquireTokenPopup(t){return Gn(this.instance.acquireTokenPopup(t))}acquireTokenRedirect(t){return Gn(this.instance.acquireTokenRedirect(t))}acquireTokenSilent(t){return Gn(this.instance.acquireTokenSilent(t))}handleRedirectObservable(t){return Gn(this.instance.initialize().then(()=>this.instance.handleRedirectPromise(t||this.redirectHash)))}loginPopup(t){return Gn(this.instance.loginPopup(t))}loginRedirect(t){return Gn(this.instance.loginRedirect(t))}logout(t){return Gn(this.instance.logout(t))}logoutRedirect(t){return Gn(this.instance.logoutRedirect(t))}logoutPopup(t){return Gn(this.instance.logoutPopup(t))}ssoSilent(t){return Gn(this.instance.ssoSilent(t))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(Aw,jy)),this.logger}setLogger(t){this.logger=t.clone(Aw,jy),this.instance.setLogger(t)}}return r.\u0275fac=function(t){return new(t||r)(Re(Sf),Re(_m))},r.\u0275prov=dt({token:r,factory:r.\u0275fac}),r})(),Ga=(()=>{class r{constructor(t,n,o){this.msalInstance=t,this.authService=n,this.msalBroadcastConfig=o,this.msalBroadcastConfig&&this.msalBroadcastConfig.eventsToReplay>0?(this.authService.getLogger().verbose(`BroadcastService - eventsToReplay set on BroadcastConfig, replaying the last ${this.msalBroadcastConfig.eventsToReplay} events`),this._msalSubject=new um(this.msalBroadcastConfig.eventsToReplay)):this._msalSubject=new lm,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new xI(Mt.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(i=>{this._msalSubject.next(i);let a=yf.getInteractionStatusFromEvent(i,this._inProgress.value);a!==null&&(this.authService.getLogger().verbose(`BroadcastService - ${i.eventType} results in setting inProgress from ${this._inProgress.value} to ${a}`),this._inProgress.next(a))})}}return r.\u0275fac=function(t){return new(t||r)(Re(Sf),Re(To),Re(HM,8))},r.\u0275prov=dt({token:r,factory:r.\u0275fac}),r})(),Af=(()=>{class r{constructor(t,n,o,i,a){this.msalGuardConfig=t,this.msalBroadcastService=n,this.authService=o,this.location=i,this.router=a,this.msalBroadcastService.inProgress$.subscribe()}parseUrl(t){return this.router.parseUrl(t)}getDestinationUrl(t){this.authService.getLogger().verbose("Guard - getting destination url");let n=document.getElementsByTagName("base"),o=this.location.normalize(n.length?n[0].href:window.location.origin),i=this.location.prepareExternalUrl(t);return i.startsWith("#")?(this.authService.getLogger().verbose("Guard - destination by hash routing"),`${o}/${i}`):`${o}${t}`}loginInteractively(t){let n=typeof this.msalGuardConfig.authRequest=="function"?this.msalGuardConfig.authRequest(this.authService,t):U({},this.msalGuardConfig.authRequest);if(this.msalGuardConfig.interactionType===ee.Popup)return this.authService.getLogger().verbose("Guard - logging in by popup"),this.authService.loginPopup(n).pipe(Vt(i=>(this.authService.getLogger().verbose("Guard - login by popup successful, can activate, setting active account"),this.authService.instance.setActiveAccount(i.account),!0)));this.authService.getLogger().verbose("Guard - logging in by redirect");let o=this.getDestinationUrl(t.url);return this.authService.loginRedirect(U({redirectStartPage:o},n)).pipe(Vt(()=>!1))}activateHelper(t){if(this.msalGuardConfig.interactionType!==ee.Popup&&this.msalGuardConfig.interactionType!==ee.Redirect)throw new xc("invalid_interaction_type","Invalid interaction type provided to MSAL Guard. InteractionType.Popup or InteractionType.Redirect must be provided in the MsalGuardConfiguration");if(this.authService.getLogger().verbose("MSAL Guard activated"),typeof window<"u"){if(Ie.hashContainsKnownProperties(window.location.hash)&&kg.isInIframe()&&!this.authService.instance.getConfiguration().system.allowRedirectInIframe)return this.authService.getLogger().warning("Guard - redirectUri set to page with MSAL Guard. It is recommended to not set redirectUri to a page that requires authentication."),dr(!1)}else return this.authService.getLogger().info("Guard - window is undefined, MSAL does not support server-side token acquisition"),dr(!0);this.msalGuardConfig.loginFailedRoute&&(this.loginFailedRoute=this.parseUrl(this.msalGuardConfig.loginFailedRoute));let n=this.location.path(!0);return this.authService.initialize().pipe(dh(()=>this.authService.handleRedirectObservable()),dh(()=>{if(!this.authService.instance.getAllAccounts().length)return t?(this.authService.getLogger().verbose("Guard - no accounts retrieved, log in required to activate"),this.loginInteractively(t)):(this.authService.getLogger().verbose("Guard - no accounts retrieved, no state, cannot load"),dr(!1));if(this.authService.getLogger().verbose("Guard - at least 1 account exists, can activate or load"),t){let o=this.includesCode(t.url),i=!!t.root&&!!t.root.fragment&&this.includesCode(`#${t.root.fragment}`),a=this.location.prepareExternalUrl(t.url).indexOf("#")===0;if(o&&(i||a))return this.authService.getLogger().info("Guard - Hash contains known code response, stopping navigation."),n.indexOf("#")>-1?dr(this.parseUrl(this.location.path())):dr(this.parseUrl(""))}return dr(!0)}),fa(o=>(this.authService.getLogger().error("Guard - error while logging in, unable to activate"),this.authService.getLogger().errorPii(`Guard - error: ${o.message}`),this.loginFailedRoute&&t?(this.authService.getLogger().verbose("Guard - loginFailedRoute set, redirecting"),dr(this.loginFailedRoute)):dr(!1))))}includesCode(t){return t.lastIndexOf("/code")>-1&&t.lastIndexOf("/code")===t.length-5||t.indexOf("#code=")>-1||t.indexOf("&code=")>-1}canActivate(t,n){return this.authService.getLogger().verbose("Guard - canActivate"),this.activateHelper(n)}canActivateChild(t,n){return this.authService.getLogger().verbose("Guard - canActivateChild"),this.activateHelper(n)}canMatch(){return this.authService.getLogger().verbose("Guard - canLoad"),this.activateHelper()}}return r.\u0275fac=function(t){return new(t||r)(Re(Yu),Re(Ga),Re(To),Re(_m),Re(Kl))},r.\u0275prov=dt({token:r,factory:r.\u0275fac}),r})(),Iw=(()=>{class r{constructor(t,n,o,i,a){this.msalInterceptorConfig=t,this.authService=n,this.location=o,this.msalBroadcastService=i,this._document=a}intercept(t,n){if(this.msalInterceptorConfig.interactionType!==ee.Popup&&this.msalInterceptorConfig.interactionType!==ee.Redirect)throw new xc("invalid_interaction_type","Invalid interaction type provided to MSAL Interceptor. InteractionType.Popup, InteractionType.Redirect must be provided in the msalInterceptorConfiguration");this.authService.getLogger().verbose("MSAL Interceptor activated");let o=this.getScopesForEndpoint(t.url,t.method);if(!o||o.length===0)return this.authService.getLogger().verbose("Interceptor - no scopes for endpoint"),n.handle(t);let i;this.authService.instance.getActiveAccount()?(this.authService.getLogger().verbose("Interceptor - active account selected"),i=this.authService.instance.getActiveAccount()):(this.authService.getLogger().verbose("Interceptor - no active account, fallback to first account"),i=this.authService.instance.getAllAccounts()[0]);let a=typeof this.msalInterceptorConfig.authRequest=="function"?this.msalInterceptorConfig.authRequest(this.authService,t,{account:i}):ie(U({},this.msalInterceptorConfig.authRequest),{account:i});return this.authService.getLogger().info(`Interceptor - ${o.length} scopes found for endpoint`),this.authService.getLogger().infoPii(`Interceptor - [${o}] scopes found for ${t.url}`),this.acquireToken(a,o,i).pipe(gi(s=>{this.authService.getLogger().verbose("Interceptor - setting authorization headers");let c=t.headers.set("Authorization",`Bearer ${s.accessToken}`),l=t.clone({headers:c});return n.handle(l)}))}acquireToken(t,n,o){return this.authService.acquireTokenSilent(ie(U({},t),{scopes:n,account:o})).pipe(fa(()=>(this.authService.getLogger().error("Interceptor - acquireTokenSilent rejected with error. Invoking interaction to resolve."),this.msalBroadcastService.inProgress$.pipe(Fl(1),gi(i=>i===Mt.None?this.acquireTokenInteractively(t,n):this.msalBroadcastService.inProgress$.pipe(In(a=>a===Mt.None),Fl(1),gi(()=>this.acquireToken(t,n,o))))))),gi(i=>i.accessToken?dr(i):(this.authService.getLogger().error("Interceptor - acquireTokenSilent resolved with null access token. Known issue with B2C tenants, invoking interaction to resolve."),this.msalBroadcastService.inProgress$.pipe(In(a=>a===Mt.None),Fl(1),gi(()=>this.acquireTokenInteractively(t,n))))))}acquireTokenInteractively(t,n){if(this.msalInterceptorConfig.interactionType===ee.Popup)return this.authService.getLogger().verbose("Interceptor - error acquiring token silently, acquiring by popup"),this.authService.acquireTokenPopup(ie(U({},t),{scopes:n}));this.authService.getLogger().verbose("Interceptor - error acquiring token silently, acquiring by redirect");let o=window.location.href;return this.authService.acquireTokenRedirect(ie(U({},t),{scopes:n,redirectStartPage:o})),dm}getScopesForEndpoint(t,n){this.authService.getLogger().verbose("Interceptor - getting scopes for endpoint");let o=this.location.normalize(t),i=Array.from(this.msalInterceptorConfig.protectedResourceMap.keys()),a=this.matchResourcesToEndpoint(i,o);return a.length>0?this.matchScopesToEndpoint(this.msalInterceptorConfig.protectedResourceMap,a,n):null}matchResourcesToEndpoint(t,n){let o=[];return t.forEach(i=>{let a=this.location.normalize(i),s=this.getAbsoluteUrl(a),c=new URL(s),l=this.getAbsoluteUrl(n),u=new URL(l);this.checkUrlComponents(c,u)&&o.push(i)}),o}checkUrlComponents(t,n){let o=["protocol","host","pathname","search","hash"];for(let i of o)if(t[i]){let a=decodeURIComponent(t[i]);if(!Et.matchPattern(a,n[i]))return!1}return!0}getAbsoluteUrl(t){let n=this._document.createElement("a");return n.href=t,n.href}matchScopesToEndpoint(t,n,o){let i=[];return n.forEach(a=>{let s=[],c=t.get(a);if(c===null){i.push(null);return}c.forEach(l=>{if(typeof l=="string")s.push(l);else{let u=o.toLowerCase();l.httpMethod.toLowerCase()===u&&(l.scopes===null?i.push(null):l.scopes.forEach(h=>{s.push(h)}))}}),s.length>0&&i.push(s)}),i.length>0?(i.length>1&&this.authService.getLogger().warning("Interceptor - More than 1 matching scopes for endpoint found."),i[0]):null}}return r.\u0275fac=function(t){return new(t||r)(Re(Jg),Re(To),Re(_m),Re(Ga),Re(gm))},r.\u0275prov=dt({token:r,factory:r.\u0275fac}),r})(),Nw=(()=>{class r{constructor(t){this.authService=t}ngOnInit(){this.authService.getLogger().verbose("MsalRedirectComponent activated"),this.authService.handleRedirectObservable().subscribe()}}return r.\u0275fac=function(t){return new(t||r)(hr(To))},r.\u0275cmp=Nr({type:r,selectors:[["app-redirect"]],decls:0,vars:0,template:function(t,n){},encapsulation:2}),r})(),Rw=(()=>{class r{static forRoot(t,n,o){return{ngModule:r,providers:[{provide:Sf,useValue:t},{provide:Yu,useValue:n},{provide:Jg,useValue:o},To]}}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=rn({type:r}),r.\u0275inj=tn({providers:[Af,Ga],imports:[Bs]}),r})();var Nf="PERFORM_ACTION",BM="REFRESH",xw="RESET",Mw="ROLLBACK",Lw="COMMIT",Uw="SWEEP",Fw="TOGGLE_ACTION",KM="SET_ACTIONS_ACTIVE",Yw="JUMP_TO_STATE",Hw="JUMP_TO_ACTION",cC="IMPORT_STATE",Bw="LOCK_CHANGES",Kw="PAUSE_RECORDING",Hu=class{constructor(e,t){if(this.action=e,this.timestamp=t,this.type=Nf,typeof e.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}},Qy=class{constructor(){this.type=BM}},Xy=class{constructor(e){this.timestamp=e,this.type=xw}},Jy=class{constructor(e){this.timestamp=e,this.type=Mw}},Zy=class{constructor(e){this.timestamp=e,this.type=Lw}},eC=class{constructor(){this.type=Uw}},tC=class{constructor(e){this.id=e,this.type=Fw}};var rC=class{constructor(e){this.index=e,this.type=Yw}},nC=class{constructor(e){this.actionId=e,this.type=Hw}},oC=class{constructor(e){this.nextLiftedState=e,this.type=cC}},iC=class{constructor(e){this.status=e,this.type=Bw}},aC=class{constructor(e){this.status=e,this.type=Kw}};var r_=new Mo("@ngrx/store-devtools Options"),ww=new Mo("@ngrx/store-devtools Initial Config");function Gw(){return null}var GM="NgRx Store DevTools";function qM(r){let e={maxAge:!1,monitor:Gw,actionSanitizer:void 0,stateSanitizer:void 0,name:GM,serialize:!1,logOnly:!1,autoPause:!1,trace:!1,traceLimit:75,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0},connectInZone:!1},t=typeof r=="function"?r():r,n=t.logOnly?{pause:!0,export:!0,test:!0}:!1,o=t.features||n||e.features;o.import===!0&&(o.import="custom");let i=Object.assign({},e,{features:o},t);if(i.maxAge&&i.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${i.maxAge}`);return i}function bw(r,e){return r.filter(t=>e.indexOf(t)<0)}function qw(r){let{computedStates:e,currentStateIndex:t}=r;if(t>=e.length){let{state:o}=e[e.length-1];return o}let{state:n}=e[t];return n}function If(r){return new Hu(r,+Date.now())}function zM(r,e){return Object.keys(e).reduce((t,n)=>{let o=Number(n);return t[o]=zw(r,e[o],o),t},{})}function zw(r,e,t){return ie(U({},e),{action:r(e.action,t)})}function VM(r,e){return e.map((t,n)=>({state:Vw(r,t.state,n),error:t.error}))}function Vw(r,e,t){return r(e,t)}function jw(r){return r.predicate||r.actionsSafelist||r.actionsBlocklist}function jM(r,e,t,n){let o=[],i={},a=[];return r.stagedActionIds.forEach((s,c)=>{let l=r.actionsById[s];l&&(c&&lC(r.computedStates[c],l,e,t,n)||(i[s]=l,o.push(s),a.push(r.computedStates[c])))}),ie(U({},r),{stagedActionIds:o,actionsById:i,computedStates:a})}function lC(r,e,t,n,o){let i=t&&!t(r,e.action),a=n&&!e.action.type.match(n.map(c=>Dw(c)).join("|")),s=o&&e.action.type.match(o.map(c=>Dw(c)).join("|"));return i||a||s}function Dw(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ww(r){return{ngZone:r?qI(fm):null,connectInZone:r}}var n_=(()=>{class r extends Am{static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=VI(r)))(o||r)}})()}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac})}}return r})(),Zg={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},sC=new Mo("@ngrx/store-devtools Redux Devtools Extension"),$w=(()=>{class r{constructor(t,n,o){this.config=n,this.dispatcher=o,this.zoneConfig=Ww(this.config.connectInZone),this.devtoolsExtension=t,this.createActionStreams()}notify(t,n){if(this.devtoolsExtension)if(t.type===Nf){if(n.isLocked||n.isPaused)return;let o=qw(n);if(jw(this.config)&&lC(o,t,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;let i=this.config.stateSanitizer?Vw(this.config.stateSanitizer,o,n.currentStateIndex):o,a=this.config.actionSanitizer?zw(this.config.actionSanitizer,t,n.nextActionId):t;this.sendToReduxDevtools(()=>this.extensionConnection.send(a,i))}else{let o=ie(U({},n),{stagedActionIds:n.stagedActionIds,actionsById:this.config.actionSanitizer?zM(this.config.actionSanitizer,n.actionsById):n.actionsById,computedStates:this.config.stateSanitizer?VM(this.config.stateSanitizer,n.computedStates):n.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,o,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new YE(t=>{let n=this.zoneConfig.connectInZone?this.zoneConfig.ngZone.runOutsideAngular(()=>this.devtoolsExtension.connect(this.getExtensionConfig(this.config))):this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=n,n.init(),n.subscribe(o=>t.next(o)),n.unsubscribe}):dm}createActionStreams(){let t=this.createChangesObservable().pipe(HI()),n=t.pipe(In(l=>l.type===Zg.START)),o=t.pipe(In(l=>l.type===Zg.STOP)),i=t.pipe(In(l=>l.type===Zg.DISPATCH),Vt(l=>this.unwrapAction(l.payload)),dh(l=>l.type===cC?this.dispatcher.pipe(In(u=>u.type===ZE),UI(1e3),FI(1e3),Vt(()=>l),fa(()=>dr(l)),Fl(1)):dr(l))),s=t.pipe(In(l=>l.type===Zg.ACTION),Vt(l=>this.unwrapAction(l.payload))).pipe(Fs(o)),c=i.pipe(Fs(o));this.start$=n.pipe(Fs(o)),this.actions$=this.start$.pipe(gi(()=>s)),this.liftedActions$=this.start$.pipe(gi(()=>c))}unwrapAction(t){return typeof t=="string"?(0,eval)(`(${t})`):t}getExtensionConfig(t){let n={name:t.name,features:t.features,serialize:t.serialize,autoPause:t.autoPause??!1,trace:t.trace??!1,traceLimit:t.traceLimit??75};return t.maxAge!==!1&&(n.maxAge=t.maxAge),n}sendToReduxDevtools(t){try{t()}catch(n){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",n)}}static{this.\u0275fac=function(n){return new(n||r)(Re(sC),Re(r_),Re(n_))}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac})}}return r})(),t_={type:JE},WM="@ngrx/store-devtools/recompute",$M={type:WM};function Qw(r,e,t,n,o){if(n)return{state:t,error:"Interrupted by an error up the chain"};let i=t,a;try{i=r(t,e)}catch(s){a=s.toString(),o.handleError(s)}return{state:i,error:a}}function e_(r,e,t,n,o,i,a,s,c){if(e>=r.length&&r.length===i.length)return r;let l=r.slice(0,e),u=i.length-(c?1:0);for(let d=e;d<u;d++){let h=i[d],f=o[h].action,p=l[d-1],m=p?p.state:n,_=p?p.error:void 0,E=a.indexOf(h)>-1?p:Qw(t,f,m,_,s);l.push(E)}return c&&l.push(r[r.length-1]),l}function QM(r,e){return{monitorState:e(void 0,{}),nextActionId:1,actionsById:{0:If(t_)},stagedActionIds:[0],skippedActionIds:[],committedState:r,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function XM(r,e,t,n,o={}){return i=>(a,s)=>{let{monitorState:c,actionsById:l,nextActionId:u,stagedActionIds:d,skippedActionIds:h,committedState:f,currentStateIndex:p,computedStates:m,isLocked:_,isPaused:T}=a||e;a||(l=Object.create(l));function E(w){let O=w,S=d.slice(1,O+1);for(let K=0;K<S.length;K++)if(m[K+1].error){O=K,S=d.slice(1,O+1);break}else delete l[S[K]];h=h.filter(K=>S.indexOf(K)===-1),d=[0,...d.slice(O+1)],f=m[O].state,m=m.slice(O),p=p>O?p-O:0}function y(){l={0:If(t_)},u=1,d=[0],h=[],f=m[p].state,p=0,m=[]}let A=0;switch(s.type){case Bw:{_=s.status,A=1/0;break}case Kw:{T=s.status,T?(d=[...d,u],l[u]=new Hu({type:"@ngrx/devtools/pause"},+Date.now()),u++,A=d.length-1,m=m.concat(m[m.length-1]),p===d.length-2&&p++,A=1/0):y();break}case xw:{l={0:If(t_)},u=1,d=[0],h=[],f=r,p=0,m=[];break}case Lw:{y();break}case Mw:{l={0:If(t_)},u=1,d=[0],h=[],p=0,m=[];break}case Fw:{let{id:w}=s;h.indexOf(w)===-1?h=[w,...h]:h=h.filter(S=>S!==w),A=d.indexOf(w);break}case KM:{let{start:w,end:O,active:S}=s,K=[];for(let ne=w;ne<O;ne++)K.push(ne);S?h=bw(h,K):h=[...h,...K],A=d.indexOf(w);break}case Yw:{p=s.index,A=1/0;break}case Hw:{let w=d.indexOf(s.actionId);w!==-1&&(p=w),A=1/0;break}case Uw:{d=bw(d,h),h=[],p=Math.min(p,d.length-1);break}case Nf:{if(_)return a||e;if(T||a&&lC(a.computedStates[p],s,o.predicate,o.actionsSafelist,o.actionsBlocklist)){let O=m[m.length-1];m=[...m.slice(0,-1),Qw(i,s.action,O.state,O.error,t)],A=1/0;break}o.maxAge&&d.length===o.maxAge&&E(1),p===d.length-1&&p++;let w=u++;l[w]=s,d=[...d,w],A=d.length-1;break}case cC:{({monitorState:c,actionsById:l,nextActionId:u,stagedActionIds:d,skippedActionIds:h,committedState:f,currentStateIndex:p,computedStates:m,isLocked:_,isPaused:T}=s.nextLiftedState);break}case JE:{A=0,o.maxAge&&d.length>o.maxAge&&(m=e_(m,A,i,f,l,d,h,t,T),E(d.length-o.maxAge),A=1/0);break}case ZE:{if(m.filter(O=>O.error).length>0)A=0,o.maxAge&&d.length>o.maxAge&&(m=e_(m,A,i,f,l,d,h,t,T),E(d.length-o.maxAge),A=1/0);else{if(!T&&!_){p===d.length-1&&p++;let O=u++;l[O]=new Hu(s,+Date.now()),d=[...d,O],A=d.length-1,m=e_(m,A,i,f,l,d,h,t,T)}m=m.map(O=>ie(U({},O),{state:i(O.state,$M)})),p=d.length-1,o.maxAge&&d.length>o.maxAge&&E(d.length-o.maxAge),A=1/0}break}default:{A=1/0;break}}return m=e_(m,A,i,f,l,d,h,t,T),c=n(c,s),{monitorState:c,actionsById:l,nextActionId:u,stagedActionIds:d,skippedActionIds:h,committedState:f,currentStateIndex:p,computedStates:m,isLocked:_,isPaused:T}}}var Pw=(()=>{class r{constructor(t,n,o,i,a,s,c,l){let u=QM(c,l.monitor),d=XM(c,u,s,l.monitor,l),h=BE(BE(n.asObservable().pipe(BI(1)),i.actions$).pipe(Vt(If)),t,i.liftedActions$).pipe(LI(MI)),f=o.pipe(Vt(d)),p=Ww(l.connectInZone),m=new um(1);this.liftedStateSubscription=h.pipe(GI(f),Ow(p),YI(({state:E},[y,A])=>{let w=A(E,y);return y.type!==Nf&&jw(l)&&(w=jM(w,l.predicate,l.actionsSafelist,l.actionsBlocklist)),i.notify(y,w),{state:w,action:y}},{state:u,action:null})).subscribe(({state:E,action:y})=>{if(m.next(E),y.type===Nf){let A=y.action;a.next(A)}}),this.extensionStartSubscription=i.start$.pipe(Ow(p)).subscribe(()=>{this.refresh()});let _=m.asObservable(),T=_.pipe(Vt(qw));Object.defineProperty(T,"state",{value:hN(T,{manualCleanup:!0,requireSync:!0})}),this.dispatcher=t,this.liftedState=_,this.state=T}ngOnDestroy(){this.liftedStateSubscription.unsubscribe(),this.extensionStartSubscription.unsubscribe()}dispatch(t){this.dispatcher.next(t)}next(t){this.dispatcher.next(t)}error(t){}complete(){}performAction(t){this.dispatch(new Hu(t,+Date.now()))}refresh(){this.dispatch(new Qy)}reset(){this.dispatch(new Xy(+Date.now()))}rollback(){this.dispatch(new Jy(+Date.now()))}commit(){this.dispatch(new Zy(+Date.now()))}sweep(){this.dispatch(new eC)}toggleAction(t){this.dispatch(new tC(t))}jumpToAction(t){this.dispatch(new nC(t))}jumpToState(t){this.dispatch(new rC(t))}importState(t){this.dispatch(new oC(t))}lockChanges(t){this.dispatch(new iC(t))}pauseRecording(t){this.dispatch(new aC(t))}static{this.\u0275fac=function(n){return new(n||r)(Re(n_),Re(Am),Re(pN),Re($w),Re(gN),Re(Yl),Re(fN),Re(r_))}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac})}}return r})();function Ow({ngZone:r,connectInZone:e}){return t=>e?new YE(n=>t.subscribe({next:o=>r.run(()=>n.next(o)),error:o=>r.run(()=>n.error(o)),complete:()=>r.run(()=>n.complete())})):t}var JM=new Mo("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function ZM(r,e){return!!r||e.monitor!==Gw}function eL(){let r="__REDUX_DEVTOOLS_EXTENSION__";return typeof window=="object"&&typeof window[r]<"u"?window[r]:null}function tL(r={}){return zI([$w,n_,Pw,{provide:ww,useValue:r},{provide:JM,deps:[sC,r_],useFactory:ZM},{provide:sC,useFactory:eL},{provide:r_,deps:[ww],useFactory:qM},{provide:_N,deps:[Pw],useFactory:rL},{provide:mN,useExisting:n_}])}function rL(r){return r.state}var Xw=(()=>{class r{static instrument(t={}){return{ngModule:r,providers:[tL(t)]}}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=rn({type:r})}static{this.\u0275inj=tn({})}}return r})();var Jw=(()=>{class r{constructor(){this.config=tt,console.log("AboutComponent")}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=Nr({type:r,selectors:[["app-about"]],decls:19,vars:3,consts:[["appearance","outlined"],["matCardAvatar","","src","https://avatars3.githubusercontent.com/u/16348023?s=460&v=4"]],template:function(n,o){n&1&&(Ue(0,"mat-card",0)(1,"mat-card-header"),nn(2,"img",1),Ue(3,"mat-card-title"),ht(4,"Food App"),Ke(),Ue(5,"mat-card-subtitle"),ht(6,"By alexander.kastil@integrations.at"),Ke()(),Ue(7,"mat-card-content")(8,"div"),ht(9," A .NET Core Api and Angular UI implemented a Cloud Native App with step by step Installation Scripts used for ngDev, ngAdv, AZ-400, AZ-204 and MS-600 "),Ke(),Ue(10,"div")(11,"span"),ht(12,"Using config:"),Ke(),Ue(13,"pre"),ht(14,"        "),Ue(15,"p"),ht(16),fr(17,"json"),Ke(),ht(18,`
      `),Ke()()()()),n&2&&(vt(16),mm(pr(17,1,o.config)))},dependencies:[CN,wN,AN,NN,IN,SN,ZI],styles:["mat-card-subtitle[_ngcontent-%COMP%]{color:#fff}div[_ngcontent-%COMP%]{margin:10px 0}"]})}}return r})();var Zw=(()=>{class r{constructor(){this.entryPic="/assets/images/food.png"}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=Nr({type:r,selectors:[["app-home"]],decls:2,vars:1,consts:[[1,"mainDiv"],["matCardImage","","alt","login-screen",1,"entryImg",3,"src"]],template:function(n,o){n&1&&(Ue(0,"div",0),nn(1,"img",1),Ke()),n&2&&(vt(),Hl("src",o.entryPic,pm))},dependencies:[RN],styles:[".mainDiv[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:80vh}.entryImg[_ngcontent-%COMP%]{width:250px}mat-card-title[_ngcontent-%COMP%]{text-align:center;width:400px}mat-card-subtitle[_ngcontent-%COMP%]{text-align:center}mat-card-content[_ngcontent-%COMP%]{height:550px;background-color:#e6e6fa}mat-card-footer[_ngcontent-%COMP%]{margin-top:1rem}mat-card[_ngcontent-%COMP%]{margin-bottom:.5rem;width:50%}mat-card-footer[_ngcontent-%COMP%]{min-height:3.5rem;vertical-align:middle}.webfont[_ngcontent-%COMP%]{font-family:MuseoModerno,cursive;font-size:2rem}"]})}}return r})();var yW=tt.authEnabled?[Af]:[],oL=[{path:"",component:Zw},{path:"about",component:Jw},{path:"food",loadChildren:()=>import("./chunk-IZGJATWH.js").then(r=>r.FoodModule)}],iL=window!==window.parent&&!window.opener,eb=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=rn({type:r})}static{this.\u0275inj=tn({imports:[fh.forRoot(oL,{initialNavigation:iL==!1?"enabledNonBlocking":"disabled"}),fh]})}}return r})();var On=Sm({source:"[MSAL Auth]",events:{tryLoginSilent:Gs(),login:Gs(),loginSuccess:Ks(),logout:Gs(),logoutSuccess:Gs(),authError:Ks()}});var Rf="auth",aL={authResponse:null,authEnabled:tt.authEnabled},uC=Rm(aL,ga(On.loginSuccess,(r,e)=>ie(U({},r),{authResponse:e.authResponse,authenticated:!0})),ga(On.logoutSuccess,(r,e)=>ie(U({},r),{authResponse:null,authenticated:!1})));var o_=Nm(Rf),dC=_i(o_,r=>r.authEnabled),tb=_i(o_,r=>r.authResponse!==null),rb=_i(o_,r=>r.authResponse?.account.username),OW=_i(o_,r=>r.authResponse?.accessToken);var Mi=(()=>{class r{constructor(t,n){this.msalBC=t,this.store=n,this.handleLoginSuccess=o=>o.msalSubject$.pipe(Ys(i=>console.log("MSAL Event",i)),In(i=>i.eventType===te.LOGIN_SUCCESS||i.eventType===te.ACQUIRE_TOKEN_SUCCESS),Ys(i=>console.log("LOGIN_SUCCESS or ACQUIRE_TOKEN_SUCCESS",i))).subscribe(i=>{this.store.dispatch(On.loginSuccess({authResponse:i.payload})),console.log(`MSAL Event ${i.eventType}`,i.payload)}),this.handleLoginSuccess(this.msalBC)}getUser(){return this.store.select(rb)}getAuthEnabled(){return this.store.select(dC)}isAuthenticated(){return this.store.select(tb).pipe(hm(this.store.select(dC)),Vt(([t,n])=>n==!1||t))}logout(){this.store.dispatch(On.logout())}static{this.\u0275fac=function(n){return new(n||r)(Re(Ga),Re(Im))}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac})}}return r})(),sL=window.navigator.userAgent.indexOf("MSIE ")>-1||window.navigator.userAgent.indexOf("Trident/")>-1,cL=(r,e)=>{console.log(r,e)};function nb(){let r={auth:{clientId:tt.azure.appReg.clientId,authority:tt.azure.appReg.authority,redirectUri:"/"},cache:{cacheLocation:rt.LocalStorage,storeAuthStateInCookie:sL},system:{loggerOptions:{loggerCallback:cL,logLevel:Xe.Info,piiLoggingEnabled:!1}}};return new Tf(r)}function ob(){let r=tt.azure.appReg.scopes,e=new Map(r);return{interactionType:ee.Redirect,protectedResourceMap:e}}function ib(){return{interactionType:ee.Redirect,authRequest:{scopes:["user.read"]}}}var qa=Sm({source:"SideNav",events:{toggleSideNav:Gs(),setSideNavEnabled:Ks(),setSideNavVisible:Ks(),setSideNavPosition:Ks()}});var fC=Nm("menu"),ab=_i(fC,r=>r.sideNavVisible),sb=_i(fC,r=>r.sideNavEnabled),cb=_i(fC,r=>r.sideNavPosition);var i_=(()=>{class r{constructor(t,n){this.breakpointObserver=t,this.store=n,this.watchScreen=this.breakpointObserver.observe([rT.XSmall,rT.Small]).pipe(hm(this.getSideNavEnabled()),Ys(([o,i])=>{console.log(o)})),this.watchScreen.subscribe()}getSideNavEnabled(){return this.store.select(sb)}getSideNavVisible(){return this.store.select(ab)}getSideNavPosition(){return this.store.select(cb)}setSideNavEnabled(t){this.store.dispatch(qa.setSideNavEnabled({enabled:t}))}adjustSidenavToScreen(t){return t!="xs"}toggleMenuVisibility(){this.store.dispatch(qa.toggleSideNav())}static{this.\u0275fac=function(n){return new(n||r)(Re(yN),Re(Im))}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var ub=(()=>{class r{constructor(t,n){this.msalGuardConfig=t,this.authService=n,this.entryPic="/assets/images/food.png",this.isIframe=!1}ngOnInit(){this.isIframe=window!==window.parent&&!window.opener}login(){tt.authEnabled&&(this.msalGuardConfig.interactionType===ee.Popup?this.msalGuardConfig.authRequest?this.authService.loginPopup(U({},this.msalGuardConfig.authRequest)).subscribe(t=>{this.authService.instance.setActiveAccount(t.account)}):this.authService.loginPopup().subscribe(t=>{this.authService.instance.setActiveAccount(t.account)}):this.msalGuardConfig.authRequest?this.authService.loginRedirect(U({},this.msalGuardConfig.authRequest)):this.authService.loginRedirect())}static{this.\u0275fac=function(n){return new(n||r)(hr(Yu),hr(To))}}static{this.\u0275cmp=Nr({type:r,selectors:[["app-login"]],decls:6,vars:1,consts:[[1,"card"],[1,"title"],["alt","login-screen",1,"card-image",3,"src"],["mat-raised-button","","color","primary",3,"click"]],template:function(n,o){n&1&&(Ue(0,"div",0)(1,"div",1),ht(2,"Welcome to Food App"),Ke(),nn(3,"img",2),Ue(4,"button",3),Hs("click",function(){return o.login()}),ht(5,"Login"),Ke()()),n&2&&(vt(3),Hl("src",o.entryPic,pm))},dependencies:[wm],styles:[".card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;width:50vw;min-width:360px;border:1px dotted black;padding:1rem;background-color:#d3d3d3}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-family:MuseoModerno,cursive;font-size:2rem;min-height:3.5rem;padding-top:0 1.5rem}button[_ngcontent-%COMP%]{min-width:140px}@media screen and (max-width: 400px){.card[_ngcontent-%COMP%]{width:80vw;min-width:250px}.title[_ngcontent-%COMP%]{font-size:1rem}}"]})}}return r})();var fL=()=>({exact:!0});function pL(r,e){if(r&1&&(Ue(0,"div",4),ht(1),Ke()),r&2){let t=e.$implicit;Hl("routerLink","/"+t.url),Rr("routerLinkActiveOptions",WI(3,fL)),vt(),hh(" ",t.title," ")}}var pC=(()=>{class r{constructor(t,n){this.mf=t,this.http=n,this.menuItems=this.http.get("/assets/nav-items.json")}toggleMenu(){this.mf.toggleMenuVisibility()}static{this.\u0275fac=function(n){return new(n||r)(hr(i_),hr(eN))}}static{this.\u0275cmp=Nr({type:r,selectors:[["app-navbar"]],decls:7,vars:3,consts:[["color","primary"],[1,"menu",3,"click"],["color","accent",1,"clickable"],["routerLinkActive","navLink-active","class","navLink",3,"routerLink","routerLinkActiveOptions",4,"ngFor","ngForOf"],["routerLinkActive","navLink-active",1,"navLink",3,"routerLink","routerLinkActiveOptions"]],template:function(n,o){n&1&&(Ue(0,"mat-toolbar",0)(1,"mat-toolbar-row")(2,"div",1),Hs("click",function(){return o.toggleMenu()}),Ue(3,"mat-icon",2),ht(4,"menu"),Ke()(),fo(5,pL,2,4,"div",3),fr(6,"async"),Ke()()),n&2&&(vt(5),Rr("ngForOf",pr(6,1,o.menuItems)))},dependencies:[XI,bm,Pm,Dm,uN,dN,ma],styles:[".menu[_ngcontent-%COMP%]{padding-top:.6rem}mat-toolbar[_ngcontent-%COMP%]{margin-bottom:.8rem}mat-toolbar-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:.5rem;cursor:pointer}"]})}}return r})();var db=(()=>{class r{constructor(t){this.af=t,this.user=this.af.getUser()}static{this.\u0275fac=function(n){return new(n||r)(hr(Mi))}}static{this.\u0275cmp=Nr({type:r,selectors:[["app-current-user"]],decls:3,vars:3,template:function(n,o){n&1&&(Ue(0,"h5"),ht(1),fr(2,"async"),Ke()),n&2&&(vt(),mm(pr(2,1,o.user)))},dependencies:[ma]})}}return r})();function _L(r,e){if(r&1){let t=jE();zE(0),nn(1,"app-current-user"),Ue(2,"button",4),Hs("click",function(){KE(t);let o=pa();return GE(o.logout())}),Ue(3,"mat-icon"),ht(4,"logout"),Ke(),Ue(5,"span"),ht(6,"Logout"),Ke()(),VE()}}function vL(r,e){if(r&1&&(Ue(0,"mat-slide-toggle",7),ht(1,"Keep cart "),Ke()),r&2){let t=pa(2);Rr("formControl",t.fcSaveCart)}}function EL(r,e){if(r&1){let t=jE();zE(0),Ue(1,"h3"),ht(2),fr(3,"async"),Ke(),Ue(4,"h3"),ht(5),fr(6,"async"),fr(7,"toEuro"),Ke(),fo(8,vL,2,1,"mat-slide-toggle",5),Ue(9,"button",6),Hs("click",function(){KE(t);let o=pa();return GE(o.doCheckout())}),Ue(10,"mat-icon"),ht(11,"shopping_cart_checkout"),Ke(),Ue(12,"span"),ht(13,"Checkout"),Ke()(),VE()}if(r&2){let t=e.ngIf,n=pa();vt(2),hh("",pr(3,4,n.ct)," items in cart"),vt(3),hh("Sum Total: ",pr(7,8,pr(6,6,n.total)),""),vt(3),Rr("ngIf",n.persistCart),vt(),Rr("disabled",t.length===0)}}var mC=(()=>{class r{constructor(t,n,o){this.cart=t,this.router=n,this.auth=o,this.user=this.auth.getUser(),this.ct=this.cart.getItemsCount(),this.total=this.cart.getSumTotal(),this.persistToCart=this.cart.getPersist(),this.items=this.cart.getItems(),this.authEnabled=this.auth.getAuthEnabled(),this.persistCart=tt.features.persistCart,this.fcSaveCart=new WE,this.cartSetting=null,this.persistCart&&this.ensureStorageFeature()}ensureStorageFeature(){this.fcSaveCart=new WE(!0,{nonNullable:!0}),this.cartSetting=this.fcSaveCart.valueChanges.pipe(Vt(t=>{this.cart.togglePersist(t)})).subscribe()}ngonDestroy(){this.cartSetting&&this.cartSetting.unsubscribe()}logout(){this.auth.logout()}doCheckout(){this.router.navigate(["/food/checkout"])}static{this.\u0275fac=function(n){return new(n||r)(hr(MN),hr(Kl),hr(Mi))}}static{this.\u0275cmp=Nr({type:r,selectors:[["app-sidebar"]],decls:9,vars:6,consts:[["color","primary"],[1,"toolbar"],[1,"info"],[4,"ngIf"],["mat-raised-button","",3,"click"],["color","accent",3,"formControl",4,"ngIf"],["mat-raised-button","",3,"click","disabled"],["color","accent",3,"formControl"]],template:function(n,o){n&1&&(Ue(0,"mat-toolbar",0)(1,"mat-toolbar-row")(2,"span",1),ht(3,"Actions"),Ke()()(),Ue(4,"div",2),fo(5,_L,7,0,"ng-container",3),fr(6,"async"),fo(7,EL,14,10,"ng-container",3),fr(8,"async"),Ke()),n&2&&(vt(5),Rr("ngIf",pr(6,2,o.authEnabled)),vt(2),Rr("ngIf",pr(8,4,o.cart.getItems())))},dependencies:[vm,wm,bm,ON,Pm,Dm,iN,aN,db,ma,kN],styles:["button[_ngcontent-%COMP%]{width:100%;margin-bottom:.7rem}mat-toolbar[_ngcontent-%COMP%]{margin-bottom:0}.toolbar[_ngcontent-%COMP%]{margin:auto}span[_ngcontent-%COMP%]{margin-left:.5rem}div[_ngcontent-%COMP%]{font-size:.8rem}.mat-mdc-raised-button.mat-button-disabled.mat-button-disabled[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#9e9e9e}.info[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center}"]})}}return r})();function yL(r,e){r&1&&(Ue(0,"div",4),nn(1,"app-login"),Ke())}function CL(r,e){if(r&1&&(Ue(0,"div",5)(1,"div",6),nn(2,"app-navbar"),Ke(),Ue(3,"div",7)(4,"mat-sidenav-container")(5,"mat-sidenav",8,0),fr(7,"async"),nn(8,"app-sidebar"),Ke(),Ue(9,"mat-sidenav-content",9),nn(10,"router-outlet"),Ke()()()()),r&2){let t=pa();vt(5),Rr("opened",pr(7,3,t.sidenavVisible))("mode",t.sidenavMode),vt(4),Rr("ngStyle",t.getWorbenchStyle())}}function SL(r,e){r&1&&nn(0,"router-outlet")}function AL(r,e){if(r&1&&(Ue(0,"div",10),fo(1,SL,1,0,"router-outlet",11),Ke()),r&2){let t=pa();vt(),Rr("ngIf",!t.isIframe)}}var a_=(()=>{class r{constructor(t,n,o){this.af=t,this.mf=n,this.router=o,this.title=tt.title,this.sidenavMode="side",this.sidenavVisible=this.mf.getSideNavVisible(),this.isIframe=window!==window.parent&&!window.opener,this.authEnabled=tt.authEnabled,this.authenticated=this.af.isAuthenticated(),this.publicRoute=this.router.events.pipe(KI(!1),In(i=>i instanceof XE),Vt(i=>i instanceof XE&&i.url.includes("about")),Ys(i=>{console.log("publicRoute",i)})),this.destroy$=new lm,this.mf.getSideNavPosition().pipe(Fs(this.destroy$)).subscribe(i=>{this.sidenavMode=i})}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}getWorbenchStyle(){let t={};return this.mf.getSideNavVisible().pipe(Fs(this.destroy$)).subscribe(n=>{t=n?{"padding-left":"10px"}:{}}),t}static{this.\u0275fac=function(n){return new(n||r)(hr(Mi),hr(i_),hr(Kl))}}static{this.\u0275cmp=Nr({type:r,selectors:[["app-root"]],decls:7,vars:11,consts:[["sidenav",""],["class","loginsplash",4,"ngIf"],["class","maingrid",4,"ngIf"],["style","display: none",4,"ngIf"],[1,"loginsplash"],[1,"maingrid"],[1,"gdNavbar"],[1,"gdMainrow"],[3,"opened","mode"],[3,"ngStyle"],[2,"display","none"],[4,"ngIf"]],template:function(n,o){n&1&&(fo(0,yL,2,0,"div",1),fr(1,"async"),fr(2,"async"),fo(3,CL,11,5,"div",2),fr(4,"async"),fr(5,"async"),fo(6,AL,2,1,"div",3)),n&2&&(Rr("ngIf",pr(1,3,o.authenticated)===!1&&pr(2,5,o.publicRoute)===!1),vt(3),Rr("ngIf",pr(4,7,o.authenticated)===!0||pr(5,9,o.publicRoute)===!0),vt(3),Rr("ngIf",o.authEnabled))},dependencies:[vm,JI,lN,DN,PN,bN,ub,pC,mC,ma],styles:['.loginsplash[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.maingrid[_ngcontent-%COMP%]{display:grid;grid-template-rows:80px auto;grid-template-columns:auto;grid-template-areas:"navbar" "mainrow";height:100vh;width:100%}.gdNavbar[_ngcontent-%COMP%]{grid-area:navbar}.gdMainrow[_ngcontent-%COMP%]{grid-area:mainrow}mat-sidenav[_ngcontent-%COMP%]{min-width:180px}mat-sidenav-container[_ngcontent-%COMP%]{background-color:#fff;min-height:90vh}mat-sidenav-content[_ngcontent-%COMP%]{padding:0 1 0 1rem}']})}}return r})();var hb=(()=>{class r{constructor(){this.inProgress$=null,this.msalSubject$=dr({eventType:te.LOGIN_SUCCESS,interactionType:null,payload:{},timestamp:0,error:null})}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac})}}return r})();var fb=(()=>{class r{constructor(t,n){this.actions$=t,this.msal=n,this.req={scopes:["user.read"],account:this.msal.instance.getAllAccounts()[0]},this.tryLoginSilent$=eT(()=>this.actions$.pipe(tT(On.tryLoginSilent),HE(()=>this.msal.acquireTokenSilent(this.req).pipe(Vt(o=>On.loginSuccess({authResponse:o})),fa(o=>dr(On.authError({err:o}))))))),this.logout$=eT(()=>this.actions$.pipe(tT(On.logout),HE(()=>this.msal.logout().pipe(Vt(o=>On.logoutSuccess()),fa(o=>dr(On.authError({err:o})))))))}static{this.\u0275fac=function(n){return new(n||r)(Re(vN),Re(To))}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac})}}return r})();var IL=tt.authEnabled?[Bs,qs,ph.forFeature(Rf,uC),mh.forFeature([fb]),Rw]:[Bs,qs,ph.forFeature(Rf,uC),mh.forFeature([])],NL=tt.authEnabled?[Em(),Mi,{provide:tN,useClass:Iw,multi:!0},{provide:Sf,useFactory:nb},{provide:Yu,useFactory:ib},{provide:Jg,useFactory:ob},To,Af,Ga]:[Mi,{provide:Ga,useClass:hb}],s_=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=rn({type:r})}static{this.\u0275inj=tn({providers:NL,imports:[IL]})}}return r})();var br=void 0,mt=null,Bu="",gC="boolean",za="function",_C="number",Li="object",Qn="prototype",wf="__proto__",vC="string",Ui="undefined",bf="constructor",Df="Symbol",pb="_polyfill",c_="indexOf",l_="lastIndexOf",Fi="length",EC="done",u_="value",d_="name",Ku="slice",wt=Object,h_=wt[Qn],TC=String,ln=TC[Qn],yC=Math,CC=Array,yo=CC[Qn];function f_(r,e){var t=e;try{t=r()}catch{}return t}var RL=[vC,_C,gC,Ui,"symbol","bigint"];function Gu(r){return function(e){return typeof e===r}}function Lc(r){var e="[object "+r+"]";return function(t){return!!(t&&Uc(t)===e)}}function Uc(r){return h_.toString.call(r)}function be(r){return typeof r===Ui||r===Ui}function H(r){return r===mt||be(r)}function SC(r){return r===mt||!p_(r)}function p_(r){return!!r||r!==br}var AC=function(r){return r!==Li&&RL.indexOf(r)!==-1},ae=Gu(vC),ce=Gu(za);function bt(r){return!r&&H(r)?!1:!!r&&typeof r===Li}var de=CC.isArray,m_=Lc("Date"),Wo=Gu(_C),qu=Gu(gC),wL=Lc("RegExp"),bL=Lc("File"),DL=Lc("FormData"),PL=Lc("Blob"),OL=Lc("ArrayBuffer"),$o=Lc("Error");function Va(r){return!!r&&ce(r.then)}function Yi(r){return!(!r||f_(function(){return!(r&&0+r)},!r))}var Fc=wt.getOwnPropertyDescriptor;function Xt(r,e){return r&&h_.hasOwnProperty.call(r,e)}var un=wt.hasOwn||mb;function mb(r,e){return Xt(r,e)||!!Fc(r,e)}function ue(r,e,t){if(r&&bt(r)){for(var n in r)if(un(r,n)&&e.call(t||r,n,r[n])===-1)break}}function IC(r,e,t,n){var o={};return ue(r,function(i,a){o[i]=e?a:i,o[a]=t?a:i}),n(o)}function Jt(r){throw new Error(r)}function Dt(r){throw new TypeError(r)}function gb(r){var e=[];return ue(r,function(t,n){e.push([t,n])}),e}function _b(r){var e=[];return ue(r,function(t,n){e.push(n)}),e}var NC=wt.freeze,vb=function(r){return r},kL=function(r){return r[wf]||mt},Yc=wt.assign;function $r(r){return(!bt(r)||r===mt)&&Dt("objKeys called on non-object"),wt.keys(r)}function Qr(r){return NC&&ue(r,function(e,t){(de(t)||bt(t))&&NC(t)}),Co(r)}var Co=NC||vb,Eb=wt.seal||vb,zu=wt.getPrototypeOf||kL,xL=wt.entries||gb,lQ=wt.values||_b;function RC(r){return IC(r,1,0,Qr)}function wC(r){return IC(r,0,0,Qr)}function Tb(r){var e={};return ue(r,function(t,n){e[t]=n[1],e[n[0]]=n[1]}),Qr(e)}function bC(r){return Tb(r)}var g_=wC({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12});var Zt=TC;var yb="__tsUtils$gblCfg",DC;function PC(){var r;return typeof globalThis!==Ui&&(r=globalThis),!r&&typeof self!==Ui&&(r=self),!r&&typeof window!==Ui&&(r=window),!r&&typeof global!==Ui&&(r=global),r}function __(){if(!DC){var r=PC()||{};DC=r[yb]=r[yb]||{}}return DC}function G(r,e){var t=Bu;if($o(r))t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r.name+"'";else try{t=JSON.stringify(r,mt,e?Wo(e)?e:4:br)}catch(n){t=" - "+G(n,e)}return Uc(r)+": "+t}var OC=yo[Ku],Cb=function(r,e){Dt("'"+Zt(r)+"' not defined for "+G(e))},v_=function(r){return function(e){return e[r].apply(e,OC.call(arguments,1))}},Dr=function(r,e){var t=e&&e[r];return function(n){var o=n&&n[r]||t;if(o)return o.apply(n,OC.call(arguments,1));Cb(r,n)}},ja=function(r,e,t){var n=e&&e[r];return function(o){var i=o&&o[r]||n;if(i||t){var a=arguments;return(i||t).apply(o,i?OC.call(a,1):a)}Cb(r,o)}};function Sb(r){return function(e){return e[r]}}var DQ=yC.min,Ab=yC.max;var kC=Dr(Ku,ln);var Sr=Dr("substring",ln),Xn=ja("substr",ln,Ib);function Ib(r,e,t){return H(r)&&Dt("'polyStrSubstr called with invalid "+G(r)),t<0?Bu:(e=e||0,e<0&&(e=Ab(e+r[Fi],0)),be(t)?kC(r,e):kC(r,e,e+t))}function Vu(r,e){return Sr(r,0,e)}var xC;function ML(){if(!xC){var r=__();xC=r.gblSym=r.gblSym||{k:{},s:{}}}return xC}var Nb={};function E_(r){var e={description:Zt(r),toString:function(){return Df+"("+r+")"}};return e[pb]=!0,e}function Rb(r){var e=ML();if(!un(e,r)){var t=E_(r);e.k[r]=t,e.s[t]=Zt(r)}return e.k[r]}function wb(r){var e,t=g_[r];return t&&(e=Nb[t]=Nb[t]||E_(Df+"."+t)),e}var T_={e:"enumerable",c:"configurable",v:u_,w:"writable",g:"get",s:"set"};function LL(r){var e={};if(e[T_.c]=!0,e[T_.e]=!0,r.l){e.get=function(){return r.l.v};var t=Fc(r.l,"v");t&&t.set&&(e.set=function(n){r.l.v=n})}return ue(r,function(n,o){e[T_[n]]=be(o)?e[T_[n]]:o}),e}var er=wt.defineProperty,UL=wt.defineProperties;function ve(r,e,t){return er(r,e,LL(t))}var ct,MC=function(){ct=__(),MC=mt};function So(r){var e={};return MC&&MC(),e.b=ct.lzy,er(e,"v",{configurable:!0,get:function(){var t=r();return ct.lzy||(er(e,"v",{value:t}),e.b&&delete e.b),ct.lzy&&e.b!==ct.lzy&&(e.b=ct.lzy),t}}),e}function Qo(r,e){return So(function(){return f_(r,e)})}var bb="window",ju,Wu,y_,C_,S_,LC,UC,kn=function(r){return Qo(function(){return At(r)||br},br)},Pr=function(r){return(!ju||r===!1||ct&&ct.lzy&&!ju.b)&&(ju=Qo(PC,mt)),ju.v},At=function(r,e){var t=!ju||e===!1?Pr(e):ju.v;return t&&t[r]?t[r]:r===bb&&Wu?Wu.v:mt},$u=function(){return!!lt()},lt=function(){return(!y_||ct&&ct.lzy&&!y_.b)&&(y_=kn("document")),y_.v},Xo=function(){return!!tr()},tr=function(){return(!Wu||ct&&ct.lzy&&!Wu.b)&&(Wu=kn(bb)),Wu.v},A_=function(){return!!gr()},gr=function(){return(!C_||ct&&ct.lzy&&!C_.b)&&(C_=kn("navigator")),C_.v},I_=function(){return!!Pf()},Pf=function(){return(!S_||ct&&ct.lzy&&!S_.b)&&(S_=kn("history")),S_.v},FC=function(){return!UC&&(UC=Qo(function(){return!!(process&&(process.versions||{}).node)},!1)),UC.v},Of=function(){return!LC&&(LC=Qo(function(){return!!(self&&self instanceof WorkerGlobalScope)},!1)),LC.v};var Xr,N_,Db;function Pb(r){return Qo(function(){return Xr.v?Xr[r]:br},br)}var Ob=Gu("symbol");function YC(){return!!kf()}function kf(){var r=!Xr||ct&&ct.lzy&&!Xr.b;return r&&(Xr=kn(Df)),(!N_||r)&&(N_=Pb("for")),(!Db||r)&&(Db=Pb("keyFor")),Xr.v}function Hc(r,e){var t=g_[r];return(!Xr||ct.lzy&&!Xr.b)&&kf(),Xr.v?Xr.v[t||r]:e?br:wb(r)}function Bc(r,e){return(!Xr||ct.lzy&&!Xr.b)&&kf(),Xr.v?Xr.v(r):e?mt:E_(r)}function xf(r){return(!N_||ct.lzy&&!Xr.b)&&kf(),(N_.v||Rb)(r)}function Mf(r){return!!r&&ce(r.next)}function kb(r){return!SC(r)&&ce(r[Hc(3)])}var R_;function xb(r,e,t){if(r&&(Mf(r)||(!R_&&(R_=So(function(){return Hc(3)})),r=r[R_.v]?r[R_.v]():null),Mf(r))){var n=void 0,o=void 0;try{for(var i=0;!(o=r.next())[EC]&&e.call(t||r,o[u_],i,r)!==-1;)i++}catch(a){n={e:a},r.throw&&(o=null,r.throw(n))}finally{try{o&&!o[EC]&&r.return&&r.return(o)}finally{if(n)throw n.e}}}}var Hi=v_("apply");function Jo(r,e){return!be(e)&&r&&(de(e)?Hi(r.push,r,e):Mf(e)||kb(e)?xb(e,function(t){r.push(t)}):r.push(e)),r}function j(r,e,t){if(r)for(var n=r[Fi]>>>0,o=0;o<n&&!(o in r&&e.call(t||r,r[o],o,r)===-1);o++);}var ut=Dr(c_,yo),FL=Dr(l_,yo);var Wa=Dr("map",yo);var Or=Dr(Ku,yo);var Lf=v_("call");var w_=Dr("reduce",yo);var YL=wt.create,Uf=YL||HL;function HL(r){if(!r)return{};var e=typeof r;if(e!==Li&&e!==za)throw new TypeError("Prototype must be an Object or function: "+G(r));function t(){}return t[Qn]=r,new t}var HC;function BC(r,e){var t=wt.setPrototypeOf||function(n,o){!HC&&(HC=So(function(){var i;return i={},i[wf]=[],i instanceof Array})),HC.v?n[wf]=o:ue(o,function(i,a){return n[i]=a})};return t(r,e)}var BL=function(r,e,t){Lb(e,r),e=BC(e,t);function n(){this.constructor=e,Lb(this,r)}return e[Qn]=t===mt?Uf(t):(n[Qn]=t[Qn],new n),e},Mb=function(r,e){try{e&&(r[d_]=e)}catch{}},Lb=function(r,e){try{ve(r,d_,{v:e,c:!0,e:!1})}catch{}};function b_(r,e,t){var n=t||Error,o=n[Qn][d_],i=Error.captureStackTrace;return BL(r,function(){var a=this;try{Mb(n,r);var s=Hi(n,a,Or(arguments))||a;if(s!==a){var c=zu(a);c!==zu(s)&&BC(s,c)}return i&&i(s,a[bf]),e&&e(s,arguments),s}finally{Mb(n,o)}},n)}var KC;function GC(r){throw KC||(KC=b_("UnsupportedError")),new KC(r)}function rr(){return(Date.now||Ub)()}function Ub(){return new Date().getTime()}function qC(r){return function(t){return H(t)&&Dt("strTrim called ["+G(t)+"]"),t&&t.replace&&(t=t.replace(r,Bu)),t}}var Fb=qC(/^\s+|(?=\s)\s+$/g),Yb=qC(/^\s+/g),Hb=qC(/(?=\s)\s+$/g);var Lt=ja("trim",ln,Fb),KL=ja("trimStart",ln,Yb);var GL=ja("trimEnd",ln,Hb);var zC,VC,jC;function nr(r){if(!r||typeof r!==Li)return!1;jC||(jC=Xo()?tr():!0);var e=!1;if(r!==jC){VC||(zC=Function[Qn].toString,VC=Lf(zC,wt));try{var t=zu(r);e=!t,e||(Xt(t,bf)&&(t=t[bf]),e=t&&typeof t===za&&zC.call(t)===VC)}catch{}}return e}var qL=function(r){return r.value&&zb(r),!0},Bb=[VL,zb,WL,jL];function zL(r,e,t,n){var o;return j(r,function(i){if(i.k===e)return o=i,-1}),o||(o={k:e,v:e},r.push(o),n(o)),o.v}function WC(r,e,t,n){var o=t.handler,i=t.path?n?t.path.concat(n):t.path:[],a={handler:t.handler,src:t.src,path:i},s=typeof e,c=!1,l=!1;e&&s===Li?c=nr(e):l=e===mt||AC(s);var u={type:s,isPrim:l,isPlain:c,value:e,result:e,path:i,origin:t.src,copy:function(d,h){return WC(r,d,h?a:t,h)},copyTo:function(d,h){return Kb(r,d,h,a)}};return u.isPrim?o&&Lf(o,t,u)?u.result:e:zL(r,e,i,function(d){ve(u,"result",{g:function(){return d.v},s:function(p){d.v=p}});for(var h=0,f=o;!Lf(f||(h<Bb.length?Bb[h++]:qL),t,u);)f=mt})}function Kb(r,e,t,n){if(!H(t))for(var o in t)e[o]=WC(r,t[o],n,o);return e}function Gb(r,e,t){var n={handler:t,src:e,path:[]};return Kb([],r,e,n)}function qb(r,e){var t={handler:e,src:r};return WC([],r,t)}function VL(r){var e=r.value;if(de(e)){var t=r.result=[];return t.length=e.length,r.copyTo(t,e),!0}return!1}function jL(r){var e=r.value;return m_(e)?(r.result=new Date(e.getTime()),!0):!1}function WL(r){return r.type===za}function zb(r){var e=r.value;if(e&&r.isPlain){var t=r.result={};return r.copyTo(t,e),!0}return!1}function $L(r,e){return j(e,function(t){Gb(r,t)}),r}function D_(r,e,t,n,o,i,a){return $L(qb(r)||{},Or(arguments))}var $C=Sb(Fi);var P_;function dn(){return(!P_||!P_.b&&ct&&ct.lzy)&&(P_=kn("performance")),P_.v}var O_=ja("endsWith",ln,QL);function QL(r,e,t){ae(r)||Dt("'"+G(r)+"' is not a string");var n=ae(e)?e:Zt(e),o=n[Fi],i=r[Fi],a=!be(t)&&t<i?t:i;return Sr(r,a-o,a)===n}var Tt=Dr(c_,ln),XL=Dr(l_,ln);var k_="ref",QC="un"+k_,XC="hasRef",Vb="enabled";function jb(r,e,t){var n,o=!0,i=r?e(mt):mt,a,s=function(){return o=!1,i&&i[QC]&&i[QC](),a},c=function(){return o=!0,i&&i[k_]&&i[k_](),a},l=function(){return i&&i[XC]?i[XC]():o},u=function(){return i=e(i),o||s(),a},d=function(){i&&t(i),i=mt},h=function(f){!f&&i&&d(),f&&!i&&u()};return a=(n={cancel:d,refresh:u},n[XC]=l,n[k_]=c,n[QC]=s,n[Vb]=!1,n),er(a,Vb,{get:function(){return!!i},set:h}),{h:a,dn:function(){i=mt}}}function Wb(r,e,t,n){var o=de(t),i=o?t.length:0,a=(i>0?t[0]:o?br:t)||setTimeout,s=(i>1?t[1]:br)||clearTimeout,c=n[0];n[0]=function(){l.dn(),Hi(c,r,Or(arguments))};var l=jb(e,function(u){if(u){if(u.refresh)return u.refresh(),u;Hi(s,r,[u])}return Hi(a,r,n)},function(u){Hi(s,r,[u])});return l.h}function Ht(r,e){return Wb(this,!0,br,Or(arguments))}function JC(r,e){return Wb(this,!1,br,Or(arguments))}var x_;var U_="constructor",$a="prototype",F_="function",Y_="_dynInstFuncs",tS="_isDynProxy",Qu="_dynClass",r0="_dynCls$",rS="_dynInstChk",Ff=rS,Zb="_dfOpts",$b="_unknown_",eD="__proto__",M_="_dyn"+eD,Qb="__dynProto$Gbl",ZC="_dynInstProto",L_="useBaseInst",nS="setInstFuncs",iS=Object,Yf=iS.getPrototypeOf,Xb=iS.getOwnPropertyNames,Jb=Pr(),oS=Jb[Qb]||(Jb[Qb]={o:(x_={},x_[nS]=!0,x_[L_]=!0,x_),n:1e3});function tD(r){return r&&(r===iS[$a]||r===Array[$a])}function aS(r){return tD(r)||r===Function[$a]}function Kc(r){var e;if(r){if(Yf)return Yf(r);var t=r[eD]||r[$a]||(r[U_]?r[U_][$a]:null);e=r[M_]||t,Xt(r,M_)||(delete r[ZC],e=r[M_]=r[ZC]||r[M_],r[ZC]=t)}return e}function H_(r,e){var t=[];if(Xb)t=Xb(r);else for(var n in r)typeof n=="string"&&Xt(r,n)&&t.push(n);if(t&&t.length>0)for(var o=0;o<t.length;o++)e(t[o])}function sS(r,e,t){return e!==U_&&typeof r[e]===F_&&(t||Xt(r,e))}function B_(r){Dt("DynamicProto: "+r)}function n0(r){var e={};return H_(r,function(t){!e[t]&&sS(r,t,!1)&&(e[t]=r[t])}),e}function cS(r,e){for(var t=r.length-1;t>=0;t--)if(r[t]===e)return!0;return!1}function o0(r,e,t,n){function o(c,l,u){var d=l[u];if(d[tS]&&n){var h=c[Y_]||{};h[Ff]!==!1&&(d=(h[l[Qu]]||{})[u]||d)}return function(){return d.apply(c,arguments)}}var i={};H_(t,function(c){i[c]=o(e,t,c)});for(var a=Kc(r),s=[];a&&!aS(a)&&!cS(s,a);)H_(a,function(c){!i[c]&&sS(a,c,!Yf)&&(i[c]=o(e,a,c))}),s.push(a),a=Kc(a);return i}function i0(r,e,t,n){var o=null;if(r&&Xt(t,Qu)){var i=r[Y_]||{};if(o=(i[t[Qu]]||{})[e],o||B_("Missing ["+e+"] "+F_),!o[rS]&&i[Ff]!==!1){for(var a=!Xt(r,e),s=Kc(r),c=[];a&&s&&!aS(s)&&!cS(c,s);){var l=s[e];if(l){a=l===n;break}c.push(s),s=Kc(s)}try{a&&(r[e]=o),o[rS]=1}catch{i[Ff]=!1}}}return o}function a0(r,e,t){var n=e[r];return n===t&&(n=Kc(e)[r]),typeof n!==F_&&B_("["+r+"] is not a "+F_),n}function s0(r,e,t,n,o){function i(c,l){var u=function(){var d=i0(this,l,c,u)||a0(l,c,u);return d.apply(this,arguments)};return u[tS]=1,u}if(!tD(r)){var a=t[Y_]=t[Y_]||{},s=a[e]=a[e]||{};a[Ff]!==!1&&(a[Ff]=!!o),H_(t,function(c){sS(t,c,!1)&&t[c]!==n[c]&&(s[c]=t[c],delete t[c],(!Xt(r,c)||r[c]&&!r[c][tS])&&(r[c]=i(r,c)))})}}function c0(r,e){if(Yf){for(var t=[],n=Kc(e);n&&!aS(n)&&!cS(t,n);){if(n===r)return!0;t.push(n),n=Kc(n)}return!1}return!0}function eS(r,e){return Xt(r,$a)?r.name||e||$b:((r||{})[U_]||{}).name||e||$b}function Ne(r,e,t,n){Xt(r,$a)||B_("theClass is an invalid class definition.");var o=r[$a];c0(o,e)||B_("["+eS(r)+"] not in hierarchy of ["+eS(e)+"]");var i=null;Xt(o,Qu)?i=o[Qu]:(i=r0+eS(r,"_")+"$"+oS.n,oS.n++,o[Qu]=i);var a=Ne[Zb],s=!!a[L_];s&&n&&n[L_]!==void 0&&(s=!!n[L_]);var c=n0(e),l=o0(o,e,c,s);t(e,l);var u=!!Yf&&!!a[nS];u&&n&&(u=!!n[nS]),s0(o,i,e,c,u!==!1)}Ne[Zb]=oS.o;var Xu="function",Hf="object",Gc="undefined",kr="prototype";var Ju=Object,lS=Ju[kr];var m6=(Pr()||{}).Symbol,g6=(Pr()||{}).Reflect;var rD="hasOwnProperty",u0=function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var o in e)lS[rD].call(e,o)&&(r[o]=e[o])}return r},Ut=Yc||u0,uS=function(r,e){return uS=Ju.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n[rD](o)&&(t[o]=n[o])},uS(r,e)};function xr(r,e){typeof e!==Xu&&e!==null&&Dt("Class extends value "+String(e)+" is not a constructor or null"),uS(r,e);function t(){this.constructor=r}r[kr]=e===null?Uf(e):(t[kr]=e[kr],new t)}function K_(r,e){for(var t=0,n=e.length,o=r.length;t<n;t++,o++)r[o]=e[t];return r}var G_=RC,dS=bC;var qc="toLowerCase",Qa="blkVal",me="length",zc="rdOnly",Vc="notify",Zu="warnToConsole",Bi="throwInternal",Ao="setDf",Jn="watch",nt="logger",Zn="apply",Oe="push",eo="splice",q_="hdlr",jc="cancel",Wc="initialize",Zo="identifier",hn="isInitialized",Xa="getPlugin",hS="pollInternalLogs",Jr="name",Ja="time",or="processNext",z_="getProcessTelContext",ed="getNotifyMgr",td="addNotificationListener",rd="removeNotificationListener",Za="enabled",fS="stopPollingInternalLogs",fn="unload",Bf="onComplete",nd="version",V_="loggingLevelConsole",ei="createNew",xn="teardown",od="messageId",es="message",Io="isAsync",pn="diagLog",id="_doTeardown",$c="update",Mn="getNext",ts="setNextPlugin",Kf="userAgent",rs="split",j_="nodeType",Ki="replace",pS="logInternalMessage",ti="type",W_="handler",Gf="isChildEvt",Qc="getCtx",No="setCtx",$_="complete",qf="traceId",zf="spanId",Vf="traceFlags";var mS;function nD(r,e){mS||(mS=b_("AggregationError",function(n,o){o[me]>1&&(n.errors=o[1])}));var t=r||"One or more errors occurred.";throw j(e,function(n,o){t+=`
`.concat(o," > ").concat(G(n))}),new mS(t,e||[])}function ns(r,e){return Q_(r,function(t){e&&e({value:t,rejected:!1})},function(t){e&&e({rejected:!0,reason:t})})}function Q_(r,e,t,n){var o=r;return Va(r)?(e||t)&&(o=r.then(e,t)):e&&e(r),n&&(o=oD(o,n)),o}function oD(r,e){var t=r;return e&&(Va(r)?r.finally?t=r.finally(e):t=r.then(function(n){return e(),n},function(n){throw e(),n}):e()),t}var gS,_S,vS,ES=!1;function iD(r,e,t,n){gS=gS||{toString:function(){return"[[PromiseState]]"}},_S=_S||{toString:function(){return"[[PromiseResult]]"}},vS=vS||{toString:function(){return"[[PromiseIsHandled]]"}},er(r,gS,{get:e}),er(r,_S,{get:t}),er(r,vS,{get:n})}var X_=["pending","resolving","resolved","rejected"];var aD="dispatchEvent",J_;function sD(r,e,t,n){var o=lt();!J_&&(J_=Qo(function(){var c;return o&&o.createEvent&&(c=o.createEvent("Event")),!!c&&c.initEvent},null));var i=J_.v?o.createEvent("Event"):n?new Event(e):{};if(t&&t(i),J_.v&&i.initEvent(e,!1,!0),i&&r[aD])r[aD](i);else{var a=r["on"+e];if(a)a(i);else{var s=At("console");s&&(s.error||s.log)(e,G(i))}}}var ad="Promise";var lD="unhandledRejection",d0=lD.toLowerCase(),jf=[],h0=0,f0=10,TS;function cD(r){return ce(r)?r.toString():G(r)}function uD(r,e,t){var n=Or(arguments,3),o=0,i=!1,a,s=[],c=h0++,l=jf.length>0?jf[jf.length-1]:void 0,u=!1,d=null,h;!TS&&(TS=kn(ad+"RejectionEvent"));var f=function(w,O){try{jf.push(c),u=!0,d&&d.cancel(),d=null;var S=r(function(K,ne){s.push(function(){try{var _e=o===2?w:O,Ct=be(_e)?a:ce(_e)?_e(a):_e;Va(Ct)?Ct.then(K,ne):_e?K(Ct):o===3?ne(Ct):K(Ct)}catch(Ze){ne(Ze)}}),i&&T()},n);return S}finally{jf.pop()}},p=function(w){return f(void 0,w)},m=function(w){var O=w,S=w;return ce(w)&&(O=function(K){return w&&w(),K},S=function(K){throw w&&w(),K}),f(O,S)},_=function(){return X_[o]},T=function(){if(s.length>0){var w=s.slice();s=[],u=!0,e(w),d&&d.cancel(),d=null}},E=function(w,O){return function(S){if(o===O){if(w===2&&Va(S)){o=1,S.then(E(2,1),E(3,1));return}o=w,i=!0,a=S,T(),!u&&w===3&&!d&&(d=Ht(y,f0))}}},y=function(){if(!u)if(FC())process.emit(lD,a,h);else{var w=tr()||Pr();sD(w,d0,function(O){return ve(O,"promise",{g:function(){return h}}),O.reason=a,O},!!TS.v)}};h={then:f,catch:p,finally:m},er(h,"state",{get:_}),ES&&iD(h,_,function(){return Uc(a)},function(){return u}),YC()&&(h[Hc(11)]="IPromise");var A=function(){return"IPromise"+(ES?"["+c+(be(l)?"":":"+l)+"]":"")+" "+_()+(i?" - "+cD(a):"")};return h.toString=A,function(){ce(t)||Dt(ad+": executor is not a function - "+cD(t));var O=E(3,0);try{t.call(h,E(2,0),O)}catch(S){O(S)}}(),h}function sd(r){return function(e){var t=Or(arguments,1);return r(function(n,o){try{var i=[],a=1;j(e,function(s,c){s&&(a++,Q_(s,function(l){i[c]=l,--a===0&&n(i)},o))}),a--,a===0&&n(i)}catch(s){o(s)}},t)}}function cd(r){return function(e){var t=Or(arguments,1);return Va(e)?e:r(function(n){n(e)},t)}}function ld(r){return function(e){var t=Or(arguments,1);return r(function(n,o){o(e)},t)}}var p0=function(r){j(r,function(e){try{e()}catch{}})};function dD(r){var e=Wo(r)?r:0;return function(t){Ht(function(){p0(t)},e)}}function ud(r,e){return uD(ud,dD(e),r,e)}var lJ=sd(ud),uJ=cd(ud),dJ=ld(ud);var yS;function Wf(r,e){!yS&&(yS=kn(ad));var t=yS.v;if(!t)return ud(r);ce(r)||Dt(ad+": executor is not a function - "+G(r));var n=0;function o(){return X_[n]}var i=new t(function(a,s){function c(u){n=2,a(u)}function l(u){n=3,s(u)}r(c,l)});return er(i,"state",{get:o}),i}var vJ=sd(Wf),EJ=cd(Wf),TJ=ld(Wf);var CS;function Mr(r,e){return!CS&&(CS=So(function(){return Wf})),CS.v.call(this,r,e)}var SS=sd(Mr),m0=cd(Mr),g0=ld(Mr);var Ln=void 0,Ce="",os="channels",It="core",Z_="createPerfMgr",$f="disabled",Gi="extensionConfig",Xc="extensions",mn="processTelemetry",Jc="priority",dd="eventsSent",is="eventsDiscarded",hd="eventsSendRequest",ri="perfEvent",fd="getPerfMgr",ev="domain",tv="path",hD="Not dynamic - ";var _0="getPrototypeOf",v0=/-([a-z])/g,E0=/([^\w\d_$])/g,T0=/^(\d+[\w\d_$])/,fD=Object[_0];function pd(r){return!H(r)}function Zc(r){var e=r;return e&&ae(e)&&(e=e[Ki](v0,function(t,n){return n.toUpperCase()}),e=e[Ki](E0,"_"),e=e[Ki](T0,function(t,n){return"_"+n})),e}function ir(r,e){return r&&e?Tt(r,e)!==-1:!1}function to(r){return r&&r.toISOString()||""}function we(r){return $o(r)?r[Jr]:Ce}function Qe(r,e,t,n,o){var i=t;return r&&(i=r[e],i!==t&&(!o||o(i))&&(!n||n(t))&&(i=t,r[e]=i)),i}function ar(r,e,t){var n;return r?(n=r[e],!n&&H(n)&&(n=be(t)?{}:t,r[e]=n)):n=be(t)?{}:t,n}function pD(r,e){var t=null,n=null;return ce(r)?t=r:n=r,function(){var o=arguments;if(t&&(n=t()),n)return n[e][Zn](n,o)}}function AS(r,e,t){if(r&&e&&bt(r)&&bt(e)){var n=function(i){if(ae(i)){var a=e[i];ce(a)?(!t||t(i,!0,e,r))&&(r[i]=pD(e,i)):(!t||t(i,!1,e,r))&&(un(r,i)&&delete r[i],ve(r,i,{g:function(){return e[i]},s:function(s){e[i]=s}}))}};for(var o in e)n(o)}return r}function el(r,e,t,n,o){r&&e&&t&&(o!==!1||be(r[e]))&&(r[e]=pD(t,n))}function as(r,e,t,n){return r&&e&&bt(r)&&de(t)&&j(t,function(o){ae(o)&&el(r,o,e,o,n)}),r}function IS(r){return function(){function e(){var t=this;r&&ue(r,function(n,o){t[n]=o})}return e}()}function rv(r){return r&&Yc&&(r=Ju(Yc({},r))),r}function nv(r,e,t,n,o,i){var a=arguments,s=a[0]||{},c=a[me],l=!1,u=1;for(c>0&&qu(s)&&(l=s,s=a[u]||{},u++),bt(s)||(s={});u<c;u++){var d=a[u],h=de(d),f=bt(d);for(var p in d){var m=h&&p in d||f&&un(d,p);if(m){var _=d[p],T=void 0;if(l&&_&&((T=de(_))||nr(_))){var E=s[p];T?de(E)||(E=[]):nr(E)||(E={}),_=nv(l,E,_)}_!==void 0&&(s[p]=_)}}}return s}var y0="documentMode",C0="location",S0="console";var mD="JSON",A0="crypto",I0="msCrypto",N0="ReactNative",bS="msie",DS="trident/",gD="XMLHttpRequest",NS=null,RS=null,R0=!1,md=null,wS=null;function _D(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[kr];n&&(t=e in n)}}catch{}if(!t)try{var o=new r;t=!be(o[e])}catch{}}return t}function gn(r){if(r&&R0){var e=At("__mockLocation");if(e)return e}return typeof location===Hf&&location?location:At(C0)}function PS(){return typeof console!==Gc?console:At(S0)}function ni(){return!!(typeof JSON===Hf&&JSON||At(mD)!==null)}function _r(){return ni()?JSON||At(mD):null}function OS(){return At(A0)}function kS(){return At(I0)}function xS(){var r=gr();return r&&r.product?r.product===N0:!1}function gd(){var r=gr();if(r&&(r[Kf]!==RS||NS===null)){RS=r[Kf];var e=(RS||Ce)[qc]();NS=ir(e,bS)||ir(e,DS)}return NS}function Qf(r){if(r===void 0&&(r=null),!r){var e=gr()||{};r=e?(e.userAgent||Ce)[qc]():Ce}var t=(r||Ce)[qc]();if(ir(t,bS)){var n=lt()||{};return Math.max(parseInt(t[rs](bS)[1]),n[y0]||0)}else if(ir(t,DS)){var o=parseInt(t[rs](DS)[1]);if(o)return o+4}return null}function tl(){return wS===null&&(wS=A_()&&!!gr().sendBeacon),wS}function ov(r){var e=!1;try{e=!!At("fetch");var t=At("Request");e&&r&&t&&(e=_D(t,"keepalive"))}catch{}return e}function iv(){return md===null&&(md=typeof XDomainRequest!==Gc,md&&rl()&&(md=md&&!_D(At(gD),"withCredentials"))),md}function rl(){var r=!1;try{var e=At(gD);r=!!e}catch{}return r}var vD=4294967296,nl=4294967295,ED=123456789,TD=987654321,yD=!1,Xf=ED,Jf=TD;function w0(r){r<0&&(r>>>=0),Xf=ED+r&nl,Jf=TD-r&nl,yD=!0}function b0(){try{var r=rr()&2147483647;w0((Math.random()*vD^r)+r)}catch{}}function _d(r){var e=0,t=OS()||kS();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&nl),e===0&&gd()&&(yD||b0(),e=CD()&nl),e===0&&(e=Math.floor(vD*Math.random()|0)),r||(e>>>=0),e}function CD(r){Jf=36969*(Jf&65535)+(Jf>>16)&nl,Xf=18e3*(Xf&65535)+(Xf>>16)&nl;var e=(Jf<<16)+(Xf&65535)>>>0&nl|0;return r||(e>>>=0),e}function ol(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=_d()>>>0,n=0,o=Ce;o[me]<r;)n++,o+=e.charAt(t&63),t>>>=6,n===5&&(t=(_d()<<2&4294967295|t&3)>>>0,n=0);return o}var SD="3.0.2",D0="."+ol(6),P0=0;function AD(r){return r[j_]===1||r[j_]===9||!+r[j_]}function O0(r,e){var t=e[r.id];if(!t){t={};try{AD(e)&&ve(e,r.id,{e:!1,v:t})}catch{}}return t}function sr(r,e){return e===void 0&&(e=!1),Zc(r+P0+++(e?"."+SD:Ce)+D0)}function av(r){var e={id:sr("_aiData-"+(r||Ce)+"."+SD),accept:function(t){return AD(t)},get:function(t,n,o,i){var a=t[e.id];return a?a[Zc(n)]:(i&&(a=O0(e,t),a[Zc(n)]=o),o)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch{}}};return e}function sv(r){return r&&bt(r)&&(r.isVal||r.fb||un(r,"v")||un(r,"mrg")||un(r,"ref")||r.set)}function ID(r,e,t){var n,o=t.dfVal||p_;if(e&&t.fb){var i=t.fb;de(i)||(i=[i]);for(var a=0;a<i[me];a++){var s=i[a],c=e[s];if(o(c)?n=c:r&&(c=r.cfg[s],o(c)&&(n=c),r.set(r.cfg,Zt(s),c)),o(n))break}}return!o(n)&&o(t.v)&&(n=t.v),n}function MS(r,e,t){var n=t;if(t&&sv(t)&&(n=ID(r,e,t)),n){sv(n)&&(n=MS(r,e,n));var o;de(n)?(o=[],o[me]=n[me]):nr(n)&&(o={}),o&&(ue(n,function(i,a){a&&sv(a)&&(a=MS(r,e,a)),o[i]=a}),n=o)}return n}function Zf(r,e,t,n){var o,i,a,s=n,c,l,u,d;sv(s)?(o=s.isVal,i=s.set,u=s[zc],d=s[Qa],c=s.mrg,l=s.ref,!l&&be(l)&&(l=!!c),a=ID(r,e,s)):a=n,d&&r[Qa](e,t);var h,f=!0,p=e[t];(p||!H(p))&&(h=p,f=!1,o&&h!==a&&!o(h)&&(h=a,f=!0),i&&(h=i(h,a,e),f=h===a)),f?a?h=MS(r,e,a):h=a:(nr(h)||de(a))&&c&&a&&(nr(a)||de(a))&&ue(a,function(m,_){Zf(r,h,m,_)}),r.set(e,t,h),l&&r.ref(e,t),u&&r[zc](e,t)}var oi=xf("[[ai_dynCfg_1]]"),ND=xf("[[ai_blkDynCfg_1]]"),k0=xf("[[ai_frcDynCfg_1]]");function LS(r){if(r){var e;if(de(r)?(e=[],e[me]=r[me]):nr(r)&&(e={}),e)return ue(r,function(t,n){e[t]=LS(n)}),e}return r}function RD(r){if(r){var e=r[oi]||r;if(e.cfg&&(e.cfg===r||e.cfg[oi]===e))return e}return null}function wD(r){if(r&&(nr(r)||de(r)))try{r[ND]=!0}catch{}return r}function cv(r,e,t){var n=!1;return t&&!r[e.blkVal]&&(n=t[k0],!n&&!t[ND]&&(n=nr(t)||de(t))),n}function lv(r){Dt("InvalidAccess:"+r)}var x0=["push","pop","shift","unshift","splice"],vd=function(r,e,t,n){r&&r[Bi](3,108,"".concat(t," [").concat(e,"] failed - ")+G(n))};function M0(r,e,t){de(e)&&j(x0,function(n){var o=e[n];e[n]=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=o[Zn](this,i);return ep(r,e,t,"Patching"),s}})}function uv(r,e){var t=Fc(r,e);return t&&t.get}function L0(r,e,t,n){var o={n:t,h:[],trk:function(l){l&&l.fn&&(ut(o.h,l)===-1&&o.h[Oe](l),r.trk(l,o))},clr:function(l){var u=ut(o.h,l);u!==-1&&o.h[eo](u,1)}},i=!0,a=!1;function s(){i&&(a=a||cv(s,r,n),n&&!n[oi]&&a&&(n=ep(r,n,t,"Converting")),i=!1);var l=r.act;return l&&o.trk(l),n}s[r.prop]={chng:function(){r.add(o)}};function c(l){if(n!==l){s[r.ro]&&!r.upd&&lv("["+t+"] is read-only:"+G(e)),i&&(a=a||cv(s,r,n),i=!1);var u=a&&s[r.rf];if(a)if(u){ue(n,function(h){n[h]=l?l[h]:Ln});try{ue(l,function(h,f){tp(r,n,h,f)}),l=n}catch(h){vd((r.hdlr||{})[nt],t,"Assigning",h),a=!1}}else n&&n[oi]&&ue(n,function(h){var f=uv(n,h);if(f){var p=f[r.prop];p&&p.chng()}});if(l!==n){var d=l&&cv(s,r,l);!u&&d&&(l=ep(r,l,t,"Converting")),n=l,a=d}r.add(o)}}ve(e,o.n,{g:s,s:c})}function tp(r,e,t,n){if(e){var o=uv(e,t),i=o&&!!o[r.prop];i?e[t]=n:L0(r,e,t,n)}return e}function dv(r,e,t,n){if(e){var o=uv(e,t),i=o&&!!o[r.prop],a=n&&n[0],s=n&&n[1],c=n&&n[2];if(!i){if(c)try{wD(e)}catch(l){vd((r.hdlr||{})[nt],t,"Blocking",l)}try{tp(r,e,t,e[t]),o=uv(e,t)}catch(l){vd((r.hdlr||{})[nt],t,"State",l)}}a&&(o[r.rf]=a),s&&(o[r.ro]=s),c&&(o[r.blkVal]=!0)}return e}function ep(r,e,t,n){try{ue(e,function(o,i){tp(r,e,o,i)}),e[oi]||(er(e,oi,{get:function(){return r[q_]}}),M0(r,e,t))}catch(o){vd((r.hdlr||{})[nt],t,n,o)}return e}var rp="[[ai_",np="]]";function bD(r){var e,t=Bc(rp+"get"+r.uid+np),n=Bc(rp+"ro"+r.uid+np),o=Bc(rp+"rf"+r.uid+np),i=Bc(rp+"blkVal"+r.uid+np),a=Bc(rp+"dtl"+r.uid+np),s=null,c=null,l;function u(p,m){var _=l.act;try{l.act=p,p&&p[a]&&(j(p[a],function(E){E.clr(p)}),p[a]=[]),m({cfg:r.cfg,set:r.set.bind(r),setDf:r[Ao].bind(r),ref:r.ref.bind(r),rdOnly:r[zc].bind(r)})}catch(E){var T=r[nt];throw T&&T[Bi](1,107,G(E)),E}finally{l.act=_||null}}function d(){if(s){var p=s;s=null,c&&c[jc](),c=null;var m=[];if(j(p,function(_){if(_&&(_[a]&&(j(_[a],function(T){T.clr(_)}),_[a]=null),_.fn))try{u(_,_.fn)}catch(T){m[Oe](T)}}),s)try{d()}catch(_){m[Oe](_)}m[me]>0&&nD("Watcher error(s): ",m)}}function h(p){if(p&&p.h[me]>0){s||(s=[]),c||(c=Ht(function(){c=null,d()},0));for(var m=0;m<p.h[me];m++){var _=p.h[m];_&&ut(s,_)===-1&&s[Oe](_)}}}function f(p,m){if(p){var _=p[a]=p[a]||[];ut(_,m)===-1&&_[Oe](m)}}return l=(e={prop:t,ro:n,rf:o},e[Qa]=i,e[q_]=r,e.add=h,e[Vc]=d,e.use=u,e.trk=f,e),l}function U0(r,e){var t={fn:e,rm:function(){t.fn=null,r=null,e=null}};return r.use(t,e),t}function F0(r,e,t){var n,o=RD(e);if(o)return o;var i=sr("dyncfg",!0),a=e&&t!==!1?e:LS(e),s;function c(){s[Vc]()}function l(T,E,y){try{T=tp(s,T,E,y)}catch(A){vd(r,E,"Setting value",A)}return T[E]}function u(T){return U0(s,T)}function d(T,E){s.use(null,function(y){var A=s.upd;try{be(E)||(s.upd=E),T(y)}finally{s.upd=A}})}function h(T,E){var y;return dv(s,T,E,(y={},y[0]=!0,y))[E]}function f(T,E){var y;return dv(s,T,E,(y={},y[1]=!0,y))[E]}function p(T,E){var y;return dv(s,T,E,(y={},y[2]=!0,y))[E]}function m(T,E){return E&&ue(E,function(y,A){Zf(_,T,y,A)}),T}var _=(n={uid:null,cfg:a},n[nt]=r,n[Vc]=c,n.set=l,n[Ao]=m,n[Jn]=u,n.ref=h,n[zc]=f,n[Qa]=p,n._block=d,n);return ve(_,"uid",{c:!1,e:!1,w:!1,v:i}),s=bD(_),ep(s,a,"config","Creating"),_}function Y0(r,e){r?(r[Zu](e),r[Bi](2,108,e)):lv(e)}function Bt(r,e,t,n){var o=F0(t,r||{},n);return e&&o[Ao](o.cfg,e),o}function Je(r,e,t){var n=r[oi]||r;return n.cfg&&(n.cfg===r||n.cfg[oi]===n)?n[Jn](e):(Y0(t,hD+G(r)),Bt(r,null,t)[Jn](e))}function qi(r,e){if(r&&r[fn])return r[fn](e)}function hv(r,e,t){var n;return t||(n=Mr(function(o){t=o})),r&&$C(r)>0?ns(qi(r[0],e),function(){hv(Or(r,1),e,t)}):t(),n}var DD=500;function H0(r,e,t){return!r&&H(r)?e:qu(r)?r:Zt(r)[qc]()==="true"}function US(r){return{mrg:!0,v:r}}function fv(r,e){return{set:r,v:e}}function ss(r,e,t){return{fb:t,isVal:r,v:e}}function Ft(r,e){return{fb:e,set:H0,v:!!r}}function FS(r){return{isVal:ae,v:Zt(r||Ce)}}var YS=[dd,is,hd,ri],mv=null,pv;function B0(r,e){return function(){var t=arguments,n=HS(e);if(n){var o=n.listener;o&&o[r]&&o[r][Zn](o,t)}}}function K0(){var r=At("Microsoft");return r&&(mv=r.ApplicationInsights),mv}function HS(r){var e=mv;return!e&&r.disableDbgExt!==!0&&(e=mv||K0()),e?e.ChromeDbgExt:null}function PD(r){if(!pv){pv={};for(var e=0;e<YS[me];e++)pv[YS[e]]=B0(YS[e],r)}return pv}var Ed,kD="warnToConsole",G0="AI (Internal): ",q0="AI: ",z0="AITR_",V0={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},j0=(Ed={},Ed[0]=null,Ed[1]="errorToConsole",Ed[2]=kD,Ed[3]="debugToConsole",Ed);function OD(r){return r?'"'+r[Ki](/\"/g,Ce)+'"':Ce}function BS(r,e){var t=PS();if(t){var n="log";t[r]&&(n=r),ce(t[n])&&t[n](e)}}var zi=function(){function r(e,t,n,o){n===void 0&&(n=!1);var i=this;i[od]=e,i[es]=(n?q0:G0)+e;var a=Ce;ni()&&(a=_r().stringify(o));var s=(t?" message:"+OD(t):Ce)+(o?" props:"+OD(a):Ce);i[es]+=s}return r.dataType="MessageData",r}();function Un(r,e){return(r||{})[nt]||new Td(e)}var Td=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},o,i,a,s,c;Ne(r,this,function(l){c=d(e||{}),l.consoleLoggingLevel=function(){return o},l[Bi]=function(p,m,_,T,E){E===void 0&&(E=!1);var y=new zi(m,_,E,T);if(s)throw G(y);var A=j0[p]||kD;if(be(y[es]))f("throw"+(p===1?"Critical":"Warning"),y);else{if(E){var w=+y[od];!n[w]&&o>=p&&(l[A](y[es]),n[w]=!0)}else o>=p&&l[A](y[es]);u(p,y)}},l.debugToConsole=function(p){BS("debug",p),f("warning",p)},l[Zu]=function(p){BS("warn",p),f("warning",p)},l.errorToConsole=function(p){BS("error",p),f("error",p)},l.resetInternalMessageCount=function(){t=0,n={}},l[pS]=u,l[fn]=function(p){c&&c.rm(),c=null};function u(p,m){if(!h()){var _=!0,T=z0+m[od];if(n[T]?_=!1:n[T]=!0,_&&(p<=i&&(l.queue[Oe](m),t++,f(p===1?"error":"warn",m)),t===a)){var E="Internal events throttle limit per PageView reached for this app.",y=new zi(23,E,!1);l.queue[Oe](y),p===1?l.errorToConsole(E):l[Zu](E)}}}function d(p){return Je(Bt(p,V0,l).cfg,function(m){var _=m.cfg;o=_[V_],i=_.loggingLevelTelemetry,a=_.maxMessageLimit,s=_.enableDebug})}function h(){return t>=a}function f(p,m){var _=HS(e||{});_&&_[pn]&&_[pn](p,m)}})}return r.__ieDyn=1,r}();function KS(r){return r||new Td}function q(r,e,t,n,o,i){i===void 0&&(i=!1),KS(r)[Bi](e,t,n,o,i)}function Ro(r,e){KS(r)[Zu](e)}function GS(r,e,t){KS(r)[pS](e,t)}var qS,il,xD="toGMTString",MD="toUTCString",$S="cookie",zS="expires",LD="isCookieUseDisabled",jS="disableCookiesUsage",cs="_ckMgr",gv=null,VS=null,UD=null,ii,FD={},vv={},W0=(qS={cookieCfg:US((il={},il[ev]={fb:"cookieDomain",dfVal:pd},il.path={fb:"cookiePath",dfVal:pd},il.enabled=Ln,il.ignoreCookies=Ln,il.blockedCookies=Ln,il)),cookieDomain:Ln,cookiePath:Ln},qS[jS]=Ln,qS);function QS(){!ii&&(ii=So(function(){return lt()}))}function $0(r,e){var t=al[cs]||vv[cs];return t||(t=al[cs]=al(r,e),vv[cs]=t),t}function _v(r){return r?r.isEnabled():!0}function GD(r,e){return e&&r&&de(r.ignoreCookies)?ut(r.ignoreCookies,e)!==-1:!1}function Q0(r,e){return e&&r&&de(r.blockedCookies)&&ut(r.blockedCookies,e)!==-1?!0:GD(r,e)}function YD(r,e){var t=e[Za];if(H(t)){var n=void 0;be(r[LD])||(n=!r[LD]),be(r[jS])||(n=!r[jS]),t=n}return t}function sl(r,e){var t;if(r)t=r.getCookieMgr();else if(e){var n=e.cookieCfg;n&&n[cs]?t=n[cs]:t=al(e)}return t||(t=$0(e,(r||{})[nt])),t}function al(r,e){var t,n,o,i,a,s,c,l,u;r=Bt(r||vv,null,e).cfg,a=Je(r,function(h){h[Ao](h.cfg,W0),n=h.ref(h.cfg,"cookieCfg"),o=n[tv]||"/",i=n[ev],s=YD(r,n)!==!1,c=n.getCookie||X0,l=n.setCookie||KD,u=n.delCookie||KD},e);var d=(t={isEnabled:function(){var h=YD(r,n)!==!1&&s&&WS(e),f=vv[cs];return h&&f&&d!==f&&(h=_v(f)),h},setEnabled:function(h){s=h!==!1,n[Za]=h},set:function(h,f,p,m,_){var T=!1;if(_v(d)&&!Q0(n,h)){var E={},y=Lt(f||Ce),A=Tt(y,";");if(A!==-1&&(y=Lt(Vu(f,A)),E=qD(Sr(f,A+1))),Qe(E,ev,m||i,Yi,be),!H(p)){var w=gd();if(be(E[zS])){var O=rr(),S=O+p*1e3;if(S>0){var K=new Date;K.setTime(S),Qe(E,zS,HD(K,w?xD:MD)||HD(K,w?xD:MD)||Ce,Yi)}}w||Qe(E,"max-age",Ce+p,null,be)}var ne=gn();ne&&ne.protocol==="https:"&&(Qe(E,"secure",null,null,be),VS===null&&(VS=!zD((gr()||{})[Kf])),VS&&Qe(E,"SameSite","None",null,be)),Qe(E,tv,_||o,null,be),l(h,BD(y,E)),T=!0}return T},get:function(h){var f=Ce;return _v(d)&&!GD(n,h)&&(f=c(h)),f},del:function(h,f){var p=!1;return _v(d)&&(p=d.purge(h,f)),p},purge:function(h,f){var p,m=!1;if(WS(e)){var _=(p={},p[tv]=f||"/",p[zS]="Thu, 01 Jan 1970 00:00:01 GMT",p);gd()||(_["max-age"]="0"),u(h,BD(Ce,_)),m=!0}return m}},t[fn]=function(h){a&&a.rm(),a=null},t);return d[cs]=d,d}function WS(r){if(gv===null){gv=!1,!ii&&QS();try{var e=ii.v||{};gv=e[$S]!==void 0}catch(t){q(r,2,68,"Cannot access document.cookie - "+we(t),{exception:G(t)})}}return gv}function qD(r){var e={};if(r&&r[me]){var t=Lt(r)[rs](";");j(t,function(n){if(n=Lt(n||Ce),n){var o=Tt(n,"=");o===-1?e[n]=null:e[Lt(Vu(n,o))]=Lt(Sr(n,o+1))}})}return e}function HD(r,e){return ce(r[e])?r[e]():null}function BD(r,e){var t=r||Ce;return ue(e,function(n,o){t+="; "+n+(H(o)?Ce:"="+o)}),t}function X0(r){var e=Ce;if(!ii&&QS(),ii.v){var t=ii.v[$S]||Ce;UD!==t&&(FD=qD(t),UD=t),e=Lt(FD[r]||Ce)}return e}function KD(r,e){!ii&&QS(),ii.v&&(ii.v[$S]=r+"="+e)}function zD(r){return ae(r)?!!(ir(r,"CPU iPhone OS 12")||ir(r,"iPad; CPU OS 12")||ir(r,"Macintosh; Intel Mac OS X 10_14")&&ir(r,"Version/")&&ir(r,"Safari")||ir(r,"Macintosh; Intel Mac OS X 10_14")&&O_(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||ir(r,"Chrome/5")||ir(r,"Chrome/6")||ir(r,"UnrealEngine")&&!ir(r,"Chrome")||ir(r,"UCBrowser/12")||ir(r,"UCBrowser/11")):!1}var J0={perfEvtsSendAll:!1};function op(r,e,t,n){j(r,function(o){if(o&&o[e])if(t)Ht(function(){return n(o)},0);else try{n(o)}catch{}})}var VD=function(){function r(e){this.listeners=[];var t,n,o=[],i=Bt(e,J0);n=i[Jn](function(a){t=!!a.cfg.perfEvtsSendAll}),Ne(r,this,function(a){ve(a,"listeners",{g:function(){return o}}),a[td]=function(s){o[Oe](s)},a[rd]=function(s){for(var c=ut(o,s);c>-1;)o[eo](c,1),c=ut(o,s)},a[dd]=function(s){op(o,dd,!0,function(c){c[dd](s)})},a[is]=function(s,c){op(o,is,!0,function(l){l[is](s,c)})},a[hd]=function(s,c){op(o,hd,c,function(l){l[hd](s,c)})},a[ri]=function(s){s&&(t||!s[Gf]())&&op(o,ri,!1,function(c){s[Io]?Ht(function(){return c[ri](s)},0):c[ri](s)})},a[fn]=function(s){var c=function(){n&&n.rm(),n=null,o=[]},l;if(op(o,"unload",!1,function(u){var d=u[fn](s);d&&(l||(l=[]),l[Oe](d))}),l)return Mr(function(u){return ns(SS(l),function(){c(),u()})});c()}})}return r.__ieDyn=1,r}();var yd="ctx",JS="ParentContextKey",ip="ChildrenContextKey",Z0=null,ap=function(){function r(e,t,n){var o=this;if(o.start=rr(),o[Jr]=e,o[Io]=n,o[Gf]=function(){return!1},ce(t)){var i;ve(o,"payload",{g:function(){return!i&&ce(t)&&(i=t(),t=null),i}})}o[Qc]=function(a){return a?a===r[JS]||a===r[ip]?o[a]:(o[yd]||{})[a]:null},o[No]=function(a,s){if(a)if(a===r[JS])o[a]||(o[Gf]=function(){return!0}),o[a]=s;else if(a===r[ip])o[a]=s;else{var c=o[yd]=o[yd]||{};c[a]=s}},o[$_]=function(){var a=0,s=o[Qc](r[ip]);if(de(s))for(var c=0;c<s[me];c++){var l=s[c];l&&(a+=l[Ja])}o[Ja]=rr()-o.start,o.exTime=o[Ja]-a,o[$_]=function(){}}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}();var ZS=function(){function r(e){this.ctx={},Ne(r,this,function(t){t.create=function(n,o,i){return new ap(n,o,i)},t.fire=function(n){n&&(n[$_](),e&&ce(e[ri])&&e[ri](n))},t[No]=function(n,o){if(n){var i=t[yd]=t[yd]||{};i[n]=o}},t[Qc]=function(n){return(t[yd]||{})[n]}})}return r.__ieDyn=1,r}();var XS="CoreUtils.doPerf";function ls(r,e,t,n,o){if(r){var i=r;if(i[fd]&&(i=i[fd]()),i){var a=void 0,s=i[Qc](XS);try{if(a=i.create(e(),n,o),a){if(s&&a[No]&&(a[No](ap[JS],s),s[Qc]&&s[No])){var c=s[Qc](ap[ip]);c||(c=[],s[No](ap[ip],c)),c[Oe](a)}return i[No](XS,a),t(a)}}catch(l){a&&a[No]&&a[No]("exception",l)}finally{a&&i.fire(a),i[No](XS,s)}}}return t()}function eA(){return Z0}function Fn(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Ce,t,n=0;n<4;n++)t=_d(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var o=r[8+(_d()&3)|0];return Xn(e,0,8)+Xn(e,9,4)+"4"+Xn(e,13,3)+o+Xn(e,16,3)+Xn(e,19,12)}var tA="00",eU="ff",WD="00000000000000000000000000000000",$D="0000000000000000";function sp(r,e,t){return r&&r[me]===e&&r!==t?!!r.match(/^[\da-f]*$/i):!1}function jD(r,e,t){return sp(r,e)?r:t}function tU(r){(isNaN(r)||r<0||r>255)&&(r=1);for(var e=r.toString(16);e[me]<2;)e="0"+e;return e}function cp(r,e,t,n){var o;return o={},o[nd]=sp(n,2,eU)?n:tA,o[qf]=cl(r)?r:Fn(),o[zf]=ll(e)?e:Vu(Fn(),16),o.traceFlags=t>=0&&t<=255?t:1,o}function cl(r){return sp(r,32,WD)}function ll(r){return sp(r,16,$D)}function lp(r){if(r){var e=tU(r[Vf]);sp(e,2)||(e="01");var t=r[nd]||tA;return t!=="00"&&t!=="ff"&&(t=tA),"".concat(t.toLowerCase(),"-").concat(jD(r.traceId,32,WD).toLowerCase(),"-").concat(jD(r.spanId,16,$D).toLowerCase(),"-").concat(e.toLowerCase())}return""}var rU=av("plugin");function Vi(r){return rU.get(r,"state",{},!0)}function rA(r,e){for(var t=[],n=null,o=r[Mn](),i;o;){var a=o[Xa]();if(a){n&&n[ts]&&a[mn]&&n[ts](a),i=Vi(a);var s=!!i[hn];a[hn]&&(s=a[hn]()),s||t[Oe](a),n=a,o=o[Mn]()}}j(t,function(c){var l=r[It]();c[Wc](r.getCfg(),l,e,r[Mn]()),i=Vi(c),!c[It]&&!i[It]&&(i[It]=l),i[hn]=!0,delete i[xn]})}function Ev(r){return r.sort(function(e,t){var n=0;if(t){var o=t[mn];e[mn]?n=o?e[Jc]-t[Jc]:1:o&&(n=-1)}else n=e?1:-1;return n})}function QD(r){var e={};return{getName:function(){return e[Jr]},setName:function(t){r&&r.setName(t),e[Jr]=t},getTraceId:function(){return e[qf]},setTraceId:function(t){r&&r.setTraceId(t),cl(t)&&(e[qf]=t)},getSpanId:function(){return e[zf]},setSpanId:function(t){r&&r.setSpanId(t),ll(t)&&(e[zf]=t)},getTraceFlags:function(){return e[Vf]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[Vf]=t}}}var nU="TelemetryPluginChain",XD="_hasRun",JD="_getTelCtx",ZD=0;function oU(r,e,t){for(;r;){if(r[Xa]()===t)return r;r=r[Mn]()}return us([t],e.config||{},e)}function nA(r,e,t,n){var o=null,i=[];e||(e=Bt({},null,t[nt])),n!==null&&(o=n?oU(r,t,n):r);var a={_next:c,ctx:{core:function(){return t},diagLog:function(){return Un(t,e.cfg)},getCfg:function(){return e.cfg},getExtCfg:u,getConfig:d,hasNext:function(){return!!o},getNext:function(){return o},setNext:function(f){o=f},iterate:h,onComplete:s}};function s(f,p){for(var m=[],_=2;_<arguments.length;_++)m[_-2]=arguments[_];f&&i[Oe]({func:f,self:be(p)?a.ctx:p,args:m})}function c(){var f=o;if(o=f?f[Mn]():null,!f){var p=i;p&&p[me]>0&&(j(p,function(m){try{m.func.call(m.self,m.args)}catch(_){q(t[nt],2,73,"Unexpected Exception during onComplete - "+G(_))}}),i=[])}return f}function l(f,p){var m=null,_=e.cfg;if(_&&f){var T=_[Gi];!T&&p&&(T={}),_[Gi]=T,T=e.ref(_,Gi),T&&(m=T[f],!m&&p&&(m={}),T[f]=m,m=e.ref(T,f))}return m}function u(f,p){var m=l(f,!0);return p&&ue(p,function(_,T){if(H(m[_])){var E=e.cfg[_];(E||!H(E))&&(m[_]=E)}Zf(e,m,_,T)}),e[Ao](m,p)}function d(f,p,m){m===void 0&&(m=!1);var _,T=l(f,!1),E=e.cfg;return T&&(T[p]||!H(T[p]))?_=T[p]:(E[p]||!H(E[p]))&&(_=E[p]),_||!H(_)?_:m}function h(f){for(var p;p=a._next();){var m=p[Xa]();m&&f(m)}}return a}function Lr(r,e,t,n){var o=Bt(e),i=nA(r,o,t,n),a=i.ctx;function s(l){var u=i._next();return u&&u[mn](l,a),!u}function c(l,u){return l===void 0&&(l=null),de(l)&&(l=us(l,o.cfg,t,u)),Lr(l||a[Mn](),o.cfg,t,u)}return a[or]=s,a[ei]=c,a}function Cd(r,e,t){var n=Bt(e.config),o=nA(r,n,e,t),i=o.ctx;function a(c){var l=o._next();return l&&l[fn](i,c),!l}function s(c,l){return c===void 0&&(c=null),de(c)&&(c=us(c,n.cfg,e,l)),Cd(c||i[Mn](),e,l)}return i[or]=a,i[ei]=s,i}function up(r,e,t){var n=Bt(e.config),o=nA(r,n,e,t),i=o.ctx;function a(c){return i.iterate(function(l){ce(l[$c])&&l[$c](i,c)})}function s(c,l){return c===void 0&&(c=null),de(c)&&(c=us(c,n.cfg,e,l)),up(c||i[Mn](),e,l)}return i[or]=a,i[ei]=s,i}function us(r,e,t,n){var o=null,i=!n;if(de(r)&&r[me]>0){var a=null;j(r,function(s){if(!i&&n===s&&(i=!0),i&&s&&ce(s[mn])){var c=iU(s,e,t);o||(o=c),a&&a._setNext(c),a=c}})}return n&&!o?us([n],e,t):o}function iU(r,e,t){var n=null,o=ce(r[mn]),i=ce(r[ts]),a;r?a=r[Zo]+"-"+r[Jc]+"-"+ZD++:a="Unknown-0-"+ZD++;var s={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:u,unload:d,update:h,_id:a,_setNext:function(f){n=f}};function c(){var f;return r&&ce(r[JD])&&(f=r[JD]()),f||(f=Lr(s,e,t)),f}function l(f,p,m,_,T){var E=!1,y=r?r[Zo]:nU,A=f[XD];return A||(A=f[XD]={}),f.setNext(n),r&&ls(f[It](),function(){return y+":"+m},function(){A[a]=!0;try{var w=n?n._id:Ce;w&&(A[w]=!1),E=p(f)}catch(S){var O=n?A[n._id]:!0;O&&(E=!0),(!n||!O)&&q(f[pn](),1,73,"Plugin ["+y+"] failed during "+m+" - "+G(S)+", run flags: "+G(A))}},_,T),E}function u(f,p){p=p||c();function m(_){if(!r||!o)return!1;var T=Vi(r);return T[xn]||T[$f]?!1:(i&&r[ts](n),r[mn](f,_),!0)}l(p,m,"processTelemetry",function(){return{item:f}},!f.sync)||p[or](f)}function d(f,p){function m(){var _=!1;if(r){var T=Vi(r),E=r[It]||T[It];r&&(!E||E===f.core())&&!T[xn]&&(T[It]=null,T[xn]=!0,T[hn]=!1,r[xn]&&r[xn](f,p)===!0&&(_=!0))}return _}l(f,m,"unload",function(){},p[Io])||f[or](p)}function h(f,p){function m(){var _=!1;if(r){var T=Vi(r),E=r[It]||T[It];r&&(!E||E===f.core())&&!T[xn]&&r[$c]&&r[$c](f,p)===!0&&(_=!0)}return _}l(f,m,"update",function(){},!1)||f[or](p)}return Co(s)}function Tv(){var r=[];function e(n){n&&r[Oe](n)}function t(n,o){j(r,function(i){try{i(n,o)}catch(a){q(n[pn](),2,73,"Unexpected error calling unload handler - "+G(a))}}),r=[]}return{add:e,run:t}}function yv(){var r=[];function e(n){var o=r;r=[],j(o,function(i){try{(i.rm||i.remove).call(i)}catch(a){q(n,2,73,"Unloading:"+G(a))}})}function t(n){n&&Jo(r,n)}return{run:e,add:t}}var oA,ds="getPlugin",aU=(oA={},oA[Gi]={isVal:pd,v:{}},oA),wo=function(){function r(){var e=this,t,n,o,i,a;l(),Ne(r,e,function(u){u[Wc]=function(d,h,f,p){c(d,h,p),t=!0},u[xn]=function(d,h){var f,p=u[It];if(!p||d&&p!==d[It]())return;var m,_=!1,T=d||Cd(null,p,o&&o[ds]?o[ds]():o),E=h||(f={reason:0},f[Io]=!1,f);function y(){_||(_=!0,i.run(T,h),a.run(T[pn]()),m===!0&&T[or](E),l())}return!u[id]||u[id](T,E,y)!==!0?y():m=!0,m},u[$c]=function(d,h){var f=u[It];if(!f||d&&f!==d[It]())return;var p,m=!1,_=d||up(null,f,o&&o[ds]?o[ds]():o),T=h||{reason:0};function E(){m||(m=!0,c(_.getCfg(),_.core(),_[Mn]()))}return!u._doUpdate||u._doUpdate(_,T,E)!==!0?E():p=!0,p},el(u,"_addUnloadCb",function(){return i},"add"),el(u,"_addHook",function(){return a},"add"),ve(u,"_unloadHooks",{g:function(){return a}})}),e[pn]=function(u){return s(u)[pn]()},e[hn]=function(){return t},e.setInitialized=function(u){t=u},e[ts]=function(u){o=u},e[or]=function(u,d){d?d[or](u):o&&ce(o[mn])&&o[mn](u,null)},e._getTelCtx=s;function s(u){u===void 0&&(u=null);var d=u;if(!d){var h=n||Lr(null,{},e[It]);o&&o[ds]?d=h[ei](null,o[ds]):d=h[ei](null,o)}return d}function c(u,d,h){Bt(u,aU,Un(d)),!h&&d&&(h=d[z_]()[Mn]());var f=o;o&&o[ds]&&(f=o[ds]()),e[It]=d,n=Lr(h,u,d,f)}function l(){t=!1,e[It]=null,n=null,o=null,a=yv(),i=Tv()}}return r.__ieDyn=1,r}();function sU(r,e,t){var n={id:e,fn:t};Jo(r,n);var o={remove:function(){j(r,function(i,a){if(i.id===n.id)return r[eo](a,1),-1})}};return o}function cU(r,e,t){for(var n=!1,o=r[me],i=0;i<o;++i){var a=r[i];if(a)try{if(a.fn[Zn](null,[e])===!1){n=!0;break}}catch(s){q(t,2,64,"Telemetry initializer failed: "+we(s),{exception:G(s)},!0)}}return!n}var eP=function(r){xr(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,o;i(),Ne(e,t,function(a,s){a.addTelemetryInitializer=function(c){return sU(o,n++,c)},a[mn]=function(c,l){cU(o,c,l?l[pn]():a[pn]())&&a[or](c,l)},a[id]=function(){i()}});function i(){n=0,o=[]}return t}return e.__ieDyn=1,e}(wo);var hs,oP="Plugins must provide initialize method",lU="_notificationManager",tP="SDK is still unloading...",uU="SDK is not initialized",iA=Qr((hs={cookieCfg:{}},hs[Xc]={rdOnly:!0,ref:!0,v:[]},hs[os]={rdOnly:!0,ref:!0,v:[]},hs[Gi]={ref:!0,v:{}},hs[Z_]=Ln,hs.loggingLevelConsole=0,hs.diagnosticLogInterval=Ln,hs));function dU(r,e){return new ZS(e)}function hU(r,e,t){var n,o=[],i=[],a={};return j(t,function(s){(H(s)||H(s[Wc]))&&Jt(oP);var c=s[Jc],l=s[Zo];s&&c&&(H(a[c])?a[c]=l:Ro(r,"Two extensions have same priority #"+c+" - "+a[c]+", "+l)),!c||c<e?o[Oe](s):i[Oe](s)}),n={},n[It]=o,n[os]=i,n}function rP(r,e){var t=!1;return j(e,function(n){if(n===r)return t=!0,-1}),t}function aA(r,e,t,n){t&&ue(t,function(o,i){n&&nr(i)&&nr(e[o])&&aA(r,e[o],i,n),n&&nr(i)&&nr(e[o])?aA(r,e[o],i,n):r.set(e,o,i)})}function nP(r,e){var t=null,n=-1;return j(r,function(o,i){if(o.w===e)return t=o,n=i,-1}),{i:n,l:t}}function fU(r,e){var t=nP(r,e).l;return t||(t={w:e,rm:function(){var n=nP(r,e);n.i!==-1&&r[eo](n.i,1)}},r[Oe](t)),t}function pU(r,e,t){j(e,function(n){var o=Je(r,n.w,t);delete n.w,n.rm=function(){o.rm()}})}var sA=function(){function r(){var e,t,n,o,i,a,s,c,l,u,d,h,f,p,m,_,T,E,y,A,w,O,S,K,ne,_e,Ct,Ze;Ne(r,this,function(z){L(),z._getDbgPlgTargets=function(){return[S]},z[hn]=function(){return t},z[Wc]=function(P,Z,ge,he){f&&Jt(tP),z[hn]()&&Jt("Core cannot be initialized more than once"),e=Bt(P,iA,ge||z[nt],!1),P=e.cfg,He(e[Jn](function($e){w=$e.cfg.instrumentationKey;var gt=$e.ref($e.cfg,Gi);ue(gt,function(Ot){$e.ref(gt,Ot)}),H(w)&&Jt("Please provide instrumentation key")})),i=he,W(),ke(),z[nt]=ge;var fe=P[Xc];if(u=[],u[Oe].apply(u,K_(K_([],Z,!1),fe,!1)),d=P[os],oe(null),(!h||h[me]===0)&&Jt("No "+os+" available"),d&&d[me]>1){var We=z[Xa]("TeeChannelController");(!We||!We.plugin)&&q(n,1,28,"TeeChannel required")}pU(P,O,n),O=null,t=!0,z.releaseQueue(),z[hS]()},z.getChannels=function(){var P=[];return h&&j(h,function(Z){P[Oe](Z)}),Co(P)},z.track=function(P){ls(z[fd](),function(){return"AppInsightsCore:track"},function(){P===null&&(Fe(P),Jt("Invalid telemetry item")),!P[Jr]&&H(P[Jr])&&(Fe(P),Jt("telemetry name required")),P.iKey=P.iKey||w,P[Ja]=P[Ja]||to(new Date),P.ver=P.ver||"4.0",!f&&z[hn]()?re()[or](P):o[Oe](P)},function(){return{item:P}},!P.sync)},z[z_]=re,z[ed]=function(){return i||(i=new VD(e.cfg),z[lU]=i),i},z[td]=function(P){z[ed]()[td](P)},z[rd]=function(P){i&&i[rd](P)},z.getCookieMgr=function(){return c||(c=al(e.cfg,z[nt])),c},z.setCookieMgr=function(P){c!==P&&(qi(c,!1),c=P)},z[fd]=function(){return!a&&!s&&He(e[Jn](function(P){if(P.cfg.enablePerfMgr){var Z=P.cfg[Z_];ce(Z)&&(s=Z(z,z[ed]()))}})),a||s||eA()},z.setPerfMgr=function(P){a=P},z.eventCnt=function(){return o[me]},z.releaseQueue=function(){if(t&&o[me]>0){var P=o;o=[],j(P,function(Z){re()[or](Z)})}},z[hS]=function(P){return m=P||null,Ze=!1,_e&&_e[jc](),M(!0)};function M(P){if((!_e||!_e[Za])&&!Ze){var Z=P||n&&n.queue[me]>0;Z&&(Ct||(Ct=!0,He(e[Jn](function(ge){var he=ge.cfg.diagnosticLogInterval;(!he||!(he>0))&&(he=1e4);var fe=!1;_e&&(fe=_e[Za],_e[jc]()),_e=JC(B,he),_e.unref(),_e[Za]=fe}))),_e[Za]=!0)}return _e}z[fS]=function(){Ze=!0,_e&&_e[jc](),B()},as(z,function(){return p},["addTelemetryInitializer"]),z[fn]=function(P,Z,ge){var he;P===void 0&&(P=!0),t||Jt(uU),f&&Jt(tP);var fe=(he={reason:50},he[Io]=P,he.flushComplete=!1,he),We;P&&!Z&&(We=Mr(function(Ot){Z=Ot}));var $e=Cd(Le(),z);$e[Bf](function(){E.run(z[nt]),hv([c,i,n],P,function(){L(),Z&&Z(fe)})},z);function gt(Ot){fe.flushComplete=Ot,f=!0,T.run($e,fe),z[fS](),$e[or](fe)}return B(),V(P,gt,6,ge)||gt(!1),We},z[Xa]=le,z.addPlugin=function(P,Z,ge,he){if(!P){he&&he(!1),Ee(oP);return}var fe=le(P[Zo]);if(fe&&!Z){he&&he(!1),Ee("Plugin ["+P[Zo]+"] is already loaded!");return}var We={reason:16};function $e(Kr){u[Oe](P),We.added=[P],oe(We),he&&he(!0)}if(fe){var gt=[fe.plugin],Ot={reason:2,isAsync:!!ge};b(gt,Ot,function(Kr){Kr?(We.removed=gt,We.reason|=32,$e(!0)):he&&he(!1)})}else $e(!1)},z.updateCfg=function(P,Z){Z===void 0&&(Z=!0);var ge;if(z[hn]()){ge={reason:1,cfg:e.cfg,oldCfg:D_({},e.cfg),newConfig:D_({},P),merge:Z},P=ge.newConfig;var he=e.cfg;P[Xc]=he[Xc],P[os]=he[os]}e._block(function(fe){var We=fe.cfg;aA(fe,We,P,Z),Z||ue(We,function($e){un(P,$e)||fe.set(We,$e,Ln)}),fe[Ao](We,iA)},!0),e[Vc](),ge&&et(ge)},z.evtNamespace=function(){return _},z.flush=V,z.getTraceCtx=function(P){return A||(A=QD()),A},z.setTraceCtx=function(P){A=P||null},z.addUnloadHook=He,el(z,"addUnloadCb",function(){return T},"add"),z.onCfgChange=function(P){var Z;return t?Z=Je(e.cfg,P,z[nt]):Z=fU(O,P),{rm:function(){Z.rm()}}},z.getWParam=function(){return $u()||e.cfg.enableWParam?0:-1};function Ir(){var P={};K=[];var Z=function(ge){ge&&j(ge,function(he){if(he[Zo]&&he[nd]&&!P[he.identifier]){var fe=he[Zo]+"="+he[nd];K[Oe](fe),P[he.identifier]=he}})};Z(h),d&&j(d,function(ge){Z(ge)}),Z(u)}function L(){t=!1,e=Bt({},iA,z[nt]),e.cfg[V_]=1,ve(z,"config",{g:function(){return e.cfg},s:function(Z){z.updateCfg(Z,!1)}}),ve(z,"pluginVersionStringArr",{g:function(){return K||Ir(),K}}),ve(z,"pluginVersionString",{g:function(){return ne||(K||Ir(),ne=K.join(";")),ne||Ce}}),ve(z,"logger",{g:function(){return n||(n=new Td(e.cfg),e[nt]=n),n},s:function(Z){e[nt]=Z,n!==Z&&(qi(n,!1),n=Z)}}),z[nt]=new Td(e.cfg),S=[];var P=z.config[Xc]||[];P.splice(0,P[me]),Jo(P,S),p=new eP,o=[],qi(i,!1),i=null,a=null,s=null,qi(c,!1),c=null,l=null,u=[],d=null,h=null,f=!1,m=null,_=sr("AIBaseCore",!0),T=Tv(),A=null,w=null,E=yv(),O=[],ne=null,K=null,Ze=!1}function re(){var P=Lr(Le(),e.cfg,z);return P[Bf](M),P}function oe(P){var Z=hU(z[nt],DD,u);l=null,ne=null,K=null,h=(d||[])[0]||[],h=Ev(Jo(h,Z[os]));var ge=Jo(Ev(Z[It]),h);S=Co(ge);var he=z.config[Xc]||[];he.splice(0,he[me]),Jo(he,S);var fe=re();h&&h[me]>0&&rA(fe[ei](h),ge),rA(fe,ge),P&&et(P)}function le(P){var Z=null,ge=null,he=[];return j(S,function(fe){if(fe[Zo]===P&&fe!==p)return ge=fe,-1;fe.getChannel&&he[Oe](fe)}),!ge&&he[me]>0&&j(he,function(fe){if(ge=fe.getChannel(P),!ge)return-1}),ge&&(Z={plugin:ge,setEnabled:function(fe){Vi(ge)[$f]=!fe},isEnabled:function(){var fe=Vi(ge);return!fe[xn]&&!fe[$f]},remove:function(fe,We){var $e;fe===void 0&&(fe=!0);var gt=[ge],Ot=($e={reason:1},$e[Io]=fe,$e);b(gt,Ot,function(Kr){Kr&&oe({reason:32,removed:gt}),We&&We(Kr)})}}),Z}function Le(){if(!l){var P=(S||[]).slice();ut(P,p)===-1&&P[Oe](p),l=us(Ev(P),e.cfg,z)}return l}function b(P,Z,ge){if(P&&P[me]>0){var he=us(P,e.cfg,z),fe=Cd(he,z);fe[Bf](function(){var We=!1,$e=[];j(u,function(Ot,Kr){rP(Ot,P)?We=!0:$e[Oe](Ot)}),u=$e,ne=null,K=null;var gt=[];d&&(j(d,function(Ot,Kr){var I=[];j(Ot,function(v){rP(v,P)?We=!0:I[Oe](v)}),gt[Oe](I)}),d=gt),ge&&ge(We),M()}),fe[or](Z)}else ge(!1)}function B(){if(n&&n.queue){var P=n.queue.slice(0);n.queue[me]=0,j(P,function(Z){var ge,he=(ge={},ge[Jr]=m||"InternalMessageId: "+Z[od],ge.iKey=w,ge[Ja]=to(new Date),ge.baseType=zi.dataType,ge.baseData={message:Z[es]},ge);z.track(he)})}}function V(P,Z,ge,he){var fe=1,We=!1,$e=null;he=he||5e3;function gt(){fe--,We&&fe===0&&($e&&$e[jc](),$e=null,Z&&Z(We),Z=null)}if(h&&h[me]>0){var Ot=re()[ei](h);Ot.iterate(function(Kr){if(Kr.flush){fe++;var I=!1;Kr.flush(P,function(){I=!0,gt()},ge)||I||(P&&$e==null?$e=Ht(function(){$e=null,gt()},he):gt())}})}return We=!0,gt(),!0}function W(){!i&&z[ed](),He(e[Jn](function(P){var Z=P.cfg.disableDbgExt;Z===!0&&y&&(i[rd](y),y=null),i&&!y&&Z!==!0&&(y=PD(P.cfg),i[td](y))}))}function ke(){He(e[Jn](function(P){var Z=P.cfg.enablePerfMgr;!Z&&s&&(s=null),Z&&ar(P.cfg,Z_,dU)}))}function et(P){var Z=up(Le(),z);Z[Bf](M),(!z._updateHook||z._updateHook(Z,P)!==!0)&&Z[or](P)}function Ee(P){var Z=z[nt];Z?(q(Z,2,73,P),M()):Jt(P)}function Fe(P){var Z=z[ed]();Z&&Z[is]([P],2)}function He(P){E.add(P)}})}return r.__ieDyn=1,r}();var dP="on",iP="attachEvent",aP="addEventListener",sP="detachEvent",cP="removeEventListener",cA="events",lA="visibilitychange",Iv="pagehide";var hP="unload",fP="beforeunload",pP=sr("aiEvtPageHide"),k7=sr("aiEvtPageShow"),mU=/\.[\.]+/g,gU=/[\.]+$/,_U=1,Cv=av("events"),vU=/^([^.]*)(?:\.(.+)|)/;function lP(r){return r&&r[Ki]?r[Ki](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Ce):r}function uA(r,e){var t;if(e){var n=Ce;de(e)?(n=Ce,j(e,function(i){i=lP(i),i&&(i[0]!=="."&&(i="."+i),n+=i)})):n=lP(e),n&&(n[0]!=="."&&(n="."+n),r=(r||Ce)+n)}var o=vU.exec(r||Ce)||[];return t={},t[ti]=o[1],t.ns=(o[2]||Ce).replace(mU,".").replace(gU,Ce)[rs](".").sort().join("."),t}function mP(r,e,t){t===void 0&&(t=!0);var n=Cv.get(r,cA,{},t),o=n[e];return o||(o=n[e]=[]),o}function gP(r,e,t,n){r&&e&&e[ti]&&(r[cP]?r[cP](e[ti],t,n):r[sP]&&r[sP](dP+e[ti],t))}function EU(r,e,t,n){var o=!1;return r&&e&&e[ti]&&t&&(r[aP]?(r[aP](e[ti],t,n),o=!0):r[iP]&&(r[iP](dP+e[ti],t),o=!0)),o}function uP(r,e,t,n){for(var o=e[me];o--;){var i=e[o];i&&(!t.ns||t.ns===i.evtName.ns)&&(!n||n(i))&&(gP(r,i.evtName,i[W_],i.capture),e[eo](o,1))}}function TU(r,e,t){if(e[ti])uP(r,mP(r,e[ti]),e,t);else{var n=Cv.get(r,cA,{});ue(n,function(o,i){uP(r,i,e,t)}),$r(n)[me]===0&&Cv.kill(r,cA)}}function Yn(r,e){var t;return e?(de(e)?t=[r].concat(e):t=[r,e],t=uA("xx",t).ns[rs](".")):t=r,t}function ro(r,e,t,n,o){var i;o===void 0&&(o=!1);var a=!1;if(r)try{var s=uA(e,n);if(a=EU(r,s,t,o),a&&Cv.accept(r)){var c=(i={guid:_U++,evtName:s},i[W_]=t,i.capture=o,i);mP(r,s.type)[Oe](c)}}catch{}return a}function fs(r,e,t,n,o){if(o===void 0&&(o=!1),r)try{var i=uA(e,n),a=!1;TU(r,i,function(s){return i.ns&&!t||s[W_]===t?(a=!0,!0):!1}),a||gP(r,i,t,o)}catch{}}function _P(r,e,t){var n=!1,o=tr();o&&(n=ro(o,r,e,t),n=ro(o.body,r,e,t)||n);var i=lt();return i&&(n=ro(i,r,e,t)||n),n}function vP(r,e,t){var n=tr();n&&(fs(n,r,e,t),fs(n.body,r,e,t));var o=lt();o&&fs(o,r,e,t)}function Sv(r,e,t,n){var o=!1;return e&&r&&r[me]>0&&j(r,function(i){i&&(!t||ut(t,i)===-1)&&(o=_P(i,e,n)||o)}),o}function EP(r,e,t,n){var o=!1;return e&&r&&de(r)&&(o=Sv(r,e,t,n),!o&&t&&t[me]>0&&(o=Sv(r,e,null,n))),o}function Av(r,e,t){r&&de(r)&&j(r,function(n){n&&vP(n,e,t)})}function dA(r,e,t){return EP([fP,hP,Iv],r,e,t)}function hA(r,e){Av([fP,hP,Iv],r,e)}function dp(r,e,t){function n(a){var s=lt();r&&s&&s.visibilityState==="hidden"&&r(a)}var o=Yn(pP,t),i=Sv([Iv],r,e,o);return(!e||ut(e,lA)===-1)&&(i=Sv([lA],n,e,o)||i),!i&&e&&(i=dp(r,null,t)),i}function fA(r,e){var t=Yn(pP,e);Av([Iv],r,t),Av([lA],null,t)}var TP="_aiHooks",yP=["req","rsp","hkErr","fnErr"];function mA(r,e){if(r)for(var t=0;t<r[me]&&!e(r[t],t);t++);}function pA(r,e,t,n,o){o>=0&&o<=2&&mA(r,function(i,a){var s=i.cbks,c=s[yP[o]];if(c){e.ctx=function(){var d=n[a]=n[a]||{};return d};try{c[Zn](e.inst,t)}catch(d){var l=e.err;try{var u=s[yP[2]];u&&(e.err=d,u[Zn](e.inst,t))}catch{}finally{e.err=l}}}})}function yU(r){return function(){var e,t=this,n=arguments,o=r.h,i=(e={},e[Jr]=r.n,e.inst=t,e.ctx=null,e.set=l,e),a=[],s=c([i],n);i.evt=At("event");function c(d,h){return mA(h,function(f){d[Oe](f)}),d}function l(d,h){n=c([],n),n[d]=h,s=c([i],n)}pA(o,i,s,a,0);var u=r.f;if(u)try{i.rslt=u[Zn](t,n)}catch(d){throw i.err=d,pA(o,i,s,a,3),d}return pA(o,i,s,a,1),i.rslt}}function gA(r,e,t,n){var o=null;return r&&(Xt(r,e)?o=r:t&&(o=gA(fD(r),e,n,!1))),o}function _A(r,e,t){return r?hp(r[kr],e,t,!1):null}function CP(r,e,t,n){var o=t&&t[TP];if(!o){o={i:0,n:e,f:t,h:[]};var i=yU(o);i[TP]=o,r[e]=i}var a={id:o.i,cbks:n,rm:function(){var s=this.id;mA(o.h,function(c,l){if(c.id===s)return o.h[eo](l,1),1})}};return o.i++,o.h[Oe](a),a}function hp(r,e,t,n,o){if(n===void 0&&(n=!0),r&&e&&t){var i=gA(r,e,n,o);if(i){var a=i[e];if(typeof a===Xu)return CP(i,e,a,t)}}return null}function Sd(r,e,t,n,o){if(r&&e&&t){var i=gA(r,e,n,o)||r;if(i)return CP(i,e,i[e],t)}return null}var ai="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",fp="sampleRate",pp="ProcessLegacy",Nv="http.method",ul="https://dc.services.visualstudio.com",ji="/v2/track",Kt="not_specified",Rv="iKey";var ot=dS({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]});var Wi="split",Se="length",$i="toLowerCase",mp="ingestionendpoint",Qi="toString",wv="removeItem",Gt="name",Xi="message",SP="count";var gp="stringify",_p="pathname",vA="correlationHeaderExcludePatterns";var dl="exceptions",no="parsedStack",Ur="properties",Fr="measurements",hl="sizeInBytes",si="typeName",fl="severityLevel",bv="problemGroup",Dv="isManual",EA="CreateFromInterface",pl="assembly",vp="hasFullStack",Ep="level",ml="method",Ad="fileName",Id="line",gl="duration",TA="receivedResponse";function yA(r,e,t){var n=e[Se],o=AP(r,e);if(o[Se]!==n){for(var i=0,a=o;t[a]!==void 0;)i++,a=Sr(o,0,147)+IP(i);o=a}return o}function AP(r,e){var t;return e&&(e=Lt(Zt(e)),e[Se]>150&&(t=Sr(e,0,150),q(r,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),t||e}function je(r,e,t){t===void 0&&(t=1024);var n;return e&&(t=t||1024,e=Lt(Zt(e)),e[Se]>t&&(n=Sr(e,0,t),q(r,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:e},!0))),n||e}function Ji(r,e){return AA(r,e,2048,66)}function Tp(r,e){var t;return e&&e[Se]>32768&&(t=Sr(e,0,32768),q(r,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),t||e}function CA(r,e){var t;if(e){var n=""+e;n[Se]>32768&&(t=Sr(n,0,32768),q(r,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return t||e}function Zr(r,e){if(e){var t={};ue(e,function(n,o){if(bt(o)&&ni())try{o=_r()[gp](o)}catch(i){q(r,2,49,"custom property is not valid",{exception:i},!0)}o=je(r,o,8192),n=yA(r,n,t),t[n]=o}),e=t}return e}function en(r,e){if(e){var t={};ue(e,function(n,o){n=yA(r,n,t),t[n]=o}),e=t}return e}function SA(r,e){return e&&AA(r,e,128,69)[Qi]()}function AA(r,e,t,n){var o;return e&&(e=Lt(Zt(e)),e[Se]>t&&(o=Sr(e,0,t),q(r,2,n,"input is too long, it has been truncated to "+t+" characters.",{data:e},!0))),o||e}function IP(r){var e="00"+r;return Xn(e,e[Se]-3)}var NP=lt()||{},RP=0,NU=[null,null,null,null,null];function yp(r){var e=RP,t=NU,n=t[e];return NP.createElement?t[e]||(n=t[e]=NP.createElement("a")):n={host:wP(r,!0)},n.href=r,e++,e>=t[Se]&&(e=0),RP=e,n}function IA(r){var e,t=yp(r);return t&&(e=t.href),e}function NA(r,e){return r?r.toUpperCase()+" "+e:e}function wP(r,e){var t=Pv(r,e)||"";if(t){var n=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Se]>3&&ae(n[2])&&n[2][Se]>0)return n[2]+(n[3]||"")}return t}function Pv(r,e){var t=null;if(r){var n=r.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Se]>2&&ae(n[2])&&n[2][Se]>0&&(t=n[2]||"",e&&n[Se]>2)){var o=(n[1]||"")[$i](),i=n[3]||"";(o==="http"&&i===":80"||o==="https"&&i===":443")&&(i=""),t+=i}}return t}var RU=[ul+ji,"https://breeze.aimon.applicationinsights.io"+ji,"https://dc-int.services.visualstudio.com"+ji],wU="cid-v1:";function _l(r){return ut(RU,r[$i]())!==-1}function Ov(r,e,t){if(!e||r&&r.disableCorrelationHeaders)return!1;if(r&&r[vA]){for(var n=0;n<r.correlationHeaderExcludePatterns[Se];n++)if(r[vA][n].test(e))return!1}var o=yp(e).host[$i]();if(o&&(Tt(o,":443")!==-1||Tt(o,":80")!==-1)&&(o=(Pv(e,!0)||"")[$i]()),(!r||!r.enableCorsCorrelation)&&o&&o!==t)return!1;var i=r&&r.correlationHeaderDomains;if(i){var a;if(j(i,function(l){var u=new RegExp(l.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||u.test(o)}),!a)return!1}var s=r&&r.correlationHeaderExcludedDomains;if(!s||s[Se]===0)return!0;for(var n=0;n<s[Se];n++){var c=new RegExp(s[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(c.test(o))return!1}return o&&o[Se]>0}function kv(r){if(r){var e=bP(r,ot[1]);if(e&&e!==wU)return e}}function bP(r,e){if(r)for(var t=r[Wi](","),n=0;n<t[Se];++n){var o=t[n][Wi]("=");if(o[Se]===2&&o[0]===e)return o[1]}}function DP(r,e,t,n){var o,i=n,a=n;if(e&&e[Se]>0){var s=yp(e);if(o=s.host,!i)if(s[_p]!=null){var c=s.pathname[Se]===0?"/":s[_p];c.charAt(0)!=="/"&&(c="/"+c),a=s[_p],i=je(r,t?t+" "+c:c)}else i=je(r,e)}else o=n,i=n;return{target:o,name:i,data:a}}function Nd(){var r=dn();if(r&&r.now&&r.timing){var e=r.now()+r.timing.navigationStart;if(e>0)return e}return rr()}function cr(r,e){var t=null;return r!==0&&e!==0&&!H(r)&&!H(e)&&(t=e-r),t}function vl(r,e){var t=r||{};return{getName:function(){return t[Gt]},setName:function(n){e&&e.setName(n),t[Gt]=n},getTraceId:function(){return t.traceID},setTraceId:function(n){e&&e.setTraceId(n),cl(n)&&(t.traceID=n)},getSpanId:function(){return t.parentID},setSpanId:function(n){e&&e.setSpanId(n),ll(n)&&(t.parentID=n)},getTraceFlags:function(){return t.traceFlags},setTraceFlags:function(n){e&&e.setTraceFlags(n),t.traceFlags=n}}}var Rd=G_({LocalStorage:0,SessionStorage:1}),W9=G_({AI:0,AI_AND_W3C:1,W3C:2});var ps=void 0,ms=void 0;function RA(){return Cp()?xv(Rd.LocalStorage):null}function xv(r){try{if(H(Pr()))return null;var e=new Date()[Qi](),t=At(r===Rd.LocalStorage?"localStorage":"sessionStorage");t.setItem(e,e);var n=t.getItem(e)!==e;if(t[wv](e),!n)return t}catch{}return null}function wA(){return gs()?xv(Rd.SessionStorage):null}function bA(){ps=!1,ms=!1}function DA(){ps=Cp(!0),ms=gs(!0)}function Cp(r){return(r||ps===void 0)&&(ps=!!xv(Rd.LocalStorage)),ps}function PA(r,e){var t=RA();if(t!==null)try{return t.getItem(e)}catch(n){ps=!1,q(r,2,1,"Browser failed read of local storage. "+we(n),{exception:G(n)})}return null}function OA(r,e,t){var n=RA();if(n!==null)try{return n.setItem(e,t),!0}catch(o){ps=!1,q(r,2,3,"Browser failed write to local storage. "+we(o),{exception:G(o)})}return!1}function kA(r,e){var t=RA();if(t!==null)try{return t[wv](e),!0}catch(n){ps=!1,q(r,2,5,"Browser failed removal of local storage item. "+we(n),{exception:G(n)})}return!1}function gs(r){return(r||ms===void 0)&&(ms=!!xv(Rd.SessionStorage)),ms}function wd(r,e){var t=wA();if(t!==null)try{return t.getItem(e)}catch(n){ms=!1,q(r,2,2,"Browser failed read of session storage. "+we(n),{exception:G(n)})}return null}function Sp(r,e,t){var n=wA();if(n!==null)try{return n.setItem(e,t),!0}catch(o){ms=!1,q(r,2,4,"Browser failed write to session storage. "+we(o),{exception:G(o)})}return!1}function xA(r,e){var t=wA();if(t!==null)try{return t[wv](e),!0}catch(n){ms=!1,q(r,2,6,"Browser failed removal of session storage item. "+we(n),{exception:G(n)})}return!1}var bU=";",DU="=";function MA(r){if(!r)return{};var e=r[Wi](bU),t=w_(e,function(o,i){var a=i[Wi](DU);if(a[Se]===2){var s=a[0][$i](),c=a[1];o[s]=c}return o},{});if($r(t)[Se]>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t[mp]=t[mp]||"https://"+n+"dc."+t.endpointsuffix}t[mp]=t[mp]||ul}return t}var LA=function(){function r(e,t,n){var o=this,i=this;i.ver=1,i.sampleRate=100,i.tags={},i[Gt]=je(e,n)||Kt,i.data=t,i.time=to(new Date),i.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1}}return r}();var oo=function(){function r(e,t,n,o){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var i=this;i.ver=2,i[Gt]=je(e,t)||Kt,i[Ur]=Zr(e,n),i[Fr]=en(e,o)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Event",r.dataType="EventData",r}();var PU="<no_method>",bd="error",_n="stack",FA="stackDetails",PP="errorSrc",YA="message",xP="description";function HA(r,e){var t=r;return t&&!ae(t)&&(JSON&&JSON[gp]?(t=JSON[gp](r),e&&(!t||t==="{}")&&(ce(r[Qi])?t=r[Qi]():t=""+r)):t=""+r+" - (Missing JSON.stringify)"),t||""}function MP(r,e){var t=r;return r&&(t&&!ae(t)&&(t=r[YA]||r[xP]||t),t&&!ae(t)&&(t=HA(t,!0)),r.filename&&(t=t+" @"+(r.filename||"")+":"+(r.lineno||"?")+":"+(r.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&Tt(t||"",e)===-1&&(t=e+": "+t),t||""}function OU(r){try{if(bt(r))return"hasFullStack"in r&&"typeName"in r}catch{}return!1}function kU(r){try{if(bt(r))return"ver"in r&&"exceptions"in r&&"properties"in r}catch{}return!1}function OP(r){return r&&r.src&&ae(r.src)&&r.obj&&de(r.obj)}function El(r){var e=r||"";ae(e)||(ae(e[_n])?e=e[_n]:e=""+e);var t=e[Wi](`
`);return{src:e,obj:t}}function xU(r){for(var e=[],t=r[Wi](`
`),n=0;n<t[Se];n++){var o=t[n];t[n+1]&&(o+="@"+t[n+1],n++),e.push(o)}return{src:r,obj:e}}function LP(r){var e=null;if(r)try{if(r[_n])e=El(r[_n]);else if(r[bd]&&r[bd][_n])e=El(r[bd][_n]);else if(r.exception&&r.exception[_n])e=El(r.exception[_n]);else if(OP(r))e=r;else if(OP(r[FA]))e=r[FA];else if(window&&window.opera&&r[YA])e=xU(r[Xi]);else if(r.reason&&r.reason[_n])e=El(r.reason[_n]);else if(ae(r))e=El(r);else{var t=r[YA]||r[xP]||"";ae(r[PP])&&(t&&(t+=`
`),t+=" from "+r[PP]),t&&(e=El(t))}}catch(n){e=El(n)}return e||{src:"",obj:null}}function MU(r){var e="";return r&&(r.obj?j(r.obj,function(t){e+=t+`
`}):e=r.src||""),e}function LU(r){var e,t=r.obj;if(t&&t[Se]>0){e=[];var n=0,o=0;j(t,function(p){var m=p[Qi]();if(BA.regex.test(m)){var _=new BA(m,n++);o+=_[hl],e.push(_)}});var i=32*1024;if(o>i)for(var a=0,s=e[Se]-1,c=0,l=a,u=s;a<s;){var d=e[a][hl],h=e[s][hl];if(c+=d+h,c>i){var f=u-l+1;e.splice(l,f);break}l=a,u=s,a++,s--}}return e}function Mv(r){var e="";if(r&&(e=r.typeName||r[Gt]||"",!e))try{var t=/function (.{1,200})\(/,n=t.exec(r.constructor[Qi]());e=n&&n[Se]>1?n[1]:""}catch{}return e}function UA(r){if(r)try{if(!ae(r)){var e=Mv(r),t=HA(r,!1);return(!t||t==="{}")&&(r[bd]&&(r=r[bd],e=Mv(r)),t=HA(r,!0)),Tt(t,e)!==0&&e!=="String"?e+":"+t:t}}catch{}return""+(r||"")}var Yr=function(){function r(e,t,n,o,i,a){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var s=this;s.ver=2,kU(t)?(s[dl]=t[dl]||[],s[Ur]=t[Ur],s[Fr]=t[Fr],t[fl]&&(s[fl]=t[fl]),t.id&&(s.id=t.id),t[bv]&&(s[bv]=t[bv]),H(t[Dv])||(s[Dv]=t[Dv])):(n||(n={}),s[dl]=[new kP(e,t,n)],s[Ur]=Zr(e,n),s[Fr]=en(e,o),i&&(s[fl]=i),a&&(s.id=a))}return r.CreateAutoException=function(e,t,n,o,i,a,s,c){var l,u=Mv(i||a||e);return l={},l[Xi]=MP(e,u),l.url=t,l.lineNumber=n,l.columnNumber=o,l.error=UA(i||a||e),l.evt=UA(a||e),l[si]=u,l.stackDetails=LP(s||i||a),l.errorSrc=c,l},r.CreateFromInterface=function(e,t,n,o){var i=t[dl]&&Wa(t[dl],function(s){return kP[EA](e,s)}),a=new r(e,Ut(Ut({},t),{exceptions:i}),n,o);return a},r.prototype.toInterface=function(){var e,t=this,n=t.exceptions,o=t.properties,i=t.measurements,a=t.severityLevel,s=t.problemGroup,c=t.id,l=t.isManual,u=n instanceof Array&&Wa(n,function(d){return d.toInterface()})||void 0;return e={ver:"4.0"},e[dl]=u,e.severityLevel=a,e.properties=o,e.measurements=i,e.problemGroup=s,e.id=c,e.isManual=l,e},r.CreateSimpleException=function(e,t,n,o,i,a){var s;return{exceptions:[(s={},s[vp]=!0,s.message=e,s.stack=i,s.typeName=t,s)]}},r.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",r.dataType="ExceptionData",r.formatError=UA,r}();var kP=function(){function r(e,t,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var o=this;if(OU(t))o[si]=t[si],o[Xi]=t[Xi],o[_n]=t[_n],o[no]=t[no]||[],o[vp]=t[vp];else{var i=t,a=i&&i.evt;$o(i)||(i=i[bd]||a||i),o[si]=je(e,Mv(i))||Kt,o[Xi]=Tp(e,MP(t||i,o[si]))||Kt;var s=t[FA]||LP(t);o[no]=LU(s),de(o[no])&&Wa(o[no],function(c){return c[pl]=je(e,c[pl])}),o[_n]=CA(e,MU(s)),o.hasFullStack=de(o.parsedStack)&&o.parsedStack[Se]>0,n&&(n[si]=n[si]||o[si])}}return r.prototype.toInterface=function(){var e,t=this,n=t[no]instanceof Array&&Wa(t[no],function(i){return i.toInterface()}),o=(e={id:t.id,outerId:t.outerId,typeName:t[si],message:t[Xi],hasFullStack:t[vp],stack:t[_n]},e[no]=n||void 0,e);return o},r.CreateFromInterface=function(e,t){var n=t[no]instanceof Array&&Wa(t[no],function(i){return BA[EA](i)})||t[no],o=new r(e,Ut(Ut({},t),{parsedStack:n}));return o},r}();var BA=function(){function r(e,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[hl]=0,typeof e=="string"){var o=e;n[Ep]=t,n[ml]=PU,n[pl]=Lt(o),n[Ad]="",n[Id]=0;var i=o.match(r.regex);i&&i[Se]>=5&&(n[ml]=Lt(i[2])||n[ml],n[Ad]=Lt(i[4]),n[Id]=parseInt(i[5])||0)}else n[Ep]=e[Ep],n[ml]=e[ml],n[pl]=e[pl],n[Ad]=e[Ad],n[Id]=e[Id],n[hl]=0;n.sizeInBytes+=n.method[Se],n.sizeInBytes+=n.fileName[Se],n.sizeInBytes+=n.assembly[Se],n[hl]+=r.baseSize,n.sizeInBytes+=n.level.toString()[Se],n.sizeInBytes+=n.line.toString()[Se]}return r.CreateFromInterface=function(e){return new r(e,null)},r.prototype.toInterface=function(){var e=this;return{level:e[Ep],method:e[ml],assembly:e[pl],fileName:e[Ad],line:e[Id]}},r.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,r.baseSize=58,r}();var UP=function(){function r(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return r}();var io=function(){function r(e,t,n,o,i,a,s,c,l){this.aiDataContract={ver:1,metrics:1,properties:0};var u=this;u.ver=2;var d=new UP;d[SP]=o>0?o:void 0,d.max=isNaN(a)||a===null?void 0:a,d.min=isNaN(i)||i===null?void 0:i,d[Gt]=je(e,t)||Kt,d.value=n,d.stdDev=isNaN(s)||s===null?void 0:s,u.metrics=[d],u[Ur]=Zr(e,c),u[Fr]=en(e,l)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",r.dataType="MetricData",r}();var Ap="";function Hn(r){(isNaN(r)||r<0)&&(r=0),r=Math.round(r);var e=Ap+r%1e3,t=Ap+Math.floor(r/1e3)%60,n=Ap+Math.floor(r/(1e3*60))%60,o=Ap+Math.floor(r/(1e3*60*60))%24,i=Math.floor(r/(1e3*60*60*24));return e=e[Se]===1?"00"+e:e[Se]===2?"0"+e:e,t=t[Se]<2?"0"+t:t,n=n[Se]<2?"0"+n:n,o=o[Se]<2?"0"+o:o,(i>0?i+".":Ap)+o+":"+n+":"+t+"."+e}function KA(r,e,t,n,o){return!o&&ae(r)&&(r==="Script error."||r==="Script error")}var vn=function(){function r(e,t,n,o,i,a,s){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var c=this;c.ver=2,c.id=SA(e,s),c.url=Ji(e,n),c[Gt]=je(e,t)||Kt,isNaN(o)||(c[gl]=Hn(o)),c[Ur]=Zr(e,i),c[Fr]=en(e,a)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",r.dataType="PageviewData",r}();var ao=function(){function r(e,t,n,o,i,a,s,c,l,u,d,h){l===void 0&&(l="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var f=this;f.ver=2,f.id=t,f[gl]=Hn(i),f.success=a,f.resultCode=s+"",f.type=je(e,l);var p=DP(e,n,c,o);f.data=Ji(e,o)||p.data,f.target=je(e,p.target),u&&(f.target="".concat(f.target," | ").concat(u)),f[Gt]=je(e,p[Gt]),f[Ur]=Zr(e,d),f[Fr]=en(e,h)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",r.dataType="RemoteDependencyData",r}();var ci=function(){function r(e,t,n,o,i){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var a=this;a.ver=2,t=t||Kt,a[Xi]=Tp(e,t),a[Ur]=Zr(e,o),a[Fr]=en(e,i),n&&(a[fl]=n)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Message",r.dataType="MessageData",r}();var li=function(){function r(e,t,n,o,i,a,s){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var c=this;c.ver=2,c.url=Ji(e,n),c[Gt]=je(e,t)||Kt,c[Ur]=Zr(e,i),c[Fr]=en(e,a),s&&(c.domProcessing=s.domProcessing,c[gl]=s[gl],c.networkConnect=s.networkConnect,c.perfTotal=s.perfTotal,c[TA]=s[TA],c.sentRequest=s.sentRequest)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",r.dataType="PageviewPerformanceData",r}();var Zi=function(){function r(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}return r}();function vs(r){var e="ai."+r+".";return function(t){return e+t}}var Ip=vs("application"),lr=vs("device"),Lv=vs("location"),Dd=vs("operation"),GA=vs("session"),_s=vs("user"),Tl=vs("cloud"),Np=vs("internal"),Rp=function(r){xr(e,r);function e(){return r.call(this)||this}return e}(IS({applicationVersion:Ip("ver"),applicationBuild:Ip("build"),applicationTypeId:Ip("typeId"),applicationId:Ip("applicationId"),applicationLayer:Ip("layer"),deviceId:lr("id"),deviceIp:lr("ip"),deviceLanguage:lr("language"),deviceLocale:lr("locale"),deviceModel:lr("model"),deviceFriendlyName:lr("friendlyName"),deviceNetwork:lr("network"),deviceNetworkName:lr("networkName"),deviceOEMName:lr("oemName"),deviceOS:lr("os"),deviceOSVersion:lr("osVersion"),deviceRoleInstance:lr("roleInstance"),deviceRoleName:lr("roleName"),deviceScreenResolution:lr("screenResolution"),deviceType:lr("type"),deviceMachineName:lr("machineName"),deviceVMName:lr("vmName"),deviceBrowser:lr("browser"),deviceBrowserVersion:lr("browserVersion"),locationIp:Lv("ip"),locationCountry:Lv("country"),locationProvince:Lv("province"),locationCity:Lv("city"),operationId:Dd("id"),operationName:Dd("name"),operationParentId:Dd("parentId"),operationRootId:Dd("rootId"),operationSyntheticSource:Dd("syntheticSource"),operationCorrelationVector:Dd("correlationVector"),sessionId:GA("id"),sessionIsFirst:GA("isFirst"),sessionIsNew:GA("isNew"),userAccountAcquisitionDate:_s("accountAcquisitionDate"),userAccountId:_s("accountId"),userAgent:_s("userAgent"),userId:_s("id"),userStoreRegion:_s("storeRegion"),userAuthUserId:_s("authUserId"),userAnonymousUserAcquisitionDate:_s("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:_s("authUserAcquisitionDate"),cloudName:Tl("name"),cloudRole:Tl("role"),cloudRoleVer:Tl("roleVer"),cloudRoleInstance:Tl("roleInstance"),cloudEnvironment:Tl("environment"),cloudLocation:Tl("location"),cloudDeploymentUnit:Tl("deploymentUnit"),internalNodeName:Np("nodeName"),internalSdkVersion:Np("sdkVersion"),internalAgentVersion:Np("agentVersion"),internalSnippet:Np("snippet"),internalSdkSrc:Np("sdkSrc")}));function so(r,e,t,n,o,i){var a;t=je(n,t)||Kt,(H(r)||H(e)||H(t))&&Jt("Input doesn't contain all required fields");var s="";r[Rv]&&(s=r[Rv],delete r[Rv]);var c=(a={},a[Gt]=t,a.time=to(new Date),a.iKey=s,a.ext=i||{},a.tags=[],a.data={},a.baseType=e,a.baseData=r,a);return H(o)||ue(o,function(l,u){c.data[l]=u}),c}var UU=function(){function r(){}return r.create=so,r}();var Hr={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},it=new Rp;function yl(r){var e=null;if(ce(Event))e=new Event(r);else{var t=lt();t&&t.createEvent&&(e=t.createEvent("Event"),e.initEvent(r,!0,!0))}return e}var Es="AppInsightsPropertiesPlugin",Uv="AppInsightsChannelPlugin",FP="ApplicationInsightsAnalytics";var wp="toString",Fv="isStorageUseDisabled",Cl="_addHook",vr="core",ea="dataType",Ts="envelopeType",En="diagLog",ys="track",Pd="trackPageView",bp="trackPreviousPageVisit",ta="sendPageViewInternal",Dp="sendPageViewPerformanceInternal",Od="populatePageViewPerformanceEvent",Cs="href",qA="sendExceptionInternal",Yv="exception",kd="error",Hv="_onerror",Bv="errorSrc",Kv="lineNumber",Gv="columnNumber",zA="message",qv="CreateAutoException",Pp="addTelemetryInitializer",YP="overridePageViewDuration",ui="duration",VA="autoTrackPageVisitTime",jA="isBrowserLinkTrackingEnabled",Ss="length",WA="enableAutoRouteTracking",$A="enableUnhandledPromiseRejectionTracking",zv="autoUnhandledPromiseInstrumented",Vv="isPerformanceTimingSupported",jv="getPerformanceTiming",xd="navigationStart",Op="shouldCollectDuration",Wv="isPerformanceTimingDataReady",HP="getEntriesByType",Md="responseStart",BP="requestStart",kp="loadEventEnd",$v="responseEnd",xp="connectEnd",QA="pageVisitStartTime";var KP=function(){function r(e,t,n,o){Ne(r,this,function(i){var a=null,s=[],c=!1,l;n&&(l=n.logger);function u(f){n&&n.flush(f,function(){})}function d(){a||(a=Ht(function(){a=null;var f=s.slice(0),p=!1;s=[],j(f,function(m){m()?p=!0:s.push(m)}),s[Ss]>0&&d(),p&&u(!0)},100))}function h(f){s.push(f),d()}i[Pd]=function(f,p){var m=f.name;if(H(m)||typeof m!="string"){var _=lt();m=f.name=_&&_.title||""}var T=f.uri;if(H(T)||typeof T!="string"){var E=gn();T=f.uri=E&&E[Cs]||""}if(!o[Vv]()){e[ta](f,p),u(!0),Of()||q(l,2,25,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var y=!1,A,w=o[jv]()[xd];w>0&&(A=cr(w,+new Date),o[Op](A)||(A=void 0));var O;!H(p)&&!H(p[ui])&&(O=p[ui]),(t||!isNaN(O))&&(isNaN(O)&&(p||(p={}),p[ui]=A),e[ta](f,p),u(!0),y=!0);var S=6e4;p||(p={}),h(function(){var K=!1;try{if(o[Wv]()){K=!0;var ne={name:m,uri:T};o[Od](ne),!ne.isValid&&!y?(p[ui]=A,e[ta](f,p)):(y||(p[ui]=ne.durationMs,e[ta](f,p)),c||(e[Dp](ne,p),c=!0))}else w>0&&cr(w,+new Date)>S&&(K=!0,y||(p[ui]=S,e[ta](f,p)))}catch(_e){q(l,1,38,"trackPageView failed on page load calculation: "+we(_e),{exception:G(_e)})}return K})},i.teardown=function(f,p){if(a){clearInterval(a),a=null;var m=s.slice(0),_=!1;s=[],j(m,function(T){T()&&(_=!0)})}}})}return r.__ieDyn=1,r}();var FU=36e5,GP=["googlebot","adsbot-google","apis-google","mediapartners-google"];function zP(){var r=dn();return r&&!!r.timing}function YU(){var r=dn();return r&&r.getEntriesByType&&r.getEntriesByType("navigation")[Ss]>0}function HU(){var r=dn(),e=r?r.timing:0;return e&&e.domainLookupStart>0&&e[xd]>0&&e[Md]>0&&e[BP]>0&&e[kp]>0&&e[$v]>0&&e[xp]>0&&e.domLoading>0}function qP(){return zP()?dn().timing:null}function BU(){return YU()?dn()[HP]("navigation")[0]:null}function KU(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=gr()||{},n=t.userAgent,o=!1;if(n)for(var i=0;i<GP[Ss];i++)o=o||Tt(n.toLowerCase(),GP[i])!==-1;if(o)return!1;for(var i=0;i<r[Ss];i++)if(r[i]<0||r[i]>=FU)return!1;return!0}var VP=function(){function r(e){var t=Un(e);Ne(r,this,function(n){n[Od]=function(o){o.isValid=!1;var i=BU(),a=qP(),s=0,c=0,l=0,u=0,d=0;(i||a)&&(i?(s=i[ui],c=i.startTime===0?i[xp]:cr(i.startTime,i[xp]),l=cr(i.requestStart,i[Md]),u=cr(i[Md],i[$v]),d=cr(i.responseEnd,i[kp])):(s=cr(a[xd],a[kp]),c=cr(a[xd],a[xp]),l=cr(a.requestStart,a[Md]),u=cr(a[Md],a[$v]),d=cr(a.responseEnd,a[kp])),s===0?q(t,2,10,"error calculating page view performance.",{total:s,network:c,request:l,response:u,dom:d}):n[Op](s,c,l,u,d)?s<Math.floor(c)+Math.floor(l)+Math.floor(u)+Math.floor(d)?q(t,2,8,"client performance math error.",{total:s,network:c,request:l,response:u,dom:d}):(o.durationMs=s,o.perfTotal=o[ui]=Hn(s),o.networkConnect=Hn(c),o.sentRequest=Hn(l),o.receivedResponse=Hn(u),o.domProcessing=Hn(d),o.isValid=!0):q(t,2,45,"Invalid page load duration value. Browser perf data won't be sent.",{total:s,network:c,request:l,response:u,dom:d}))},n[jv]=qP,n[Vv]=zP,n[Wv]=HU,n[Op]=KU})}return r.__ieDyn=1,r}();var jP=function(){function r(e,t){var n="prevPageVisitData";Ne(r,this,function(o){o[bp]=function(s,c){try{var l=i(s,c);l&&t(l.pageName,l.pageUrl,l.pageVisitTime)}catch(u){Ro(e,"Auto track page visit time failed, metric will not be collected: "+G(u))}};function i(s,c){var l=null;try{if(l=a(),gs()){wd(e,n)!=null&&Jt("Cannot call startPageVisit consecutively without first calling stopPageVisit");var u=_r().stringify(new GU(s,c));Sp(e,n,u)}}catch(d){Ro(e,"Call to restart failed: "+G(d)),l=null}return l}function a(){var s=null;try{if(gs()){var c=rr(),l=wd(e,n);l&&ni()&&(s=_r().parse(l),s.pageVisitTime=c-s[QA],xA(e,n))}}catch(u){Ro(e,"Stop page visit timer failed: "+G(u)),s=null}return s}ve(o,"_logger",{g:function(){return e}}),ve(o,"pageVisitTimeTrackingHandler",{g:function(){return t}})})}return r.__ieDyn=1,r}();var GU=function(){function r(e,t){this[QA]=rr(),this.pageName=e,this.pageUrl=t}return r}();var XA=function(){function r(e,t){var n=this,o={};n.start=function(i){typeof o[i]<"u"&&q(e,2,62,"start was called more than once for this event without calling stop.",{name:i,key:i},!0),o[i]=+new Date},n.stop=function(i,a,s,c){var l=o[i];if(isNaN(l))q(e,2,63,"stop was called without a corresponding start.",{name:i,key:i},!0);else{var u=+new Date,d=cr(l,u);n.action(i,a,d,s,c)}delete o[i],o[i]=void 0}}return r}();var Tn,qU="event";function Mp(r,e){r&&r.dispatchEvent&&e&&r.dispatchEvent(e)}function zU(r){if(r&&r.reason){var e=r.reason;return!ae(e)&&ce(e[wp])?e[wp]():G(e)}return r||""}var WP=6e4,VU=Qr((Tn={sessionRenewalMs:fv($P,30*60*1e3),sessionExpirationMs:fv($P,24*60*60*1e3),disableExceptionTracking:Ft()},Tn[VA]=Ft(),Tn[YP]=Ft(),Tn[$A]=Ft(),Tn[zv]=!1,Tn.samplingPercentage=ss(jU,100),Tn[Fv]=Ft(),Tn[jA]=Ft(),Tn[WA]=Ft(),Tn.namePrefix=FS(),Tn.enableDebug=Ft(),Tn.disableFlushOnBeforeUnload=Ft(),Tn.disableFlushOnUnload=Ft(!1,"disableFlushOnBeforeUnload"),Tn));function $P(r,e){return r=r||e,r<WP&&(r=WP),+r}function jU(r){return!isNaN(r)&&r>0&&r<=100}function WU(r){be(r[Fv])||(r[Fv]?bA():DA())}var Qv=function(r){xr(e,r);function e(){var t=r.call(this)||this;t.identifier=FP,t.priority=180,t.autoRoutePVDelay=500;var n,o,i,a,s,c,l,u,d,h,f,p,m,_,T,E,y=0,A,w,O;return Ne(e,t,function(S,K){var ne=K[Cl];Le(),S.getCookieMgr=function(){return sl(S[vr])},S.processTelemetry=function(b,B){S.processNext(b,B)},S.trackEvent=function(b,B){try{var V=so(b,oo[ea],oo[Ts],S[En](),B);S[vr][ys](V)}catch(W){le(2,39,"trackTrace failed, trace will not be collected: "+we(W),{exception:G(W)})}},S.startTrackEvent=function(b){try{n.start(b)}catch(B){le(1,29,"startTrackEvent failed, event will not be collected: "+we(B),{exception:G(B)})}},S.stopTrackEvent=function(b,B,V){try{n.stop(b,void 0,B,V)}catch(W){le(1,30,"stopTrackEvent failed, event will not be collected: "+we(W),{exception:G(W)})}},S.trackTrace=function(b,B){try{var V=so(b,ci[ea],ci[Ts],S[En](),B);S[vr][ys](V)}catch(W){le(2,39,"trackTrace failed, trace will not be collected: "+we(W),{exception:G(W)})}},S.trackMetric=function(b,B){try{var V=so(b,io[ea],io[Ts],S[En](),B);S[vr][ys](V)}catch(W){le(1,36,"trackMetric failed, metric will not be collected: "+we(W),{exception:G(W)})}},S[Pd]=function(b,B){try{var V=b||{};i[Pd](V,Ut(Ut(Ut({},V.properties),V.measurements),B)),E&&s[bp](V.name,V.uri)}catch(W){le(1,37,"trackPageView failed, page view will not be collected: "+we(W),{exception:G(W)})}},S[ta]=function(b,B,V){var W=lt();W&&(b.refUri=b.refUri===void 0?W.referrer:b.refUri);var ke=so(b,vn[ea],vn[Ts],S[En](),B,V);S[vr][ys](ke),y=0},S[Dp]=function(b,B,V){var W=so(b,li[ea],li[Ts],S[En](),B,V);S[vr][ys](W)},S.trackPageViewPerformance=function(b,B){var V=b||{};try{a[Od](V),S[Dp](V,B)}catch(W){le(1,37,"trackPageViewPerformance failed, page view will not be collected: "+we(W),{exception:G(W)})}},S.startTrackPage=function(b){try{if(typeof b!="string"){var B=lt();b=B&&B.title||""}o.start(b)}catch(V){le(1,31,"startTrackPage failed, page view may not be collected: "+we(V),{exception:G(V)})}},S.stopTrackPage=function(b,B,V,W){try{if(typeof b!="string"){var ke=lt();b=ke&&ke.title||""}if(typeof B!="string"){var et=gn();B=et&&et[Cs]||""}o.stop(b,B,V,W),E&&s[bp](b,B)}catch(Ee){le(1,32,"stopTrackPage failed, page view will not be collected: "+we(Ee),{exception:G(Ee)})}},S[qA]=function(b,B,V){var W=b&&(b[Yv]||b[kd])||$o(b)&&b||{name:b&&typeof b,message:b||Kt};b=b||{};var ke=new Yr(S[En](),W,b.properties||B,b.measurements,b.severityLevel,b.id).toInterface(),et=so(ke,Yr[ea],Yr[Ts],S[En](),B,V);S[vr][ys](et)},S.trackException=function(b,B){b&&!b[Yv]&&b[kd]&&(b[Yv]=b[kd]);try{S[qA](b,B)}catch(V){le(1,35,"trackException failed, exception will not be collected: "+we(V),{exception:G(V)})}},S[Hv]=function(b){var B=b&&b[kd],V=b&&b.evt;try{if(!V){var W=tr();W&&(V=W[qU])}var ke=b&&b.url||(lt()||{}).URL,et=b[Bv]||"window.onerror@"+ke+":"+(b[Kv]||0)+":"+(b[Gv]||0),Ee={errorSrc:et,url:ke,lineNumber:b[Kv]||0,columnNumber:b[Gv]||0,message:b[zA]};KA(b.message,b.url,b.lineNumber,b.columnNumber,b[kd])?z(Yr[qv]("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",ke,b[Kv]||0,b[Gv]||0,B,V,null,et),Ee):(b[Bv]||(b[Bv]=et),S.trackException({exception:b,severityLevel:3},Ee))}catch(He){var Fe=B?B.name+", "+B[zA]:"null";le(1,11,"_onError threw exception while logging error, error will not be collected: "+we(He),{exception:G(He),errorString:Fe})}},S[Pp]=function(b){if(S[vr])return S[vr][Pp](b);c||(c=[]),c.push(b)},S.initialize=function(b,B,V,W){if(!S.isInitialized()){H(B)&&Jt("Error initializing"),K.initialize(b,B,V,W);try{O=Yn(sr(S.identifier),B.evtNamespace&&B.evtNamespace()),c&&(j(c,function(ke){B[Pp](ke)}),c=null),_e(b),a=new VP(S[vr]),i=new KP(S,T.overridePageViewDuration,S[vr],a),s=new jP(S[En](),function(ke,et,Ee){return Ct(ke,et,Ee)}),n=new XA(S[En](),"trackEvent"),n.action=function(ke,et,Ee,Fe,He){Fe||(Fe={}),He||(He={}),Fe.duration=Ee[wp](),S.trackEvent({name:ke,properties:Fe,measurements:He})},o=new XA(S[En](),"trackPageView"),o.action=function(ke,et,Ee,Fe,He){H(Fe)&&(Fe={}),Fe.duration=Ee[wp]();var P={name:ke,uri:et,properties:Fe,measurements:He};S[ta](P,Fe)},Xo()&&(M(),Ir())}catch(ke){throw S.setInitialized(!1),ke}}},S._doTeardown=function(b,B){i&&i.teardown(b,B),fs(window,null,null,O),Le()};function _e(b){var B=S.identifier,V=S[vr];S[Cl](Je(b,function(){var W=Lr(null,b,V);T=W.getExtCfg(B,VU),E=T[VA],WU(T),l=T[jA],Ze()}))}function Ct(b,B,V){var W={PageName:b,PageUrl:B};S.trackMetric({name:"PageVisitTime",average:V,max:V,min:V,sampleCount:1},W)}function Ze(){if(!u&&l){var b=["/browserLinkSignalR/","/__browserLink/"],B=function(V){if(l&&V.baseType===ao[ea]){var W=V.baseData;if(W){for(var ke=0;ke<b[Ss];ke++)if(W.target&&Tt(W.target,b[ke])>=0)return!1}}return!0};S[Cl](S[Pp](B)),u=!0}}function z(b,B){var V=so(b,Yr[ea],Yr[Ts],S[En](),B);S[vr][ys](V)}function M(){var b=tr(),B=gn(!0);S[Cl](Je(T,function(){f=T.disableExceptionTracking,!f&&!p&&!T.autoExceptionInstrumented&&(ne(Sd(b,"onerror",{ns:O,rsp:function(V,W,ke,et,Ee,Fe){!f&&V.rslt!==!0&&S[Hv](Yr[qv](W,ke,et,Ee,Fe,V.evt))}},!1)),p=!0)})),oe(b,B)}function Ir(){var b=tr(),B=gn(!0);S[Cl](Je(T,function(){if(d=T[WA]===!0,b&&d&&!h&&I_()){var V=Pf();ce(V.pushState)&&ce(V.replaceState)&&typeof Event!==Gc&&re(b,V,B)}}))}function L(){var b=null;if(S[vr]&&S[vr].getTraceCtx&&(b=S[vr].getTraceCtx(!1)),!b){var B=S[vr].getPlugin(Es);if(B){var V=B.plugin.context;V&&(b=vl(V.telemetryTrace))}}return b}function re(b,B,V){if(h)return;var W=T.namePrefix||"";function ke(){d&&Mp(b,yl(W+"locationchange"))}function et(){if(w?(A=w,w=V&&V[Cs]||""):w=V&&V[Cs]||"",d){var Ee=L();if(Ee){Ee.setTraceId(Fn());var Fe="_unknown_";V&&V.pathname&&(Fe=V.pathname+(V.hash||"")),Ee.setName(je(S[En](),Fe))}Ht(function(He){S[Pd]({refUri:He,properties:{duration:0}})}.bind(S,A),S.autoRoutePVDelay)}}ne(Sd(B,"pushState",{ns:O,rsp:function(){d&&(Mp(b,yl(W+"pushState")),Mp(b,yl(W+"locationchange")))}},!0)),ne(Sd(B,"replaceState",{ns:O,rsp:function(){d&&(Mp(b,yl(W+"replaceState")),Mp(b,yl(W+"locationchange")))}},!0)),ro(b,W+"popstate",ke,O),ro(b,W+"locationchange",et,O),h=!0}function oe(b,B){S[Cl](Je(T,function(){m=T[$A]===!0,p=p||T[zv],m&&!_&&(ne(Sd(b,"onunhandledrejection",{ns:O,rsp:function(V,W){m&&V.rslt!==!0&&S[Hv](Yr[qv](zU(W),B?B[Cs]:"",0,0,W,V.evt))}},!1)),T[zv]=_=!0)}))}function le(b,B,V,W,ke){S[En]().throwInternal(b,B,V,W,ke)}function Le(){n=null,o=null,i=null,a=null,s=null,c=null,l=!1,u=!1,d=!1,h=!1,f=!1,p=!1,m=!1,_=!1,E=!1,y=0;var b=gn(!0);A=b&&b[Cs]||"",w=null,O=null,T=null,ve(S,"config",{g:function(){return T}})}ve(S,"_pageViewManager",{g:function(){return i}}),ve(S,"_pageViewPerformanceManager",{g:function(){return a}}),ve(S,"_pageVisitTimeManager",{g:function(){return s}}),ve(S,"_evtNamespace",{g:function(){return"."+O}})}),t}return e.Version="3.0.2",e}(wo);var As="duration";var qt="tags",Xv="deviceType",yn="data",di="name",Sl="traceID",De="length",Is="stringify",Ns="measurements",co="dataType",Rs="envelopeType",ra="toString",Lp="onLine",Up="isOnline",Ld="_get",na="enqueue",ws="count",Jv="eventsLimitInMem",oa="push",Fp="emitLineDelimitedJson",ia="clear",Al="batchPayloads",Yp="createNew",aa="markAsSent",Il="clearSent",Hp="bufferOverride",Zv="BUFFER_KEY",sa="SENT_BUFFER_KEY",Ud="MAX_BUFFER_SIZE",Fd="triggerSend",Ar="diagLog",Yd="_sender",eE="customHeaders",JA="maxBatchSizeInBytes",ZA="onunloadDisableBeacon",tE="isBeaconApiDisabled",eI="enableSessionStorageBuffer",hi="_buffer",tI="instrumentationKey",Hd="disableXhr",rI="onunloadDisableFetch",nI="convertUndefined",oI="maxBatchInterval",rE="baseType",Bd="sampleRate",QP="_xhrReadyStateChange",lo="_onError",nE="_onPartialSuccess",Bp="_onSuccess",Kp="itemsAccepted",XP="itemsReceived",oE="setRequestHeader",iI="eventsSendRequest",iE="getSamplingScore",JP="getHashCodeScore";var aI="baseType",yt="baseData",Er="properties",ZP="true";function zt(r,e,t){return Qe(r,e,t,Yi)}function $U(r,e,t){var n=t[qt]=t[qt]||{},o=e.ext=e.ext||{},i=e[qt]=e[qt]||[],a=o.user;a&&(zt(n,it.userAuthUserId,a.authId),zt(n,it.userId,a.id||a.localId));var s=o.app;s&&zt(n,it.sessionId,s.sesId);var c=o.device;c&&(zt(n,it.deviceId,c.id||c.localId),zt(n,it[Xv],c.deviceClass),zt(n,it.deviceIp,c.ip),zt(n,it.deviceModel,c.model),zt(n,it[Xv],c[Xv]));var l=e.ext.web;if(l){zt(n,it.deviceLanguage,l.browserLang),zt(n,it.deviceBrowserVersion,l.browserVer),zt(n,it.deviceBrowser,l.browser);var u=t[yn]=t[yn]||{},d=u[yt]=u[yt]||{},h=d[Er]=d[Er]||{};zt(h,"domain",l.domain),zt(h,"isManual",l.isManual?ZP:null),zt(h,"screenRes",l.screenRes),zt(h,"userConsent",l.userConsent?ZP:null)}var f=o.os;f&&zt(n,it.deviceOS,f[di]);var p=o.trace;p&&(zt(n,it.operationParentId,p.parentID),zt(n,it.operationName,je(r,p[di])),zt(n,it.operationId,p[Sl]));for(var m={},_=i[De]-1;_>=0;_--){var T=i[_];ue(T,function(y,A){m[y]=A}),i.splice(_,1)}ue(i,function(y,A){m[y]=A});var E=Ut(Ut({},n),m);E[it.internalSdkVersion]||(E[it.internalSdkVersion]=je(r,"javascript:".concat(QU.Version),64)),t[qt]=rv(E)}function bs(r,e,t){H(r)||ue(r,function(n,o){Wo(o)?t[n]=o:ae(o)?e[n]=o:ni()&&(e[n]=_r()[Is](o))})}function Nl(r,e){H(r)||ue(r,function(t,n){r[t]=n||e})}function Rl(r,e,t,n){var o=new LA(r,n,e);zt(o,"sampleRate",t[fp]),(t[yt]||{}).startTime&&(o.time=to(t[yt].startTime)),o.iKey=t.iKey;var i=t.iKey.replace(/-/g,"");return o[di]=o[di].replace("{0}",i),$U(r,t,o),t[qt]=t[qt]||[],rv(o)}function wl(r,e){H(e[yt])&&q(r,1,46,"telemetryItem.baseData cannot be null.")}var QU={Version:"3.0.2"};function eO(r,e,t){wl(r,e);var n=e[yt][Ns]||{},o=e[yt][Er]||{};bs(e[yn],o,n),H(t)||Nl(o,t);var i=e[yt];if(H(i))return Ro(r,"Invalid input for dependency data"),null;var a=i[Er]&&i[Er][Nv]?i[Er][Nv]:"GET",s=new ao(r,i.id,i.target,i[di],i[As],i.success,i.responseCode,a,i.type,i.correlationContext,o,n),c=new Zi(ao[co],s);return Rl(r,ao[Rs],e,c)}function sI(r,e,t){wl(r,e);var n={},o={};e[aI]!==oo[co]&&(n.baseTypeSource=e[aI]),e[aI]===oo[co]?(n=e[yt][Er]||{},o=e[yt][Ns]||{}):e[yt]&&bs(e[yt],n,o),bs(e[yn],n,o),H(t)||Nl(n,t);var i=e[yt][di],a=new oo(r,i,n,o),s=new Zi(oo[co],a);return Rl(r,oo[Rs],e,s)}function tO(r,e,t){wl(r,e);var n=e[yt][Ns]||{},o=e[yt][Er]||{};bs(e[yn],o,n),H(t)||Nl(o,t);var i=e[yt],a=Yr.CreateFromInterface(r,i,o,n),s=new Zi(Yr[co],a);return Rl(r,Yr[Rs],e,s)}function rO(r,e,t){wl(r,e);var n=e[yt],o=n[Er]||{},i=n[Ns]||{};bs(e[yn],o,i),H(t)||Nl(o,t);var a=new io(r,n[di],n.average,n.sampleCount,n.min,n.max,n.stdDev,o,i),s=new Zi(io[co],a);return Rl(r,io[Rs],e,s)}function nO(r,e,t){wl(r,e);var n,o=e[yt];!H(o)&&!H(o[Er])&&!H(o[Er][As])?(n=o[Er][As],delete o[Er][As]):!H(e[yn])&&!H(e[yn][As])&&(n=e[yn][As],delete e[yn][As]);var i=e[yt],a;((e.ext||{}).trace||{})[Sl]&&(a=e.ext.trace[Sl]);var s=i.id||a,c=i[di],l=i.uri,u=i[Er]||{},d=i[Ns]||{};if(H(i.refUri)||(u.refUri=i.refUri),H(i.pageType)||(u.pageType=i.pageType),H(i.isLoggedIn)||(u.isLoggedIn=i.isLoggedIn[ra]()),!H(i[Er])){var h=i[Er];ue(h,function(m,_){u[m]=_})}bs(e[yn],u,d),H(t)||Nl(u,t);var f=new vn(r,c,l,n,u,d,s),p=new Zi(vn[co],f);return Rl(r,vn[Rs],e,p)}function oO(r,e,t){wl(r,e);var n=e[yt],o=n[di],i=n.uri||n.url,a=n[Er]||{},s=n[Ns]||{};bs(e[yn],a,s),H(t)||Nl(a,t);var c=new li(r,o,i,void 0,a,s,n),l=new Zi(li[co],c);return Rl(r,li[Rs],e,l)}function iO(r,e,t){wl(r,e);var n=e[yt].message,o=e[yt].severityLevel,i=e[yt][Er]||{},a=e[yt][Ns]||{};bs(e[yn],i,a),H(t)||Nl(i,t);var s=new ci(r,n,o,i,a),c=new Zi(ci[co],s);return Rl(r,ci[Rs],e,c)}function aO(r,e){fs(r,null,null,e)}function sO(r){var e,t=lt(),n=gr(),o=!1,i=!0,a=Yn(sr("OfflineListener"),r);try{if(c(tr())&&(o=!0),t){var s=t.body||t;s.ononline&&c(s)&&(o=!0)}o&&n&&!H(n[Lp])&&(i=n[Lp])}catch{o=!1}function c(f){var p=!1;return f&&(p=ro(f,"online",l,a),p&&ro(f,"offline",u,a)),p}function l(){i=!0}function u(){i=!1}function d(){var f=!0;return o?f=i:n&&!H(n[Lp])&&(f=n[Lp]),f}function h(){var f=tr();if(f&&o){if(aO(f,a),t){var p=t.body||t;be(p.ononline)||aO(p,a)}o=!1}}return e={},e[Up]=d,e.isListening=function(){return o},e.unload=h,e}var cO=function(){function r(e,t){var n=[],o=!1;this[Ld]=function(){return n},this._set=function(i){return n=i,n},Ne(r,this,function(i){i[na]=function(a){if(i[ws]()>=t[Jv]){o||(q(e,2,105,"Maximum in-memory buffer size reached: "+i[ws](),!0),o=!0);return}n[oa](a)},i[ws]=function(){return n[De]},i.size=function(){for(var a=n[De],s=0;s<n[De];s++)a+=n[s][De];return t[Fp]||(a+=2),a},i[ia]=function(){n=[],o=!1},i.getItems=function(){return n.slice(0)},i[Al]=function(a){if(a&&a[De]>0){var s=t[Fp]?a.join(`
`):"["+a.join(",")+"]";return s}return null},i[Yp]=function(a,s,c){var l=n.slice(0);a=a||e,s=s||{};var u=c?new cI(a,s):new aE(a,s);return j(l,function(d){u[na](d)}),u}})}return r.__ieDyn=1,r}(),aE=function(r){xr(e,r);function e(t,n){var o=r.call(this,t,n)||this;return Ne(e,o,function(i,a){i[aa]=function(s){a[ia]()},i[Il]=function(s){}}),o}return e.__ieDyn=1,e}(cO);var cI=function(r){xr(e,r);function e(t,n){var o=r.call(this,t,n)||this,i=!1,a=n?.namePrefix,s=n[Hp]||{getItem:wd,setItem:Sp},c=s.getItem,l=s.setItem;return Ne(e,o,function(u,d){var h=_(e[Zv]),f=_(e[sa]),p=u._set(h.concat(f));p[De]>e[Ud]&&(p[De]=e[Ud]),T(e[sa],[]),T(e[Zv],p),u[na]=function(E){if(u[ws]()>=e[Ud]){i||(q(t,2,67,"Maximum buffer size reached: "+u[ws](),!0),i=!0);return}d[na](E),T(e.BUFFER_KEY,u[Ld]())},u[ia]=function(){d[ia](),T(e.BUFFER_KEY,u[Ld]()),T(e[sa],[]),i=!1},u[aa]=function(E){T(e[Zv],u._set(m(E,u[Ld]())));var y=_(e[sa]);y instanceof Array&&E instanceof Array&&(y=y.concat(E),y[De]>e[Ud]&&(q(t,1,67,"Sent buffer reached its maximum size: "+y[De],!0),y[De]=e[Ud]),T(e[sa],y))},u[Il]=function(E){var y=_(e[sa]);y=m(E,y),T(e[sa],y)},u[Yp]=function(E,y,A){A=!!A;var w=u[Ld]().slice(0),O=_(e[sa]).slice(0);E=E||t,y=y||{},u[ia]();var S=A?new e(E,y):new aE(E,y);return j(w,function(K){S[na](K)}),A&&S[aa](O),S};function m(E,y){var A=[];return j(y,function(w){!ce(w)&&ut(E,w)===-1&&A[oa](w)}),A}function _(E){var y=E;try{y=a?a+"_"+y:y;var A=c(t,y);if(A){var w=_r().parse(A);if(ae(w)&&(w=_r().parse(w)),w&&de(w))return w}}catch(O){q(t,1,42," storage key: "+y+", "+we(O),{exception:G(O)})}return[]}function T(E,y){var A=E;try{A=a?a+"_"+A:A;var w=JSON[Is](y);l(t,A,w)}catch(O){l(t,A,JSON[Is]([])),q(t,2,41," storage key: "+A+", "+we(O)+". Buffer cleared",{exception:G(O)})}}}),o}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(cO);var lO=function(){function r(e){Ne(r,this,function(t){t.serialize=function(a){var s=n(a,"root");try{return _r()[Is](s)}catch(c){q(e,1,48,c&&ce(c[ra])?c[ra]():"Error serializing object",null,!0)}};function n(a,s){var c="__aiCircularRefCheck",l={};if(!a)return q(e,1,48,"cannot serialize object because it is null or undefined",{name:s},!0),l;if(a[c])return q(e,2,50,"Circular reference detected while serializing object",{name:s},!0),l;if(!a.aiDataContract){if(s==="measurements")l=i(a,"number",s);else if(s==="properties")l=i(a,"string",s);else if(s==="tags")l=i(a,"string",s);else if(de(a))l=o(a,s);else{q(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:s},!0);try{_r()[Is](a),l=a}catch(u){q(e,1,48,u&&ce(u[ra])?u[ra]():"Error serializing object",null,!0)}}return l}return a[c]=!0,ue(a.aiDataContract,function(u,d){var h=ce(d)?d()&1:d&1,f=ce(d)?d()&4:d&4,p=d&2,m=a[u]!==void 0,_=bt(a[u])&&a[u]!==null;if(h&&!m&&!p)q(e,1,24,"Missing required field specification. The field is required but not present on source",{field:u,name:s});else if(!f){var T=void 0;_?p?T=o(a[u],u):T=n(a[u],u):T=a[u],T!==void 0&&(l[u]=T)}}),delete a[c],l}function o(a,s){var c;if(a)if(!de(a))q(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:s},!0);else{c=[];for(var l=0;l<a[De];l++){var u=a[l],d=n(u,s+"["+l+"]");c[oa](d)}}return c}function i(a,s,c){var l;return a&&(l={},ue(a,function(u,d){if(s==="string")d===void 0?l[u]="undefined":d===null?l[u]="null":d[ra]?l[u]=d[ra]():l[u]="invalid field: toString() is not defined.";else if(s==="number")if(d===void 0)l[u]="undefined";else if(d===null)l[u]="null";else{var h=parseFloat(d);isNaN(h)?l[u]="NaN":l[u]=h}else l[u]="invalid field: "+c+" is of unknown type.",q(e,1,l[u],null,!0)})),l}})}return r.__ieDyn=1,r}();var XU=8,uO=function(){function r(){}return r.prototype.getHashCodeScore=function(e){var t=this.getHashCode(e)/r.INT_MAX_VALUE;return t*100},r.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[De]<XU;)e=e.concat(e);for(var t=5381,n=0;n<e[De];++n)t=(t<<5)+t+e.charCodeAt(n),t=t&t;return Math.abs(t)},r.INT_MAX_VALUE=2147483647,r}();var dO=function(){function r(){var e=this,t=new uO,n=new Rp;e[iE]=function(o){var i=0;return o[qt]&&o[qt][n.userId]?i=t.getHashCodeScore(o[qt][n.userId]):o.ext&&o.ext.user&&o.ext.user.id?i=t[JP](o.ext.user.id):o[qt]&&o[qt][n.operationId]?i=t.getHashCodeScore(o[qt][n.operationId]):o.ext&&o.ext.telemetryTrace&&o.ext.telemetryTrace[Sl]?i=t.getHashCodeScore(o.ext.telemetryTrace[Sl]):i=Math.random()*100,i}}return r}();var hO=function(){function r(e,t){this.INT_MAX_VALUE=2147483647;var n=t||Un(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[Bd]=e,this.samplingScoreGenerator=new dO}return r.prototype.isSampledIn=function(e){var t=this[Bd],n=!1;return t==null||t>=100||e.baseType===io[co]?!0:(n=this.samplingScoreGenerator[iE](e)<t,n)},r}();var ur,ca,bl=void 0,JU=65e3;function sE(r){try{return r.responseText}catch{}return null}var fO=Qr((ur={endpointUrl:ss(Yi,ul+ji)},ur[Fp]=Ft(),ur[oI]=15e3,ur[JA]=102400,ur.disableTelemetry=Ft(),ur[eI]=Ft(!0),ur.isRetryDisabled=Ft(),ur[tE]=Ft(!0),ur[Hd]=Ft(),ur[rI]=Ft(),ur[ZA]=Ft(),ur[tI]=bl,ur.namePrefix=bl,ur.samplingPercentage=ss(ZU,100),ur[eE]=bl,ur[nI]=bl,ur[Jv]=1e4,ur[Hp]=!1,ur));function ZU(r){return!isNaN(r)&&r>0&&r<=100}var eF=(ca={},ca[oo.dataType]=sI,ca[ci.dataType]=iO,ca[vn.dataType]=nO,ca[li.dataType]=oO,ca[Yr.dataType]=tO,ca[io.dataType]=rO,ca[ao.dataType]=eO,ca),lI=function(r){xr(e,r);function e(){var t=r.call(this)||this;t.priority=1001,t.identifier=Uv;var n,o,i,a,s,c,l,u,d=0,h,f,p,m,_,T,E,y,A,w,O,S,K,ne,_e,Ct,Ze,z;return Ne(e,t,function(M,Ir){Kr(),M.pause=function(){Z(),a=!0},M.resume=function(){a&&(a=!1,o=null,re(),P())},M.flush=function(I,v,N){if(I===void 0&&(I=!0),!a){Z();try{return M[Fd](I,null,N||1)}catch(D){q(M[Ar](),1,22,"flush failed, telemetry will not be collected: "+we(D),{exception:G(D)})}}},M.onunloadFlush=function(){if(!a)if(y)try{return M[Fd](!0,Le,2)}catch(I){q(M[Ar](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+we(I),{exception:G(I)})}else M.flush(!1)},M.addHeader=function(I,v){u[I]=v},M.initialize=function(I,v,N,D){M.isInitialized()&&q(M[Ar](),1,28,"Sender is already initialized"),Ir.initialize(I,v,N,D);var k=M.identifier;c=new lO(v.logger),n=0,o=null,i=0,M[Yd]=null,l=0;var F=M[Ar]();m=Yn(sr("Sender"),v.evtNamespace&&v.evtNamespace()),p=sO(m),M._addHook(Je(I,function(J){var Q=J.cfg,se=Lr(null,Q,v),X=se.getExtCfg(k,fO);ve(M,"_senderConfig",{g:function(){return X}}),T!==X.endpointUrl&&(_=T=X.endpointUrl),A&&A!==X[eE]&&j(A,function(Be){delete u[Be.header]}),E=X[JA],y=(X[ZA]===!1||X[tE]===!1)&&tl();var qe=X[Hp],Nt=!!X[eI]&&(!!qe||gs()),_t=X.namePrefix,Oo=Nt!==_e||Nt&&Ze!==_t||Nt&&Ct!==qe;if(M[hi]){if(Oo)try{M._buffer=M._buffer[Yp](F,X,Nt)}catch(Be){q(M[Ar](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+we(Be),{exception:G(Be)})}re()}else M[hi]=Nt?new cI(F,X):new aE(F,X);Ze=_t,_e=Nt,Ct=qe,M._sample=new hO(X.samplingPercentage,F),O=X[tI],Ot(O,Q)||q(F,1,100,"Invalid Instrumentation key "+O),A=X[eE],!_l(_)&&A&&A[De]>0?j(A,function(Be){t.addHeader(Be.header,Be.value)}):A=null,z=X.enableSendPromise;var Tr=null;!X[Hd]&&iv()?Tr=fe:!X[Hd]&&rl()&&(Tr=V),!Tr&&ov()&&(Tr=ke),h=Tr||V,!X[tE]&&tl()&&(Tr=B),M[Yd]=Tr||V,!X[rI]&&ov(!0)?f=W:tl()?f=B:!X[Hd]&&iv()?f=fe:!X[Hd]&&rl()?f=V:f=h,w=X.disableTelemetry,S=X[nI]||bl,K=X.isRetryDisabled,ne=X[oI]}))},M.processTelemetry=function(I,v){v=M._getTelCtx(v);var N=v[Ar]();try{if(w)return;if(!I){q(N,1,7,"Cannot send empty telemetry");return}if(I.baseData&&!I[rE]){q(N,1,70,"Cannot send telemetry without baseData and baseType");return}if(I[rE]||(I[rE]="EventData"),!M[Yd]){q(N,1,28,"Sender was not initialized");return}if(L(I))I[fp]=M._sample[Bd];else{q(N,2,33,"Telemetry item was sampled out and not sent",{SampleRate:M._sample[Bd]});return}var D=I.iKey||O,k=e.constructEnvelope(I,D,N,S);if(!k){q(N,1,47,"Unable to create an AppInsights envelope");return}var F=!1;if(I[qt]&&I[qt][pp]&&(j(I[qt][pp],function(se){try{se&&se(k)===!1&&(F=!0,Ro(N,"Telemetry processor check returns false"))}catch(X){q(N,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+we(X),{exception:G(X)},!0)}}),delete I[qt][pp]),F)return;var J=c.serialize(k),Q=M[hi];re(J),Q[na](J),P()}catch(se){q(N,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+we(se),{exception:G(se)})}M.processNext(I,v)},M[QP]=function(I,v,N){I.readyState===4&&oe(I.status,v,I.responseURL,N,he(I),sE(I)||I.response)},M[Fd]=function(I,v,N){I===void 0&&(I=!0);var D;if(!a)try{var k=M[hi];if(w)k[ia]();else{if(k[ws]()>0){var F=k.getItems();gt(N||0,I),v?D=v.call(M,F,I):D=M[Yd](F,I)}i=+new Date}Z()}catch(Q){var J=Qf();(!J||J>9)&&q(M[Ar](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+we(Q),{exception:G(Q)})}return D},M._doTeardown=function(I,v){M.onunloadFlush(),qi(p,!1),Kr()},M[lo]=function(I,v,N){q(M[Ar](),2,26,"Failed to send telemetry.",{message:v}),M._buffer&&M._buffer[Il](I)},M[nE]=function(I,v){for(var N=[],D=[],k=v.errors.reverse(),F=0,J=k;F<J.length;F++){var Q=J[F],se=I.splice(Q.index,1)[0];ge(Q.statusCode)?D[oa](se):N[oa](se)}I[De]>0&&M[Bp](I,v[Kp]),N[De]>0&&M[lo](N,he(null,["partial success",v[Kp],"of",v.itemsReceived].join(" "))),D[De]>0&&(Fe(D),q(M[Ar](),2,40,"Partial success. Delivered: "+I[De]+", Failed: "+N[De]+". Will retry to send "+D[De]+" our of "+v[XP]+" items"))},M[Bp]=function(I,v){M._buffer&&M._buffer[Il](I)},M._xdrOnLoad=function(I,v){var N=sE(I);if(I&&(N+""=="200"||N===""))n=0,M[Bp](v,0);else{var D=Ee(N);D&&D.itemsReceived&&D.itemsReceived>D[Kp]&&!K?M[nE](v,D):M[lo](v,We(I))}};function L(I){return M._sample.isSampledIn(I)}function re(I){var v=I?I[De]:0;return M[hi].size()+v>E?((!p||p[Up]())&&M[Fd](!0,null,10),!0):!1}function oe(I,v,N,D,k,F){var J=null;if(M._appId||(J=Ee(F),J&&J.appId&&(M._appId=J.appId)),(I<200||I>=300)&&I!==0){if((I===301||I===307||I===308)&&!le(N)){M[lo](v,k);return}!K&&ge(I)?(Fe(v),q(M[Ar](),2,40,". Response code "+I+". Will retry to send "+v[De]+" items.")):M[lo](v,k)}else if(p&&!p[Up]()){if(!K){var Q=10;Fe(v,Q),q(M[Ar](),2,40,". Offline - Response Code: ".concat(I,". Offline status: ").concat(!p.isOnline(),". Will retry to send ").concat(v.length," items."))}}else le(N),I===206?(J||(J=Ee(F)),J&&!K?M[nE](v,J):M[lo](v,k)):(n=0,M[Bp](v,D))}function le(I){return l>=10?!1:!H(I)&&I!==""&&I!==_?(_=I,++l,!0):!1}function Le(I,v){f?f(I,!1):B(I,v)}function b(I){var v=gr(),N=M[hi],D=_,k=M._buffer[Al](I),F=new Blob([k],{type:"text/plain;charset=UTF-8"}),J=v.sendBeacon(D,F);return J&&(N[aa](I),M._onSuccess(I,I[De])),J}function B(I,v){if(de(I)&&I[De]>0&&!b(I)){for(var N=[],D=0;D<I[De];D++){var k=I[D];b([k])||N[oa](k)}N[De]>0&&(h&&h(N,!0),q(M[Ar](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function V(I,v){var N,D,k,F=new XMLHttpRequest,J=_;try{F[ai]=!0}catch{}F.open("POST",J,v),F[oE]("Content-type","application/json"),_l(J)&&F[oE](ot[6],ot[7]),j($r(u),function(se){F[oE](se,u[se])}),F.onreadystatechange=function(){M._xhrReadyStateChange(F,I,I[De]),F.readyState===4&&D&&D(!0)},F.onerror=function(se){M[lo](I,he(F),se),k&&k(se)},v&&z&&(N=Mr(function(se,X){D=se,k=X}));var Q=M._buffer[Al](I);return F.send(Q),M._buffer[aa](I),N}function W(I,v){if(de(I)){for(var N=I[De],D=0;D<I[De];D++)N+=I[D][De];d+N<=JU?et(I,!1):tl()?B(I,v):(h&&h(I,!0),q(M[Ar](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function ke(I,v){return et(I,!0)}function et(I,v){var N,D=_,k=M._buffer[Al](I),F=new Blob([k],{type:"application/json"}),J,Q,se,X=new Headers,qe=k[De],Nt=!1,_t=!1;_l(D)&&X.append(ot[6],ot[7]),j($r(u),function(Be){X.append(Be,u[Be])});var Oo=(N={method:"POST",headers:X,body:F},N[ai]=!0,N);v||(Oo.keepalive=!0,Nt=!0,d+=qe);var Tr=new Request(D,Oo);try{Tr[ai]=!0}catch{}M._buffer[aa](I),v&&z&&(J=Mr(function(Be,ko){Q=Be,se=ko}));try{ns(fetch(Tr),function(Be){if(v||(d-=qe,qe=0),!_t)if(_t=!0,Be.rejected)M[lo](I,Be.reason&&Be.reason.message),se&&se(Be.reason);else{var ko=Be.value;ko.ok?ns(ko.text(),function(ok){oe(ko.status,I,ko.url,I[De],ko.statusText,ok.value||""),Q&&Q(!0)}):(M[lo](I,ko.statusText),Q&&Q(!1))}})}catch(Be){_t||(M[lo](I,G(Be)),se&&se(Be))}return Nt&&!_t&&(_t=!0,M._onSuccess(I,I[De]),Q&&Q(!0)),J}function Ee(I){try{if(I&&I!==""){var v=_r().parse(I);if(v&&v.itemsReceived&&v.itemsReceived>=v[Kp]&&v.itemsReceived-v.itemsAccepted===v.errors[De])return v}}catch(N){q(M[Ar](),1,43,"Cannot parse the response. "+we(N),{response:I})}return null}function Fe(I,v){if(v===void 0&&(v=1),!(!I||I[De]===0)){var N=M[hi];N[Il](I),n++;for(var D=0,k=I;D<k.length;D++){var F=k[D];N[na](F)}He(v),P()}}function He(I){var v=10,N;if(n<=1)N=v;else{var D=(Math.pow(2,n)-1)/2,k=Math.floor(Math.random()*D*v)+1;k=I*k,N=Math.max(Math.min(k,3600),v)}var F=rr()+N*1e3;o=F}function P(){if(!s&&!a){var I=o?Math.max(0,o-rr()):0,v=Math.max(ne,I);s=Ht(function(){s=null,M[Fd](!0,null,1)},v)}}function Z(){s&&s.cancel(),s=null,o=null}function ge(I){return I===401||I===403||I===408||I===429||I===500||I===502||I===503||I===504}function he(I,v){return I?"XMLHttpRequest,Status:"+I.status+",Response:"+sE(I)||I.response||"":v}function fe(I,v){var N=M[hi],D=tr(),k=new XDomainRequest;k.onload=function(){return M._xdrOnLoad(k,I)},k.onerror=function(se){return M[lo](I,We(k),se)};var F=D&&D.location&&D.location.protocol||"";if(_.lastIndexOf(F,0)!==0){q(M[Ar](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),N[ia]();return}var J=_.replace(/^(https?:)/,"");k.open("POST",J);var Q=N[Al](I);k.send(Q),N[aa](I)}function We(I,v){return I?"XDomainRequest,Response:"+sE(I)||"":v}function $e(){var I="getNotifyMgr";return M.core[I]?M.core[I]():M.core._notificationManager}function gt(I,v){var N=$e();if(N&&N[iI])try{N[iI](I,v)}catch(D){q(M[Ar](),1,74,"send request notification failed: "+we(D),{exception:G(D)})}}function Ot(I,v){var N=v.disableInstrumentationKeyValidation,D=H(N)?!1:N;if(D)return!0;var k="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",F=new RegExp(k);return F.test(I)}function Kr(){M[Yd]=null,M[hi]=null,M._appId=null,M._sample=null,u={},p=null,n=0,o=null,i=null,a=!1,s=null,c=null,l=0,d=0,h=null,f=null,m=null,_=null,T=null,E=0,y=!1,A=null,w=!1,O=null,S=bl,K=!1,_e=null,Ze=bl,ve(M,"_senderConfig",{g:function(){return nv({},fO)}})}}),t}return e.constructEnvelope=function(t,n,o,i){var a;n!==t.iKey&&!H(n)?a=Ut(Ut({},t),{iKey:n}):a=t;var s=eF[a.baseType]||sI;return s(o,a,i)},e}(wo);var uI="duration",la="properties";var Cn="requestUrl",Kd="inst",bo="length",Do="traceID",fi="spanID",Sn="traceFlags",Gd="context",Ds="aborted",qd="traceId",zd="spanId",Gp="_addHook",uo="core",cE="includeCorrelationHeaders",qp="getAbsoluteUrl",Ps="headers",An="requestHeaders",lE="setRequestHeader",dI="trackDependencyDataInternal",ua="startTime",Dl="toLowerCase",uE="enableRequestHeaderTracking",hI="enableAjaxErrorStatusText",fI="enableAjaxPerfTracking",pI="maxAjaxCallsPerView",mI="excludeRequestFromAutoTrackingPatterns",gI="addRequestContext",dE="disableAjaxTracking",_I="ajaxPerfLookupDelay",vI="disableFetchTracking",EI="enableResponseHeaderTracking",Bn="status",da="statusText",Os="headerMap",zp="openDone",Vp="sendDone",ha="requestSentTime",jp="abortDone",Wp="getTraceId",$p="getTraceFlags",pi="method",Qp="errorStatusText",hE="stateChangeAttached",TI="responseText",Pl="responseFinishedTime",Xp="CreateTrackItem",fE="response",yI="getAllResponseHeaders",Jp="getPartAProps",Vd="perfMark",ks="name",Zp="perfTiming",jd="exception",CI="ajaxDiagnosticsMessage",em="correlationContext",pE="ajaxTotalDuration",mE="eventTraceCtx";function pO(r,e,t){var n=0,o=r[e],i=r[t];return o&&i&&(n=cr(o,i)),n}function Ol(r,e,t,n,o){var i=0,a=pO(t,n,o);return a&&(i=xs(r,e,Hn(a))),i}function xs(r,e,t){var n="ajaxPerf",o=0;if(r&&e&&t){var i=r[n]=r[n]||{};i[e]=t,o=1}return o}function tF(r,e){var t=r[Zp],n=e[la]||{},o=0,i="name",a="Start",s="End",c="domainLookup",l="connect",u="redirect",d="request",h="response",f="startTime",p=c+a,m=c+s,_=l+a,T=l+s,E=d+a,y=d+s,A=h+a,w=h+s,O=u+a,S=u=s,K="transferSize",ne="encodedBodySize",_e="decodedBodySize",Ct="serverTiming";if(t){o|=Ol(n,u,t,O,S),o|=Ol(n,c,t,p,m),o|=Ol(n,l,t,_,T),o|=Ol(n,d,t,E,y),o|=Ol(n,h,t,A,w),o|=Ol(n,"networkConnect",t,f,T),o|=Ol(n,"sentRequest",t,E,w);var Ze=t[uI];Ze||(Ze=pO(t,f,w)||0),o|=xs(n,uI,Ze),o|=xs(n,"perfTotal",Ze);var z=t[Ct];if(z){var M={};j(z,function(Ir,L){var re=Zc(Ir[i]||""+L),oe=M[re]||{};ue(Ir,function(le,Le){(le!==i&&ae(Le)||Wo(Le))&&(oe[le]&&(Le=oe[le]+";"+Le),(Le||!ae(Le))&&(oe[le]=Le))}),M[re]=oe}),o|=xs(n,Ct,M)}o|=xs(n,K,t[K]),o|=xs(n,ne,t[ne]),o|=xs(n,_e,t[_e])}else r[Vd]&&(o|=xs(n,"missing",r.perfAttempts));o&&(e[la]=n)}var rF=function(){function r(){var e=this;e[zp]=!1,e.setRequestHeaderDone=!1,e[Vp]=!1,e[jp]=!1,e[hE]=!1}return r}();var SI=function(){function r(e,t,n,o){var i,a=this,s=n,c="responseText";a[Vd]=null,a.completed=!1,a.requestHeadersSize=null,a[An]=null,a.responseReceivingDuration=null,a.callbackDuration=null,a[pE]=null,a[Ds]=0,a.pageUrl=null,a[Cn]=null,a.requestSize=0,a[pi]=null,a[Bn]=null,a[ha]=null,a.responseStartedTime=null,a[Pl]=null,a.callbackFinishedTime=null,a.endTime=null,a.xhrMonitoringState=new rF,a.clientFailure=0,a[Do]=e,a[fi]=t,a[Sn]=o?.getTraceFlags(),o?a[mE]=(i={},i[qd]=o[Wp](),i[zd]=o.getSpanId(),i[Sn]=o[$p](),i):a[mE]=null,Ne(r,a,function(l){l.getAbsoluteUrl=function(){return l[Cn]?IA(l[Cn]):null},l.getPathName=function(){return l[Cn]?Ji(s,NA(l[pi],l[Cn])):null},l[Xp]=function(u,d,h){var f;if(l.ajaxTotalDuration=Math.round(cr(l.requestSentTime,l.responseFinishedTime)*1e3)/1e3,l[pE]<0)return null;var p=(f={id:"|"+l[Do]+"."+l[fi],target:l[qp]()},f[ks]=l.getPathName(),f.type=u,f[ua]=null,f.duration=l[pE],f.success=+l[Bn]>=200&&+l[Bn]<400,f.responseCode=+l[Bn],f[la]={HttpMethod:l[pi]},f),m=p[la];if(l[Ds]&&(m[Ds]=!0),l[ha]&&(p[ua]=new Date,p[ua].setTime(l[ha])),tF(l,p),d&&$r(l.requestHeaders)[bo]>0&&(m[An]=l[An]),h){var _=h();if(_){var T=_[em];if(T&&(p.correlationContext=T),_[Os]&&$r(_.headerMap)[bo]>0&&(m.responseHeaders=_[Os]),l[Qp])if(l[Bn]>=400){var E=_.type;(E===""||E==="text")&&(m.responseText=_.responseText?_[da]+" - "+_[c]:_[da]),E==="json"&&(m.responseText=_.response?_[da]+" - "+JSON.stringify(_[fE]):_[da])}else l[Bn]===0&&(m.responseText=_[da]||"")}}return p},l[Jp]=function(){var u,d=null,h=l[mE];if(h&&(h[qd]||h[zd])){d={};var f=d[Hr.TraceExt]=(u={},u[Do]=h[qd],u.parentID=h[zd],u);H(h[Sn])||(f[Sn]=h[Sn])}return d}})}return r.__ieDyn=1,r}();var Pt,mO="ai.ajxmn.",nm="diagLog",Kn="ajaxData",kl="fetch",tm="Failed to monitor XMLHttpRequest",CO=", monitoring data for this ajax call ",Wd=CO+"may be incorrect.",gO=CO+"won't be sent.",_O="Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",vO="Failed to add custom defined request context as configured call back may missing a null check.",EO="Failed to calculate the duration of the ",TO=0;function nF(){var r=Pr();return!r||H(r.Request)||H(r.Request[kr])||H(r[kl])?null:r[kl]}function oF(r){var e,t=!1;if(rl()){var n=XMLHttpRequest[kr];t=!H(n)&&!H(n.open)&&!H(n.send)&&!H(n.abort)}var o=Qf();if(o&&o<9&&(t=!1),t)try{var i=new XMLHttpRequest;i[Kn]={};var a=XMLHttpRequest[kr].open;XMLHttpRequest[kr].open=a}catch(s){t=!1,om(r,15,"Failed to enable XMLHttpRequest monitoring, extension is not supported",(e={},e[jd]=G(s),e))}return t}function _E(r){var e="";try{r&&r[Kn]&&r[Kn][Cn]&&(e+="(url: '"+r[Kn][Cn]+"')")}catch{}return e}function om(r,e,t,n,o){q(r[nm](),1,e,t,n,o)}function $d(r,e,t,n,o){q(r[nm](),2,e,t,n,o)}function rm(r,e,t){return function(n){var o;om(r,e,t,(o={ajaxDiagnosticsMessage:_E(n[Kd])},o[jd]=G(n.err),o))}}function Qd(r,e){return r&&e?Tt(r,e):-1}function yO(r,e,t){var n={id:e,fn:t};return r.push(n),{remove:function(){j(r,function(o,i){if(o.id===n.id)return r.splice(i,1),-1})}}}function SO(r,e,t,n){var o=!0;return j(e,function(i,a){try{i.fn.call(null,t)===!1&&(o=!1)}catch(s){q(r&&r.logger,1,64,"Dependency "+n+" [#"+a+"] failed: "+we(s),{exception:G(s)},!0)}}),o}function iF(r,e,t,n,o,i){var a,s=r[bo];if(s>0){var c=(a={},a[uo]=e,a.xhr=n,a.input=o,a.init=i,a.traceId=t[Do],a.spanId=t[fi],a.traceFlags=t[Sn],a.context=t[Gd]||{},a.aborted=!!t[Ds],a);SO(e,r,c,"listener"),t[Do]=c[qd],t[fi]=c[zd],t[Sn]=c[Sn],t[Gd]=c[Gd]}}var gE="*.blob.core.",AO=Co([gE+"windows.net",gE+"chinacloudapi.cn",gE+"cloudapi.de",gE+"usgovcloudapi.net"]),aF=[/https:\/\/[^\/]*(\.pipe\.aria|aria\.pipe|events\.data|collector\.azure)\.[^\/]+\/(OneCollector\/1|Collector\/3)\.0/i],sF=Co((Pt={},Pt[pI]=500,Pt[dE]=!1,Pt[vI]=!1,Pt[mI]=void 0,Pt.disableCorrelationHeaders=!1,Pt.distributedTracingMode=1,Pt.correlationHeaderExcludedDomains=AO,Pt.correlationHeaderDomains=void 0,Pt.correlationHeaderExcludePatterns=void 0,Pt.appId=void 0,Pt.enableCorsCorrelation=!1,Pt[uE]=!1,Pt[EI]=!1,Pt[hI]=!1,Pt[fI]=!1,Pt.maxAjaxPerfLookupAttempts=3,Pt[_I]=25,Pt.ignoreHeaders=["Authorization","X-API-Key","WWW-Authenticate"],Pt[gI]=void 0,Pt.addIntEndpoints=!0,Pt)),AI=function(r){xr(e,r);function e(){var t=r.call(this)||this;t.identifier=e.identifier,t.priority=120;var n,o,i,a,s,c,l,u,d,h,f,p,m,_,T,E,y,A,w,O,S,K,ne,_e,Ct,Ze,z,M,Ir;return Ne(e,t,function(L,re){var oe=re[Gp];le(),L.initialize=function(v,N,D,k){L.isInitialized()||(re.initialize(v,N,D,k),O=Yn(sr("ajax"),N&&N.evtNamespace&&N.evtNamespace()),Le(v),ke(),V(),b())},L._doTeardown=function(){le()},L.trackDependencyData=function(v,N){I(ne,L[uo],null,v,N)},L[cE]=function(v,N,D,k){var F=L._currentWindowHost||i;if(iF(K,L[uo],v,k,N,D),N){if(Ov(a,v[qp](),F)){D||(D={});var J=new Headers(D[Ps]||(N instanceof Request?N[Ps]||{}:{}));if(h){var Q="|"+v[Do]+"."+v[fi];J.set(ot[3],Q),s&&(v[An][ot[3]]=Q)}var se=M||u&&u.appId();if(se&&(J.set(ot[0],ot[2]+se),s&&(v[An][ot[0]]=ot[2]+se)),d){var X=v[Sn];H(X)&&(X=1);var qe=lp(cp(v[Do],v[fi],X));J.set(ot[4],qe),s&&(v[An][ot[4]]=qe)}D[Ps]=J}return D}else if(k){if(Ov(a,v[qp](),F)){if(h){var Q="|"+v[Do]+"."+v[fi];k[lE](ot[3],Q),s&&(v[An][ot[3]]=Q)}var se=M||u&&u.appId();if(se&&(k[lE](ot[0],ot[2]+se),s&&(v[An][ot[0]]=ot[2]+se)),d){var X=v[Sn];H(X)&&(X=1);var qe=lp(cp(v[Do],v[fi],X));k[lE](ot[4],qe),s&&(v[An][ot[4]]=qe)}}return k}},L[dI]=function(v,N,D){if(m===-1||l<m){(z===2||z===1)&&typeof v.id=="string"&&v.id[v.id[bo]-1]!=="."&&(v.id+="."),H(v[ua])&&(v[ua]=new Date);var k=so(v,ao.dataType,ao.envelopeType,L[nm](),N,D);L[uo].track(k)}else l===m&&om(L,55,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++l},L.addDependencyListener=function(v){return yO(K,S++,v)},L.addDependencyInitializer=function(v){return yO(ne,S++,v)};function le(){var v=gn();n=!1,o=!1,Ir=!1,i=v&&v.host&&v.host[Dl](),a=null,s=!1,c=!1,l=0,u=null,d=!1,h=!1,f=null,p=!1,m=0,_=!1,T={},E=!1,y=!1,A=null,w=null,O=null,S=0,K=[],ne=[],_e=null,Ct=1,Ze=1,z=1,M=null}function Le(v){L[Gp](Je(v,function(N){var D=N.cfg,k=Lr(null,D,L[uo]);if(a=k.getExtCfg(e.identifier,sF),z=a.distributedTracingMode,s=a[uE],c=a[hI],p=a[fI],m=a[pI],A=[].concat(a[mI]||[],a.addIntEndpoints!==!1?aF:[]),w=a[gI],h=z===0||z===1,d=z===1||z===2,p){var F=D.instrumentationKey||"unkwn";F[bo]>5?f=mO+Sr(F,F[bo]-5)+".":f=mO+F+"."}E=!!a[dE],Ct=a.maxAjaxPerfLookupAttempts,Ze=a[_I],_e=a.ignoreHeaders,M=a.appId}))}function b(){var v=L[uo].getPlugin(Es);v&&(u=v.plugin[Gd])}function B(v){var N=!0;return(v||_e)&&j(_e,function(D){if(D[Dl]()===v[Dl]())return N=!1,-1}),N}function V(){var v=nF();if(v){var N=Pr(),D=v.polyfill;L[Gp](Je(a,function(){y=!!a[vI],_=a[EI],!y&&!n?(oe(hp(N,kl,{ns:O,req:function(k,F,J){var Q;if(!y&&n&&!et(null,F,J)&&!(D&&o)){var se=k.ctx();Q=$e(F,J);var X=L[cE](Q,F,J);X!==J&&k.set(1,X),se.data=Q}},rsp:function(k,F){if(!y){var J=k.ctx().data;J&&(k.rslt=k.rslt.then(function(Q){return Ot(k,(Q||{})[Bn],F,Q,J,function(){var se,X=(se={statusText:(Q||{})[da]},se[Os]=null,se[em]=Kr(Q),se);if(_&&Q){var qe={};Q.headers.forEach(function(Nt,_t){B(_t)&&(qe[_t]=Nt)}),X[Os]=qe}return X}),Q}).catch(function(Q){throw Ot(k,0,F,null,J,null,{error:Q.message||G(Q)}),Q}))}},hkErr:rm(L,15,"Failed to monitor Window.fetch"+Wd)},!0,Of())),n=!0):D&&!Ir&&(oe(hp(N,kl,{ns:O,req:function(k,F,J){et(null,F,J)}})),Ir=!0)})),D&&(N[kl].polyfill=D)}}function W(v,N,D){oe(_A(v,N,D))}function ke(){oF(L)&&L[Gp](Je(a,function(){E=!!a[dE],s=a[uE],!E&&!o&&(W(XMLHttpRequest,"open",{ns:O,req:function(v,N,D,k){if(!E){var F=v[Kd],J=F[Kn];!et(F,D)&&Ee(F,!0)&&((!J||!J.xhrMonitoringState[zp])&&He(F,N,D,k),P(F))}},hkErr:rm(L,15,tm+".open"+Wd)}),W(XMLHttpRequest,"send",{ns:O,req:function(v,N){if(!E){var D=v[Kd],k=D[Kn];Ee(D)&&!k.xhrMonitoringState[Vp]&&(fe("xhr",k),k[ha]=Nd(),L[cE](k,void 0,void 0,D),k.xhrMonitoringState[Vp]=!0)}},hkErr:rm(L,17,tm+Wd)}),W(XMLHttpRequest,"abort",{ns:O,req:function(v){if(!E){var N=v[Kd],D=N[Kn];Ee(N)&&!D.xhrMonitoringState[jp]&&(D[Ds]=1,D.xhrMonitoringState[jp]=!0)}},hkErr:rm(L,13,tm+".abort"+Wd)}),W(XMLHttpRequest,"setRequestHeader",{ns:O,req:function(v,N,D){if(!E&&s){var k=v[Kd];Ee(k)&&B(N)&&(k[Kn][An][N]=D)}},hkErr:rm(L,71,tm+".setRequestHeader"+Wd)}),o=!0)}))}function et(v,N,D){var k=!1,F=((ae(N)?N:(N||{}).url||"")||"")[Dl]();if(j(A,function(se){var X=se;ae(se)&&(X=new RegExp(se)),k||(k=X.test(F))}),k)return k;var J=Qd(F,"?"),Q=Qd(F,"#");return(J===-1||Q!==-1&&Q<J)&&(J=Q),J!==-1&&(F=F.substring(0,J)),H(v)?H(N)||(k=(typeof N=="object"?N[ai]===!0:!1)||(D?D[ai]===!0:!1)):k=v[ai]===!0||F[ai]===!0,!k&&F&&_l(F)&&(k=!0),k?T[F]||(T[F]=1):T[F]&&(k=!0),k}function Ee(v,N){var D=!0,k=o;return H(v)||(D=N===!0||!H(v[Kn])),k&&D}function Fe(){var v=null;return L[uo]&&L[uo].getTraceCtx&&(v=L[uo].getTraceCtx(!1)),!v&&u&&u.telemetryTrace&&(v=vl(u.telemetryTrace)),v}function He(v,N,D,k){var F,J=Fe(),Q=J&&J[Wp]()||Fn(),se=Xn(Fn(),0,16),X=new SI(Q,se,L[nm](),(F=L.core)===null||F===void 0?void 0:F.getTraceCtx());X[Sn]=J&&J[$p](),X[pi]=N,X[Cn]=D,X.xhrMonitoringState[zp]=!0,X[An]={},X.async=k,X[Qp]=c,v[Kn]=X}function P(v){v[Kn].xhrMonitoringState[hE]=ro(v,"readystatechange",function(){var N;try{v&&v.readyState===4&&Ee(v)&&ge(v)}catch(k){var D=G(k);(!D||Qd(D[Dl](),"c00c023f")===-1)&&om(L,16,tm+" 'readystatechange' event handler"+Wd,(N={},N[CI]=_E(v),N[jd]=D,N))}},O)}function Z(v){try{var N=v.responseType;if(N===""||N==="text")return v[TI]}catch{}return null}function ge(v){var N=v[Kn];N[Pl]=Nd(),N[Bn]=v[Bn];function D(k,F){var J=F||{};J.ajaxDiagnosticsMessage=_E(v),k&&(J.exception=G(k)),$d(L,14,EO+"ajax call"+gO,J)}We("xmlhttprequest",N,function(){try{var k=N[Xp]("Ajax",s,function(){var Q,se=(Q={statusText:v[da]},Q[Os]=null,Q[em]=he(v),Q.type=v.responseType,Q[TI]=Z(v),Q.response=v[fE],Q);if(_){var X=v[yI]();if(X){var qe=Lt(X).split(/[\r\n]+/),Nt={};j(qe,function(_t){var Oo=_t.split(": "),Tr=Oo.shift(),Be=Oo.join(": ");B(Tr)&&(Nt[Tr]=Be)}),se[Os]=Nt}}return se}),F=void 0;try{w&&(F=w({status:v[Bn],xhr:v}))}catch{$d(L,104,vO)}if(k){F!==void 0&&(k[la]=Ut(Ut({},k.properties),F));var J=N[Jp]();I(ne,L[uo],N,k,null,J)}else D(null,{requestSentTime:N[ha],responseFinishedTime:N[Pl]})}finally{try{v[Kn]=null}catch{}}},function(k){D(k,null)})}function he(v){var N;try{var D=v[yI]();if(D!==null){var k=Qd(D[Dl](),ot[8]);if(k!==-1){var F=v.getResponseHeader(ot[0]);return kv(F)}}}catch(J){$d(L,18,_O,(N={},N[CI]=_E(v),N[jd]=G(J),N))}}function fe(v,N){if(N[Cn]&&f&&p){var D=dn();if(D&&ce(D.mark)){TO++;var k=f+v+"#"+TO;D.mark(k);var F=D.getEntriesByName(k);F&&F[bo]===1&&(N[Vd]=F[0])}}}function We(v,N,D,k){var F=N[Vd],J=dn(),Q=Ct,se=Ze,X=N[Cn],qe=0;(function Nt(){try{if(J&&F){qe++;for(var _t=null,Oo=J.getEntries(),Tr=Oo[bo]-1;Tr>=0;Tr--){var Be=Oo[Tr];if(Be){if(Be.entryType==="resource")Be.initiatorType===v&&(Qd(Be[ks],X)!==-1||Qd(X,Be[ks])!==-1)&&(_t=Be);else if(Be.entryType==="mark"&&Be[ks]===F[ks]){N[Zp]=_t;break}if(Be[ua]<F[ua]-1e3)break}}}!F||N[Zp]||qe>=Q||N.async===!1?(F&&ce(J.clearMarks)&&J.clearMarks(F[ks]),N.perfAttempts=qe,D()):Ht(Nt,se)}catch(ko){k(ko)}})()}function $e(v,N){var D,k=Fe(),F=k&&k[Wp]()||Fn(),J=Xn(Fn(),0,16),Q=new SI(F,J,L[nm](),(D=L.core)===null||D===void 0?void 0:D.getTraceCtx());Q[Sn]=k&&k[$p](),Q[ha]=Nd(),Q[Qp]=c,v instanceof Request?Q[Cn]=v?v.url:"":Q[Cn]=v;var se="GET";N&&N[pi]?se=N[pi]:v&&v instanceof Request&&(se=v[pi]),Q[pi]=se;var X={};if(s){var qe=new Headers((N?N[Ps]:0)||(v instanceof Request?v[Ps]||{}:{}));qe.forEach(function(Nt,_t){B(_t)&&(X[_t]=Nt)})}return Q[An]=X,fe(kl,Q),Q}function gt(v){var N="";try{H(v)||(typeof v=="string"?N+="(url: '".concat(v,"')"):N+="(url: '".concat(v.url,"')"))}catch(D){om(L,15,"Failed to grab failed fetch diagnostics message",{exception:G(D)})}return N}function Ot(v,N,D,k,F,J,Q){if(!F)return;function se(X,qe,Nt){var _t=Nt||{};_t.fetchDiagnosticsMessage=gt(D),qe&&(_t.exception=G(qe)),$d(L,X,EO+"fetch call"+gO,_t)}F[Pl]=Nd(),F[Bn]=N,We(kl,F,function(){var X=F[Xp]("Fetch",s,J),qe;try{w&&(qe=w({status:N,request:D,response:k}))}catch{$d(L,104,vO)}if(X){qe!==void 0&&(X[la]=Ut(Ut({},X.properties),qe));var Nt=F[Jp]();I(ne,L[uo],F,X,null,Nt)}else se(14,null,{requestSentTime:F[ha],responseFinishedTime:F[Pl]})},function(X){se(18,X,null)})}function Kr(v){var N;if(v&&v[Ps])try{var D=v[Ps].get(ot[0]);return kv(D)}catch(k){$d(L,18,_O,(N={fetchDiagnosticsMessage:gt(v)},N[jd]=G(k),N))}}function I(v,N,D,k,F,J){var Q,se=!0,X=v[bo];if(X>0){var qe=(Q={item:k},Q[la]=F,Q.sysProperties=J,Q.context=D?D[Gd]:null,Q.aborted=D?!!D[Ds]:!1,Q);se=SO(N,v,qe,"initializer")}se&&L[dI](k,F,J)}}),t}return e.prototype.processTelemetry=function(t,n){this.processNext(t,n)},e.prototype.addDependencyInitializer=function(t){return null},e.identifier="AjaxDependencyPlugin",e}(wo);var IO=function(){function r(){}return r}();var NO=function(){function r(){this.id="browser",this.deviceClass="Browser"}return r}();var cF="3.0.2",RO=function(){function r(e,t){var n=this,o=Je(e,function(){var i=e.sdkExtension;n.sdkVersion=(i?i+"_":"")+"javascript:"+cF});t&&t.add(o)}return r}();var wO=function(){function r(){}return r}();var Xd="sessionManager",xl="update",Jd="isUserCookieSet",Zd="isNewUser",vE="getTraceCtx",im="telemetryTrace",EE="applySessionContext",TE="applyApplicationContext",yE="applyDeviceContext",CE="applyOperationContext",SE="applyUserContext",AE="applyOperatingSystemContxt",IE="applyLocationContext",NE="applyInternalContext",mi="accountId",eh="getSessionId",th="namePrefix",bO="sessionCookiePostfix",RE="userCookiePostfix",Ml="idLength",rh="getNewId",Ll="length",Ms="automaticSession",Ls="authenticatedId",nh="acquisitionDate",am="renewalDate",Ul="join",oh="cookieSeparator",wE="authUserCookieName";var lF="ai_session",uF=864e5,dF=18e5,hF=6e4,II=function(){function r(){}return r}();var DO=function(){function r(e,t,n){var o=this,i,a,s=Un(t),c=sl(t),l,u;Ne(r,o,function(d){e||(e={});var h=Je(e,function(E){l=e.sessionExpirationMs||uF,u=e.sessionRenewalMs||dF;var y=e.sessionCookiePostfix||e[th]||"";i=lF+y});n&&n.add(h),d[Ms]=new II,d[xl]=function(){var E=rr(),y=!1,A=d[Ms];if(A.id||(y=!f(A,E)),!y&&l>0){var w=E-A[nh],O=E-A[am];y=w<0||O<0,y=y||w>l,y=y||O>u}y?m(E):(!a||E-a>hF)&&_(A,E)},d.backup=function(){var E=d[Ms];T(E.id,E[nh],E[am])};function f(E,y){var A=!1,w=c.get(i);if(w&&ce(w.split))A=p(E,w);else{var O=PA(s,i);O&&(A=p(E,O))}return A||!!E.id}function p(E,y){var A=!1,w=", session will be reset",O=y.split("|");if(O[Ll]>=2)try{var S=+O[1]||0,K=+O[2]||0;isNaN(S)||S<=0?q(s,2,27,"AI session acquisition date is 0"+w):isNaN(K)||K<=0?q(s,2,27,"AI session renewal date is 0"+w):O[0]&&(E.id=O[0],E[nh]=S,E[am]=K,A=!0)}catch(ne){q(s,1,9,"Error parsing ai_session value ["+(y||"")+"]"+w+" - "+we(ne),{exception:G(ne)})}return A}function m(E){var y=e[rh]||ol;d.automaticSession.id=y(e[Ml]||22),d[Ms][nh]=E,_(d[Ms],E),Cp()||q(s,2,0,"Browser does not support local storage. Session durations will be inaccurate.")}function _(E,y){var A=E[nh];E[am]=y;var w=u,O=A+l-y,S=[E.id,A,y],K=0;O<w?K=O/1e3:K=w/1e3;var ne=e.cookieDomain||null;c.set(i,S[Ul]("|"),l>0?K:null,ne),a=y}function T(E,y,A){OA(s,i,[E,y,A][Ul]("|"))}})}return r.__ieDyn=1,r}();var PO=function(){function r(e,t,n,o){var i=this;i.traceID=e||Fn(),i.parentID=t;var a=gn();!n&&a&&a.pathname&&(n=a.pathname),i.name=je(o,n)}return r}();function OO(r){return!(typeof r!="string"||!r||r.match(/,|;|=| |\|/))}var kO=function(){function r(e,t,n){this.isNewUser=!1,this.isUserCookieSet=!1;var o=Un(t),i=sl(t),a;Ne(r,this,function(s){ve(s,"config",{g:function(){return e}});var c=Je(e,function(){var h=e[RE]||"";a=r.userCookieName+h;var f=i.get(a);if(f){s[Zd]=!1;var p=f.split(r[oh]);p[Ll]>0&&(s.id=p[0],s[Jd]=!!s.id)}if(!s.id){s.id=l();var m=u(s.id);d(m[Ul](r[oh]));var _=(e[th]||"")+"ai_session";kA(o,_)}s[mi]=e[mi]||void 0;var T=i.get(r[wE]);if(T){T=decodeURI(T);var E=T.split(r[oh]);E[0]&&(s[Ls]=E[0]),E[Ll]>1&&E[1]&&(s[mi]=E[1])}});n&&n.add(c);function l(){var h=e||{},f=h[rh]||ol,p=f(h[Ml]?e[Ml]:22);return p}function u(h){var f=to(new Date);s.accountAcquisitionDate=f,s[Zd]=!0;var p=[h,f];return p}function d(h){var f=31536e3;s[Jd]=i.set(a,h,f)}s.setAuthenticatedUserContext=function(h,f,p){p===void 0&&(p=!1);var m=!OO(h)||f&&!OO(f);if(m){q(o,2,60,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}s[Ls]=h;var _=s[Ls];f&&(s[mi]=f,_=[s[Ls],s.accountId][Ul](r[oh])),p&&i.set(r[wE],encodeURI(_))},s.clearAuthenticatedUserContext=function(){s[Ls]=null,s[mi]=null,i.del(r[wE])},s[xl]=function(h){if(s.id!==h||!s[Jd]){var f=h||l(),p=u(f);d(p[Ul](r[oh]))}}})}return r.cookieSeparator="|",r.userCookieName="ai_user",r.authUserCookieName="ai_authUser",r}();var bE="ext",DE="tags";function ih(r,e){r&&r[e]&&$r(r[e])[Ll]===0&&delete r[e]}function xO(){return null}var MO=function(){function r(e,t,n,o){var i=this,a=e.logger;Ne(r,this,function(s){if(s.appId=xO,s[eh]=xO,s.application=new IO,s.internal=new RO(t,o),Xo()){s[Xd]=new DO(t,e,o),s.device=new NO,s.location=new wO,s.user=new kO(t,e,o);var c=void 0,l=void 0,u;n&&(c=n.getTraceId(),l=n.getSpanId(),u=n.getName()),s[im]=new PO(c,l,u,a),s.session=new II}s[eh]=function(){var d=s.session,h=null;if(d&&ae(d.id))h=d.id;else{var f=(s[Xd]||{})[Ms];h=f&&ae(f.id)?f.id:null}return h},s[EE]=function(d,h){Qe(ar(d.ext,Hr.AppExt),"sesId",s[eh](),ae)},s[AE]=function(d,h){Qe(d.ext,Hr.OSExt,s.os)},s[TE]=function(d,h){var f=s.application;if(f){var p=ar(d,DE);Qe(p,it.applicationVersion,f.ver,ae),Qe(p,it.applicationBuild,f.build,ae)}},s[yE]=function(d,h){var f=s.device;if(f){var p=ar(ar(d,bE),Hr.DeviceExt);Qe(p,"localId",f.id,ae),Qe(p,"ip",f.ip,ae),Qe(p,"model",f.model,ae),Qe(p,"deviceClass",f.deviceClass,ae)}},s[NE]=function(d,h){var f=s.internal;if(f){var p=ar(d,DE);Qe(p,it.internalAgentVersion,f.agentVersion,ae),Qe(p,it.internalSdkVersion,je(a,f.sdkVersion,64),ae),(d.baseType===zi.dataType||d.baseType===vn.dataType)&&(Qe(p,it.internalSnippet,f.snippetVer,ae),Qe(p,it.internalSdkSrc,f.sdkSrc,ae))}},s[IE]=function(d,h){var f=i.location;f&&Qe(ar(d,DE,[]),it.locationIp,f.ip,ae)},s[CE]=function(d,h){var f=s[im];if(f){var p=ar(ar(d,bE),Hr.TraceExt,{traceID:void 0,parentID:void 0});Qe(p,"traceID",f.traceID,ae,H),Qe(p,"name",f.name,ae,H),Qe(p,"parentID",f.parentID,ae,H)}},s.applyWebContext=function(d,h){var f=i.web;f&&Qe(ar(d,bE),Hr.WebExt,f)},s[SE]=function(d,h){var f=s.user;if(f){var p=ar(d,DE,[]);Qe(p,it.userAccountId,f[mi],ae);var m=ar(ar(d,bE),Hr.UserExt);Qe(m,"id",f.id,ae),Qe(m,"authId",f[Ls],ae)}},s.cleanUp=function(d,h){var f=d.ext;f&&(ih(f,Hr.DeviceExt),ih(f,Hr.UserExt),ih(f,Hr.WebExt),ih(f,Hr.OSExt),ih(f,Hr.AppExt),ih(f,Hr.TraceExt))}})}return r.__ieDyn=1,r}();var Br,NI,ah=null,fF=Qr((Br={},Br[mi]=ah,Br.sessionRenewalMs=30*60*1e3,Br.samplingPercentage=100,Br.sessionExpirationMs=24*60*60*1e3,Br.cookieDomain=ah,Br.sdkExtension=ah,Br.isBrowserLinkTrackingEnabled=!1,Br.appId=ah,Br[eh]=ah,Br[th]=NI,Br[bO]=NI,Br[RE]=NI,Br[Ml]=22,Br[rh]=ah,Br)),pF=function(r){xr(e,r);function e(){var t=r.call(this)||this;t.priority=110,t.identifier=Es;var n,o,i,a;return Ne(e,t,function(s,c){l(),ve(s,"context",{g:function(){return a}}),s.initialize=function(h,f,p,m){c.initialize(h,f,p,m),u(h)},s.processTelemetry=function(h,f){if(!H(h)){f=s._getTelCtx(f),h.name===vn.envelopeType&&f.diagLog().resetInternalMessageCount();var p=a||{};p.session&&typeof a.session.id!="string"&&p[Xd]&&p[Xd][xl]();var m=p.user;if(m&&!m[Jd]&&m[xl](p.user.id),d(h,f),m&&m[Zd]){m[Zd]=!1;var _=new zi(72,(gr()||{}).userAgent||"");GS(f.diagLog(),1,_)}s.processNext(h,f)}},s._doTeardown=function(h,f){var p=(h||{}).core();if(p&&p[vE]){var m=p[vE](!1);m===o&&p.setTraceCtx(i)}l()};function l(){n=null,o=null,i=null,a=null}function u(h){var f=s.identifier,p=s.core;s._addHook(Je(h,function(){var m=Lr(null,h,p);n=m.getExtCfg(f,fF),s._extConfig=n})),i=p[vE](!1),a=new MO(p,n,i,s._unloadHooks),o=vl(s.context[im],i),p.setTraceCtx(o),s.context.appId=function(){var m=p.getPlugin(Uv);return m?m.plugin._appId:null}}function d(h,f){ar(h,"tags",[]),ar(h,"ext",{});var p=s.context;p[EE](h,f),p[TE](h,f),p[yE](h,f),p[CE](h,f),p[SE](h,f),p[AE](h,f),p.applyWebContext(h,f),p[IE](h,f),p[NE](h,f),p.cleanUp(h,f)}}),t}return e.__ieDyn=1,e}(wo),RI=pF;var LO="AuthenticatedUserContext",sh="track";var PE="snippet",UO="getCookieMgr",FO="startTrackPage",YO="stopTrackPage",OE="flush",HO="startTrackEvent",BO="stopTrackEvent",wI="addTelemetryInitializer",_ne=wI+"s",bI="pollInternalLogs",kE="getPlugin",xE="evtNamespace",KO=sh+"Event",GO=sh+"Trace",qO=sh+"Metric",zO=sh+"PageView",VO=sh+"Exception",jO=sh+"DependencyData",WO="set"+LO,$O="clear"+LO;var ME="version",Us="queue",sm="connectionString",LE="endpointUrl",UE="instrumentationKey",DI="disableIkeyDeprecationMessage",ch="onunloadFlush",Po="context",PI="addHousekeepingBeforeUnload",QO="updateSnippetDefinitions";var lh,cm,XO=[PE,"dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],OI=void 0,mF=(lh={},lh[sm]=OI,lh[LE]=OI,lh[UE]=OI,lh.diagnosticLogInterval=ss(gF,1e4),lh);function gF(r){return r&&r>0}var kI=function(){function r(e){var t=this,n,o,i,a,s,c,l,u,d;Ne(r,this,function(h){_(),ve(h,"config",{g:function(){return u}}),j(["pluginVersionStringArr","pluginVersionString"],function(y){ve(h,y,{g:function(){return l?l[y]:null}})}),a=""+(e.sv||e[ME]||""),e[Us]=e[Us]||[],e[ME]=e[ME]||2;var f=Bt(e.config||{},mF);u=f.cfg,d=new Qv,ve(h,"appInsights",{g:function(){return d}}),o=new RI,n=new AI,i=new lI,l=new sA,ve(h,"core",{g:function(){return l}}),E(Je(f,function(){if(u[sm]){var y=MA(u[sm]),A=y.ingestionendpoint;u[LE]=A?A+ji:u[LE],u[UE]=y.instrumentationkey||u[UE]}}));var p=H(u[DI])?!0:u[DI];!u[sm]&&!p&&q(l.logger,1,106,"Instrumentation key support will end soon, see aka.ms/IkeyMigrate"),h[PE]=e,h[OE]=function(y,A){y===void 0&&(y=!0);var w;return ls(l,function(){return"AISKU.flush"},function(){y&&!A&&(w=Mr(function(K){A=K}));var O=1,S=function(){O--,O===0&&A()};j(l.getChannels(),function(K){K&&(O++,K[OE](y,S))}),S()},null,y),w},h[ch]=function(y){y===void 0&&(y=!0),j(l.getChannels(),function(A){A[ch]?A[ch]():A[OE](y)})},h.loadAppInsights=function(y,A,w){y===void 0&&(y=!1),y&&GC("Legacy Mode is no longer supported");function O(S){if(S){var K="";H(a)||(K+=a),h[Po]&&h[Po].internal&&(h[Po].internal.snippetVer=K||"-"),ue(h,function(ne,_e){ae(ne)&&!ce(_e)&&ne&&ne[0]!=="_"&&ut(XO,ne)===-1&&S[ne]!==_e&&(S[ne]=_e)})}}return ls(h.core,function(){return"AISKU.loadAppInsights"},function(){l.initialize(u,[i,o,n,d],A,w),ve(h,"context",{g:function(){return o[Po]}});var S=_F();S&&h[Po]&&(h[Po].internal.sdkSrc=S),O(h[PE]),h.emptyQueue(),h[bI](),h[PI](h)}),h},h[QO]=function(y){AS(y,h,function(A){return A&&ut(XO,A)===-1})},h.emptyQueue=function(){try{if(de(h.snippet[Us])){for(var y=h.snippet[Us].length,A=0;A<y;A++){var w=h.snippet[Us][A];w()}h.snippet[Us]=void 0,delete h.snippet[Us]}}catch(S){var O={};S&&ce(S.toString)&&(O.exception=S.toString())}},h[PI]=function(y){if(Xo()||$u()){var A=function(){if(y[ch](!1),ce(h.core[kE])){var K=t.core[kE](Es);if(K){var ne=K.plugin;ne&&ne[Po]&&ne[Po]._sessionManager&&ne[Po]._sessionManager.backup()}}},w=!1,O=y.appInsights,S=O.config;c||(c=Yn(s,l[xE]&&l[xE]())),E(Je(u,function(){T();var K=S.disablePageUnloadEvents;S.disableFlushOnBeforeUnload||(dA(A,K,c)&&(w=!0),dp(A,K,c)&&(w=!0),!w&&!xS()&&q(O.core.logger,1,19,"Could not add handler for beforeunload and pagehide")),!w&&!S.disableFlushOnUnload&&dp(A,K,c)}))}},h.getSender=function(){return i},h.unload=function(y,A,w){var O=!1,S;y&&!A&&(S=Mr(function(ne){A=ne}));function K(ne){O||(O=!0,_(),A&&A(ne))}return h[ch](y),T(),l.unload&&l.unload(y,K,w),S},as(h,d,[UO,KO,zO,"trackPageViewPerformance",VO,"_onerror",GO,qO,FO,YO,HO,BO]),as(h,m,[jO,"addDependencyListener","addDependencyInitializer"]),as(h,l,[wI,bI,"stopPollingInternalLogs",kE,"addPlugin",xE,"addUnloadCb","getTraceCtx","updateCfg","onCfgChange"]),as(h,function(){var y=o[Po];return y?y.user:null},[WO,$O]);function m(){return n}function _(){s=sr("AISKU"),c=null,n=null,o=null,i=null,a=null}function T(){c&&(hA(null,c),fA(null,c))}function E(y){l.addUnloadHook(y)}})}return r.prototype.addDependencyInitializer=function(e){return null},r}();function _F(){if(cm)return cm;var r=null,e=!1,t=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(r=n.src)}catch{}if(r){try{var o=r.toLowerCase();if(o){var i="";j(t,function(a,s){if(Tt(o,a)!==-1)return i="cdn"+(s+1),Tt(o,"/scripts/")===-1&&(Tt(o,"/next/")!==-1?i+="-next":Tt(o,"/beta/")!==-1&&(i+="-beta")),cm=i+(e?".mod":""),-1})}}catch{}cm=r}return cm}var FE=(()=>{class r{static getInstance(){return this.initAppInsights(),this.logger}constructor(){r.initAppInsights()}static loggingEnabled(){return tt.azure.applicationInsights!=""&&tt.features.logging}static initAppInsights(){r.loggingEnabled()&&(this.logger=new kI({config:{instrumentationKey:tt.azure.applicationInsights,enableAutoRouteTracking:!0}}),this.logger.loadAppInsights(),this.logger.trackEvent({name:"app instance started"}))}ngOnDestroy(){this.routerSubscription.unsubscribe()}logEvent(t,n){r.loggingEnabled()&&r.logger.trackEvent({name:t,properties:n})}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var JO=(()=>{class r extends Yl{constructor(t){super(),this.ai=t}handleError(t){}static{this.\u0275fac=function(n){return new(n||r)(Re(FE))}}static{this.\u0275prov=dt({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var ZO=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=rn({type:r})}static{this.\u0275inj=tn({imports:[Bs,qs,fh,ym,xN,TN,s_]})}}return r})();var EF={sideNavEnabled:!0,sideNavVisible:!0,sideNavPosition:"side"},ek=Rm(EF,ga(qa.toggleSideNav,r=>ie(U({},r),{sideNavVisible:!r.sideNavVisible})),ga(qa.setSideNavEnabled,(r,e)=>ie(U({},r),{sideNavEnabled:e.enabled,sideNavVisible:e.enabled})),ga(qa.setSideNavVisible,(r,e)=>ie(U({},r),{sideNavVisible:e.visible})),ga(qa.setSideNavPosition,(r,e)=>ie(U({},r),{sideNavPosition:e.position})));function yF(r){return function(e,t){var n=FE.getInstance();return console.log("ngrx",t.type),n.trackEvent({name:t.type,properties:t}),r(e,t)}}var tk={menu:ek},rk=tt.features.logging?[yF]:[];QI(LN);var Noe=tt.authEnabled?[a_,Nw]:[a_],nk=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=rn({type:r,bootstrap:[a_]})}static{this.\u0275inj=tn({providers:[{provide:Yl,useClass:JO},{provide:$I,useValue:"de"},Em(rN())],imports:[Tm,eb,hR,sN,ym,qs,ph.forRoot(tk,{metaReducers:rk,runtimeChecks:{strictStateImmutability:!0,strictActionImmutability:!0}}),mh.forRoot([]),EN.forRoot({}),tt.production?[]:Xw.instrument({connectInZone:!0}),s_,ZO]})}}return r})();oN().bootstrapModule(nk).catch(r=>console.error(r));
